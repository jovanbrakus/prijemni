<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ugao između prostornih dijagonala kocke</title>

<!--
LOGIC SCRATCHPAD — full solution worked out before rendering
=========================================================
Kocka stranice a sa temenom u koordinatnom početku.
Temena: O(0,0,0), A(a,0,0), B(0,a,0), C(0,0,a),
        D(a,a,0), E(a,0,a), F(0,a,a), G(a,a,a)

Prostorne dijagonale (spajaju nasuprotna temena):
  d1: O→G = (1,1,1)
  d2: A→F = (-1,1,1)
  d3: B→E = (1,-1,1)
  d4: C→D = (1,1,-1)

Svaka dijagonala ima dužinu a√3.

Ugao između d1 i d2:
  cos α = |d1·d2| / (|d1|·|d2|) = |(-1+1+1)| / (√3·√3) = 1/3
  sin²α = 1 - 1/9 = 8/9  →  sin α = 2√2/3
  tg α = sin α / cos α = (2√2/3) / (1/3) = 2√2

Provera sa d1 i d3:
  cos α = |1-1+1| / 3 = 1/3  ✓  →  tg α = 2√2 ✓

Provera sa d1 i d4:
  cos α = |1+1-1| / 3 = 1/3  ✓  →  tg α = 2√2 ✓

Provera sa d2 i d3:
  cos α = |-1-1+1| / 3 = 1/3  ✓  →  tg α = 2√2 ✓

Svi parovi ne-paralelnih dijagonala daju isti ugao.
Odgovor: (D) 2√2
=========================================================
-->

<script>
MathJax = {
  tex: { inlineMath: [['\\(', '\\)'], ['$', '$']], displayMath: [['\\[', '\\]']] },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
  min-height: 100vh;
}

.container {
  max-width: 860px;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 16px;
  padding: 28px;
}

h1 {
  text-align: center;
  font-size: 2rem;
  font-weight: 800;
  background: linear-gradient(135deg, #60a5fa, #a78bfa, #f472b6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  line-height: 1.3;
  margin-bottom: 4px;
}

h2 {
  font-size: 1.35rem;
  font-weight: 700;
  color: #60a5fa;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 10px;
}

h3 {
  font-size: 1.1rem;
  color: #a78bfa;
  margin: 18px 0 10px 0;
}

.problem-statement {
  background: #172033;
  border-left: 4px solid #a78bfa;
  padding: 20px 24px;
  border-radius: 0 12px 12px 0;
  font-size: 1.08rem;
  margin-bottom: 6px;
}

.options-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
  margin-top: 14px;
}

.option-box {
  background: #0f172a;
  border: 1px solid #334155;
  border-radius: 10px;
  padding: 10px;
  text-align: center;
  font-size: 1rem;
  transition: all 0.2s;
}

.option-box.correct {
  border-color: #34d399;
  background: rgba(52, 211, 153, 0.1);
  color: #4ade80;
  font-weight: 700;
}

.plan-list {
  list-style: none;
  counter-reset: plan-counter;
}

.plan-list li {
  counter-increment: plan-counter;
  padding: 8px 0 8px 40px;
  position: relative;
  border-bottom: 1px solid #334155;
}

.plan-list li:last-child { border-bottom: none; }

.plan-list li::before {
  content: counter(plan-counter);
  position: absolute;
  left: 0;
  top: 8px;
  width: 28px;
  height: 28px;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.85rem;
  color: #0f172a;
}

/* Collapsible theory */
details {
  border: 1px solid #334155;
  border-radius: 12px;
  overflow: hidden;
}

details summary {
  padding: 16px 20px;
  cursor: pointer;
  font-weight: 600;
  color: #a78bfa;
  background: #172033;
  list-style: none;
  display: flex;
  align-items: center;
  gap: 10px;
  user-select: none;
}

details summary::-webkit-details-marker { display: none; }

details summary::before {
  content: '▶';
  font-size: 0.75rem;
  transition: transform 0.2s;
  display: inline-block;
}

details[open] summary::before { transform: rotate(90deg); }

details .theory-body {
  padding: 20px 24px;
  background: #1e293b;
}

.theory-body ul {
  margin-left: 20px;
  margin-top: 8px;
}

.theory-body li {
  margin-bottom: 8px;
  color: #94a3b8;
}

/* Canvas area */
.canvas-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
}

canvas {
  background: #0f172a;
  border: 1px solid #334155;
  border-radius: 12px;
  max-width: 100%;
  touch-action: none;
  cursor: grab;
}

canvas:active { cursor: grabbing; }

.canvas-controls {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: center;
}

.canvas-controls button {
  background: #334155;
  color: #e2e8f0;
  border: none;
  border-radius: 8px;
  padding: 8px 16px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: background 0.2s;
}

.canvas-controls button:hover { background: #475569; }
.canvas-controls button.active {
  background: #60a5fa;
  color: #0f172a;
  font-weight: 600;
}

.canvas-hint {
  color: #94a3b8;
  font-size: 0.85rem;
  text-align: center;
}

/* Steps */
.step {
  border-left: 3px solid #334155;
  padding: 16px 20px;
  margin-left: 14px;
  position: relative;
  margin-bottom: 2px;
}

.step::before {
  content: '';
  position: absolute;
  left: -8px;
  top: 20px;
  width: 13px;
  height: 13px;
  background: #60a5fa;
  border-radius: 50%;
  border: 2px solid #1e293b;
}

.step-title {
  color: #60a5fa;
  font-weight: 700;
  font-size: 1.05rem;
  margin-bottom: 10px;
}

.step .muted { color: #94a3b8; font-size: 0.95rem; }

/* Checkpoint */
.checkpoint {
  background: #172033;
  border: 1px dashed #a78bfa;
  border-radius: 10px;
  padding: 14px 18px;
  margin: 14px 0;
  cursor: pointer;
  user-select: none;
  transition: all 0.2s;
}

.checkpoint:hover { border-color: #60a5fa; }

.checkpoint .question { font-weight: 600; color: #a78bfa; }
.checkpoint .answer {
  display: none;
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid #334155;
  color: #4ade80;
}

.checkpoint.open .answer { display: block; }

/* Key insight */
.insight-box {
  background: linear-gradient(135deg, rgba(96,165,250,0.1), rgba(167,139,250,0.1));
  border: 1px solid #60a5fa;
  border-radius: 12px;
  padding: 20px 24px;
}

.insight-box .label {
  font-weight: 700;
  color: #60a5fa;
  margin-bottom: 8px;
  font-size: 1.05rem;
}

/* Final answer */
.final-answer {
  background: rgba(52,211,153,0.08);
  border: 2px solid #34d399;
  text-align: center;
  padding: 24px;
}

.final-answer .big-answer {
  font-size: 2rem;
  font-weight: 800;
  color: #4ade80;
  margin: 12px 0;
}

.final-answer .verification {
  color: #94a3b8;
  font-size: 0.95rem;
  text-align: left;
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid #334155;
}

/* Pitfalls */
.pitfall-item {
  background: rgba(244,114,182,0.07);
  border-left: 3px solid #f472b6;
  padding: 12px 16px;
  border-radius: 0 10px 10px 0;
  margin-bottom: 10px;
}

.pitfall-item strong { color: #f472b6; }

/* Challenge */
.challenge-box {
  background: linear-gradient(135deg, rgba(167,139,250,0.1), rgba(244,114,182,0.1));
  border: 1px solid #a78bfa;
  border-radius: 12px;
  padding: 20px 24px;
}

@media (max-width: 700px) {
  body { padding: 12px; }
  .card { padding: 18px; }
  h1 { font-size: 1.5rem; }
  .options-grid { grid-template-columns: repeat(3, 1fr); }
  .step { padding: 12px 14px; margin-left: 10px; }
}
</style>
</head>
<body>
<div class="container">

<!-- TITLE -->
<div class="card" style="text-align:center;">
  <h1>Ugao između prostornih dijagonala kocke</h1>
  <p style="color:#94a3b8; margin-top:8px;">Prostorna geometrija &bull; Skalarni proizvod &bull; Kocka</p>
</div>

<!-- PROBLEM STATEMENT -->
<div class="card">
  <h2>Zadatak</h2>
  <div class="problem-statement">
    <p>Ako je \(\alpha\) oštar ugao između prostornih dijagonala kocke, tada je \(\operatorname{tg} \alpha\) jednak:</p>
  </div>
  <div class="options-grid">
    <div class="option-box">(A) \(\dfrac{\sqrt{2}}{2}\)</div>
    <div class="option-box">(B) \(\sqrt{2}\)</div>
    <div class="option-box">(C) \(\dfrac{\sqrt{2}}{4}\)</div>
    <div class="option-box correct">(D) \(2\sqrt{2}\)</div>
    <div class="option-box">(E) \(3\sqrt{2}\)</div>
  </div>
</div>

<!-- PLAN -->
<div class="card">
  <h2>Plan rešavanja</h2>
  <ol class="plan-list">
    <li>Postaviti kocku u koordinatni sistem i odrediti koordinate svih temena</li>
    <li>Identifikovati sve četiri prostorne dijagonale i njihove vektore pravca</li>
    <li>Pomoću skalarnog proizvoda izračunati kosinus ugla između dve dijagonale</li>
    <li>Iz kosinusa odrediti tangens oštrog ugla</li>
    <li>Verifikovati rezultat na više parova dijagonala</li>
  </ol>
</div>

<!-- THEORY (collapsible) -->
<div class="card" style="padding:0;">
  <details>
    <summary>Teorijsko podsetnik — Skalarni proizvod i ugao između vektora</summary>
    <div class="theory-body">
      <p><strong>Prostorna dijagonala kocke</strong> je duž koja spaja dva nasuprotna temena kocke (temena koja nemaju zajedničku ivicu, stranicu, niti stranicu dijagonalu). Kocka ima tačno <strong>4 prostorne dijagonale</strong>.</p>

      <h3>Dužina prostorne dijagonale</h3>
      <p>Za kocku stranice \(a\), prostorna dijagonala ima dužinu:</p>
      \[ d = a\sqrt{3} \]

      <h3>Skalarni proizvod</h3>
      <p>Za vektore \(\vec{u}\) i \(\vec{v}\), ugao \(\alpha\) između njih zadovoljava:</p>
      \[ \cos \alpha = \frac{\vec{u} \cdot \vec{v}}{|\vec{u}| \cdot |\vec{v}|} \]
      <p>gde je \(\vec{u} \cdot \vec{v} = u_1 v_1 + u_2 v_2 + u_3 v_3\).</p>

      <h3>Veza trigonometrijskih funkcija</h3>
      <ul>
        <li>\(\sin^2\alpha + \cos^2\alpha = 1\)</li>
        <li>\(\operatorname{tg} \alpha = \dfrac{\sin \alpha}{\cos \alpha}\)</li>
        <li>Ako je \(\cos \alpha = \dfrac{1}{3}\), tada je \(\operatorname{tg} \alpha = \dfrac{\sqrt{1 - \cos^2\alpha}}{\cos\alpha}\)</li>
      </ul>
    </div>
  </details>
</div>

<!-- VISUAL AID — 3D Cube Canvas -->
<div class="card">
  <h2>Vizuelni prikaz</h2>
  <div class="canvas-wrap">
    <canvas id="cubeCanvas" width="520" height="520"></canvas>
    <div class="canvas-controls">
      <button id="btnAllDiags" class="active">Sve dijagonale</button>
      <button id="btnPair12">Par d₁ & d₂</button>
      <button id="btnPair13">Par d₁ & d₃</button>
      <button id="btnPair14">Par d₁ & d₄</button>
      <button id="btnAnimate">Automatska rotacija</button>
    </div>
    <p class="canvas-hint">Prevlačite mišem ili prstom da rotirate kocku</p>
  </div>
</div>

<!-- STEP-BY-STEP SOLUTION -->
<div class="card">
  <h2>Rešenje korak po korak</h2>

  <!-- Step 1 -->
  <div class="step">
    <div class="step-title">Korak 1: Postavljanje koordinatnog sistema</div>
    <p>Postavimo kocku stranice \(a\) tako da jedno teme bude u koordinatnom početku, a ivice duž koordinatnih osa:</p>
    \[
    O(0,0,0),\; A(a,0,0),\; B(0,a,0),\; C(0,0,a)
    \]
    \[
    D(a,a,0),\; E(a,0,a),\; F(0,a,a),\; G(a,a,a)
    \]
    <p class="muted">Ovo je 8 temena kocke. Svako teme ima nasuprotno teme — ono koje je najudaljenije od njega.</p>
  </div>

  <!-- Step 2 -->
  <div class="step">
    <div class="step-title">Korak 2: Identifikacija prostornih dijagonala</div>
    <p>Četiri para nasuprotnih temena daju četiri prostorne dijagonale:</p>
    \[
    \begin{aligned}
    \mathbf{d_1} &: O(0,0,0) \to G(a,a,a) &\Rightarrow \vec{d_1} &= (1,\,1,\,1) \\
    \mathbf{d_2} &: A(a,0,0) \to F(0,a,a) &\Rightarrow \vec{d_2} &= (-1,\,1,\,1) \\
    \mathbf{d_3} &: B(0,a,0) \to E(a,0,a) &\Rightarrow \vec{d_3} &= (1,\,-1,\,1) \\
    \mathbf{d_4} &: C(0,0,a) \to D(a,a,0) &\Rightarrow \vec{d_4} &= (1,\,1,\,-1)
    \end{aligned}
    \]
    <p class="muted">Koristimo jedinične vektore pravca (bez faktora \(a\)) jer nas zanima samo ugao, ne dužina.</p>
  </div>

  <!-- Checkpoint 1 -->
  <div class="checkpoint" onclick="this.classList.toggle('open')">
    <div class="question">Proveri se: Kolika je dužina svake prostorne dijagonale kocke stranice \(a\)?</div>
    <div class="answer">Dužina je \(|\vec{d}| = \sqrt{a^2 + a^2 + a^2} = a\sqrt{3}\). Svaki vektor pravca ima intenzitet \(\sqrt{1^2+1^2+1^2} = \sqrt{3}\).</div>
  </div>

  <!-- Step 3 -->
  <div class="step">
    <div class="step-title">Korak 3: Skalarni proizvod za par \(\mathbf{d_1}\) i \(\mathbf{d_2}\)</div>
    <p>Izaberimo dijagonale \(\vec{d_1} = (1,1,1)\) i \(\vec{d_2} = (-1,1,1)\):</p>
    \[
    \vec{d_1} \cdot \vec{d_2} = 1 \cdot (-1) + 1 \cdot 1 + 1 \cdot 1 = -1 + 1 + 1 = 1
    \]
    \[
    |\vec{d_1}| = \sqrt{3}, \quad |\vec{d_2}| = \sqrt{3}
    \]
    \[
    \cos \alpha = \frac{|\vec{d_1} \cdot \vec{d_2}|}{|\vec{d_1}| \cdot |\vec{d_2}|} = \frac{|1|}{\sqrt{3} \cdot \sqrt{3}} = \frac{1}{3}
    \]
    <p class="muted">Uzimamo apsolutnu vrednost jer tražimo <strong>oštar</strong> ugao (ugao može biti i tup, ali nas zanima oštar).</p>
  </div>

  <!-- Checkpoint 2 -->
  <div class="checkpoint" onclick="this.classList.toggle('open')">
    <div class="question">Proveri se: Zašto uzimamo apsolutnu vrednost skalarnog proizvoda?</div>
    <div class="answer">Jer svaka dijagonala ima dva smera. Ugao između pravih (ne vektora) je uvek između \(0°\) i \(90°\). Apsolutna vrednost obezbeđuje da dobijemo oštar ugao.</div>
  </div>

  <!-- Step 4 -->
  <div class="step">
    <div class="step-title">Korak 4: Računanje tangensa</div>
    <p>Znamo da je \(\cos \alpha = \dfrac{1}{3}\). Sada nalazimo \(\sin \alpha\):</p>
    \[
    \sin^2 \alpha = 1 - \cos^2 \alpha = 1 - \frac{1}{9} = \frac{8}{9}
    \]
    \[
    \sin \alpha = \frac{\sqrt{8}}{3} = \frac{2\sqrt{2}}{3}
    \]
    <p>Konačno, tangens:</p>
    \[
    \operatorname{tg} \alpha = \frac{\sin \alpha}{\cos \alpha} = \frac{\;\dfrac{2\sqrt{2}}{3}\;}{\;\dfrac{1}{3}\;} = \frac{2\sqrt{2}}{3} \cdot \frac{3}{1} = 2\sqrt{2}
    \]
  </div>

  <!-- Step 5 -->
  <div class="step">
    <div class="step-title">Korak 5: Verifikacija sa drugim parovima dijagonala</div>
    <p>Proverimo sa parom \(\vec{d_1} = (1,1,1)\) i \(\vec{d_3} = (1,-1,1)\):</p>
    \[
    \vec{d_1} \cdot \vec{d_3} = 1 \cdot 1 + 1 \cdot (-1) + 1 \cdot 1 = 1 - 1 + 1 = 1 \quad \Rightarrow \quad \cos \alpha = \frac{1}{3} \;\checkmark
    \]
    <p>I sa parom \(\vec{d_2} = (-1,1,1)\) i \(\vec{d_3} = (1,-1,1)\):</p>
    \[
    \vec{d_2} \cdot \vec{d_3} = (-1)(1) + (1)(-1) + (1)(1) = -1 - 1 + 1 = -1 \quad \Rightarrow \quad \cos \alpha = \frac{|-1|}{3} = \frac{1}{3} \;\checkmark
    \]
    <p class="muted">Svi parovi ne-paralelnih prostornih dijagonala kocke zaklapaju isti ugao! To je posledica visoke simetrije kocke.</p>
  </div>

  <!-- Checkpoint 3 -->
  <div class="checkpoint" onclick="this.classList.toggle('open')">
    <div class="question">Proveri se: Koliko ukupno ima parova prostornih dijagonala?</div>
    <div class="answer">Ima \(\binom{4}{2} = 6\) parova. Svaki par zakapa isti ugao \(\alpha\) sa \(\cos \alpha = \frac{1}{3}\) i \(\operatorname{tg} \alpha = 2\sqrt{2}\).</div>
  </div>
</div>

<!-- KEY INSIGHT -->
<div class="card">
  <div class="insight-box">
    <div class="label">Ključni uvid</div>
    <p>Vektori pravca prostornih dijagonala kocke su oblika \((\pm 1, \pm 1, \pm 1)\) sa tačno jednim ili nijednim minusom (jer drugu dijagonalu svakog para možemo preusmeriti). Skalarni proizvod bilo koja dva različita vektora ovog oblika daje \(\pm 1\), pa je \(\cos \alpha = \frac{1}{3}\) — univerzalna konstanta za kocku. Otuda je \(\operatorname{tg} \alpha = 2\sqrt{2}\) takođe univerzalna konstanta, nezavisna od dužine stranice.</p>
  </div>
</div>

<!-- FINAL ANSWER -->
<div class="card final-answer">
  <h2 style="justify-content:center;">Konačan odgovor</h2>
  <div class="big-answer">\(\operatorname{tg} \alpha = 2\sqrt{2}\)</div>
  <p style="font-size:1.2rem; color:#4ade80; font-weight:600;">Tačan odgovor je (D)</p>

  <div class="options-grid" style="margin-top:18px;">
    <div class="option-box">(A) \(\dfrac{\sqrt{2}}{2}\)</div>
    <div class="option-box">(B) \(\sqrt{2}\)</div>
    <div class="option-box">(C) \(\dfrac{\sqrt{2}}{4}\)</div>
    <div class="option-box correct">(D) \(2\sqrt{2}\)</div>
    <div class="option-box">(E) \(3\sqrt{2}\)</div>
  </div>

  <div class="verification">
    <strong style="color:#60a5fa;">Verifikacija:</strong>
    <ul style="margin-left:20px; margin-top:8px;">
      <li>\(\cos \alpha = \frac{1}{3} \approx 0{,}333\), dakle \(\alpha \approx 70{,}53°\) — zaista oštar ugao ✓</li>
      <li>\(\operatorname{tg}(70{,}53°) \approx 2{,}828 = 2\sqrt{2}\) ✓</li>
      <li>Svih 6 parova dijagonala daju isti ugao (simetrija kocke) ✓</li>
      <li>Numerička provera: \(2\sqrt{2} \approx 2{,}828\), a \(\frac{\sin\alpha}{\cos\alpha} = \frac{2\sqrt{2}/3}{1/3} = 2\sqrt{2}\) ✓</li>
    </ul>
  </div>
</div>

<!-- COMMON PITFALLS -->
<div class="card">
  <h2 style="color:#f472b6;">Česte greške</h2>
  <div class="pitfall-item">
    <strong>Mešanje prostorne i straničke dijagonale:</strong> Stranička dijagonala leži u jednoj stranici kocke i ima dužinu \(a\sqrt{2}\). Prostorna dijagonala prolazi kroz unutrašnjost kocke i ima dužinu \(a\sqrt{3}\). U ovom zadatku se traže prostorne.
  </div>
  <div class="pitfall-item">
    <strong>Zaboravljanje apsolutne vrednosti:</strong> Bez apsolutne vrednosti u formuli za kosinus, dobija se i tup ugao. Zadatak eksplicitno traži oštar ugao \(\alpha\).
  </div>
  <div class="pitfall-item">
    <strong>Greška u računanju tangensa:</strong> Česta greška je da se izračuna \(\cos \alpha = \frac{1}{3}\) i onda direktno zaključi da je \(\operatorname{tg}\alpha = \frac{1}{\sqrt{3-1}}\) ili slično. Treba pažljivo: \(\operatorname{tg}\alpha = \frac{\sqrt{1 - \frac{1}{9}}}{\frac{1}{3}} = \frac{\frac{2\sqrt{2}}{3}}{\frac{1}{3}} = 2\sqrt{2}\).
  </div>
  <div class="pitfall-item">
    <strong>Pogrešno postavljanje vektora:</strong> Ako se umesto vektora pravca koriste koordinate temena (bez oduzimanja), rezultat će biti pogrešan.
  </div>
</div>

<!-- OPTIONAL CHALLENGE -->
<div class="card">
  <div class="challenge-box">
    <h2 style="color:#a78bfa;">Dodatni izazov</h2>
    <p>Ako umesto kocke posmatramo <strong>pravougaoni paralelopiped</strong> (kutiju) sa stranicama \(a\), \(b\) i \(c\), koliki je ugao između prostornih dijagonala? Da li su svi uglovi između dijagonala i dalje jednaki?</p>
    <p style="color:#94a3b8; margin-top:10px;"><em>Savet: Vektori pravca dijagonala biće \((\pm a, \pm b, \pm c)\). Pokušajte za \(a = 1, b = 2, c = 3\) — da li su svi uglovi isti?</em></p>
  </div>
</div>

</div><!-- /container -->

<!-- 3D Cube Visualization Script -->
<script>
(function() {
  const canvas = document.getElementById('cubeCanvas');
  const ctx = canvas.getContext('2d');

  // State
  let rotX = -0.45;
  let rotY = 0.65;
  let dragging = false;
  let lastX = 0, lastY = 0;
  let animating = false;
  let animFrame = null;
  let showMode = 'all'; // 'all', 'pair12', 'pair13', 'pair14'

  // Cube vertices (unit cube centered at origin)
  const s = 1;
  const vertices = [
    [-s,-s,-s], [s,-s,-s], [-s,s,-s], [-s,-s,s],
    [s,s,-s], [s,-s,s], [-s,s,s], [s,s,s]
  ];

  const labels = ['O', 'A', 'B', 'C', 'D', 'E', 'F', 'G'];

  // Edges (pairs of vertex indices)
  const edges = [
    [0,1],[0,2],[0,3],[1,4],[1,5],[2,4],[2,6],[3,5],[3,6],[4,7],[5,7],[6,7]
  ];

  // Spatial diagonals
  const diagonals = [
    { from: 0, to: 7, label: 'd\u2081', color: '#60a5fa' },   // O→G
    { from: 1, to: 6, label: 'd\u2082', color: '#a78bfa' },   // A→F
    { from: 2, to: 5, label: 'd\u2083', color: '#f472b6' },   // B→E
    { from: 3, to: 4, label: 'd\u2084', color: '#34d399' }    // C→D
  ];

  function rotatePoint(p, rx, ry) {
    let [x, y, z] = p;
    // Rotate around Y
    let cosY = Math.cos(ry), sinY = Math.sin(ry);
    let x1 = x * cosY + z * sinY;
    let z1 = -x * sinY + z * cosY;
    // Rotate around X
    let cosX = Math.cos(rx), sinX = Math.sin(rx);
    let y1 = y * cosX - z1 * sinX;
    let z2 = y * sinX + z1 * cosX;
    return [x1, y1, z2];
  }

  function project(p) {
    const scale = canvas.width * 0.28;
    const cx = canvas.width / 2;
    const cy = canvas.height / 2;
    const perspective = 4;
    const factor = perspective / (perspective + p[2]);
    return [cx + p[0] * scale * factor, cy - p[1] * scale * factor, p[2]];
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Transform vertices
    const transformed = vertices.map(v => rotatePoint(v, rotX, rotY));
    const projected = transformed.map(v => project(v));

    // Draw edges
    ctx.lineWidth = 1.5;
    ctx.strokeStyle = '#475569';
    edges.forEach(([i, j]) => {
      ctx.beginPath();
      ctx.moveTo(projected[i][0], projected[i][1]);
      ctx.lineTo(projected[j][0], projected[j][1]);
      ctx.stroke();
    });

    // Determine which diagonals to show
    let diagsToShow = [];
    if (showMode === 'all') diagsToShow = [0,1,2,3];
    else if (showMode === 'pair12') diagsToShow = [0,1];
    else if (showMode === 'pair13') diagsToShow = [0,2];
    else if (showMode === 'pair14') diagsToShow = [0,3];

    // Draw diagonals
    diagsToShow.forEach(idx => {
      const d = diagonals[idx];
      ctx.lineWidth = 3;
      ctx.strokeStyle = d.color;
      ctx.setLineDash([]);
      ctx.beginPath();
      ctx.moveTo(projected[d.from][0], projected[d.from][1]);
      ctx.lineTo(projected[d.to][0], projected[d.to][1]);
      ctx.stroke();

      // Label at midpoint
      const mx = (projected[d.from][0] + projected[d.to][0]) / 2;
      const my = (projected[d.from][1] + projected[d.to][1]) / 2;
      ctx.font = 'bold 16px Segoe UI, sans-serif';
      ctx.fillStyle = d.color;
      ctx.textAlign = 'center';
      ctx.fillText(d.label, mx + 14, my - 6);
    });

    // Draw angle arc if showing a pair
    if (showMode !== 'all' && diagsToShow.length === 2) {
      const d1 = diagonals[diagsToShow[0]];
      const d2 = diagonals[diagsToShow[1]];

      // Find intersection point (center of cube)
      const center3d = rotatePoint([0, 0, 0], rotX, rotY);
      const centerP = project(center3d);

      // Direction vectors in projected space
      const dir1x = projected[d1.to][0] - projected[d1.from][0];
      const dir1y = projected[d1.to][1] - projected[d1.from][1];
      const dir2x = projected[d2.to][0] - projected[d2.from][0];
      const dir2y = projected[d2.to][1] - projected[d2.from][1];

      const angle1 = Math.atan2(-dir1y, dir1x);
      const angle2 = Math.atan2(-dir2y, dir2x);

      // Draw arc
      const arcRadius = 35;
      ctx.lineWidth = 2;
      ctx.strokeStyle = '#fbbf24';
      ctx.setLineDash([]);
      ctx.beginPath();

      let startAngle = -angle1;
      let endAngle = -angle2;
      // Ensure we draw the smaller arc
      let diff = endAngle - startAngle;
      while (diff > Math.PI) diff -= 2 * Math.PI;
      while (diff < -Math.PI) diff += 2 * Math.PI;

      ctx.arc(centerP[0], centerP[1], arcRadius, startAngle, startAngle + diff, diff < 0);
      ctx.stroke();

      // Angle label
      const midAngle = startAngle + diff / 2;
      const labelDist = arcRadius + 18;
      ctx.font = 'bold 15px Segoe UI, sans-serif';
      ctx.fillStyle = '#fbbf24';
      ctx.textAlign = 'center';
      ctx.fillText('\u03b1', centerP[0] + labelDist * Math.cos(midAngle), centerP[1] + labelDist * Math.sin(midAngle));
    }

    ctx.setLineDash([]);

    // Draw vertex points and labels
    projected.forEach((p, i) => {
      // Vertex dot
      ctx.beginPath();
      ctx.arc(p[0], p[1], 5, 0, Math.PI * 2);
      ctx.fillStyle = '#e2e8f0';
      ctx.fill();
      ctx.strokeStyle = '#0f172a';
      ctx.lineWidth = 1.5;
      ctx.stroke();

      // Label
      ctx.font = 'bold 14px Segoe UI, sans-serif';
      ctx.fillStyle = '#94a3b8';
      ctx.textAlign = 'center';
      // Offset label based on position
      const ox = transformed[i][0] > 0 ? 14 : -14;
      const oy = transformed[i][1] > 0 ? -12 : 16;
      ctx.fillText(labels[i], p[0] + ox, p[1] + oy);
    });

    // Info text
    ctx.font = '13px Segoe UI, sans-serif';
    ctx.fillStyle = '#94a3b8';
    ctx.textAlign = 'left';
    if (showMode === 'all') {
      ctx.fillText('Sve 4 prostorne dijagonale kocke', 14, canvas.height - 14);
    } else {
      const names = {
        'pair12': 'd\u2081(1,1,1) i d\u2082(\u22121,1,1) \u2192 cos \u03b1 = 1/3 \u2192 tg \u03b1 = 2\u221a2',
        'pair13': 'd\u2081(1,1,1) i d\u2083(1,\u22121,1) \u2192 cos \u03b1 = 1/3 \u2192 tg \u03b1 = 2\u221a2',
        'pair14': 'd\u2081(1,1,1) i d\u2084(1,1,\u22121) \u2192 cos \u03b1 = 1/3 \u2192 tg \u03b1 = 2\u221a2'
      };
      ctx.fillText(names[showMode], 14, canvas.height - 14);
    }
  }

  function animate() {
    if (!animating) return;
    rotY += 0.008;
    rotX += 0.003;
    draw();
    animFrame = requestAnimationFrame(animate);
  }

  // Mouse interaction
  canvas.addEventListener('pointerdown', e => {
    dragging = true;
    lastX = e.clientX;
    lastY = e.clientY;
    canvas.setPointerCapture(e.pointerId);
  });

  canvas.addEventListener('pointermove', e => {
    if (!dragging) return;
    const dx = e.clientX - lastX;
    const dy = e.clientY - lastY;
    rotY += dx * 0.008;
    rotX += dy * 0.008;
    lastX = e.clientX;
    lastY = e.clientY;
    if (!animating) draw();
  });

  canvas.addEventListener('pointerup', () => { dragging = false; });

  // Buttons
  const btnAll = document.getElementById('btnAllDiags');
  const btnP12 = document.getElementById('btnPair12');
  const btnP13 = document.getElementById('btnPair13');
  const btnP14 = document.getElementById('btnPair14');
  const btnAnim = document.getElementById('btnAnimate');

  function setActive(btn) {
    [btnAll, btnP12, btnP13, btnP14].forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  }

  btnAll.addEventListener('click', () => { showMode = 'all'; setActive(btnAll); if (!animating) draw(); });
  btnP12.addEventListener('click', () => { showMode = 'pair12'; setActive(btnP12); if (!animating) draw(); });
  btnP13.addEventListener('click', () => { showMode = 'pair13'; setActive(btnP13); if (!animating) draw(); });
  btnP14.addEventListener('click', () => { showMode = 'pair14'; setActive(btnP14); if (!animating) draw(); });

  btnAnim.addEventListener('click', () => {
    animating = !animating;
    btnAnim.classList.toggle('active', animating);
    btnAnim.textContent = animating ? 'Zaustavi rotaciju' : 'Automatska rotacija';
    if (animating) animate();
    else if (animFrame) cancelAnimationFrame(animFrame);
  });

  // Handle resize for responsiveness
  function handleResize() {
    const containerWidth = canvas.parentElement.clientWidth;
    const size = Math.min(520, containerWidth - 20);
    canvas.width = size;
    canvas.height = size;
    draw();
  }

  window.addEventListener('resize', handleResize);
  handleResize();
})();
</script>

</body>
</html>
<!--BRAINSPARK_META
{"title":"Ugao između prostornih dijagonala kocke","subject":"math","unit":"geometry","topic_tags":["prostorna geometrija","kocka","skalarni proizvod","ugao između vektora","trigonometrija"]}
BRAINSPARK_META-->