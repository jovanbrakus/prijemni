<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Obim trapeza opisanog oko kruga</title>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<script type="text/info" id="logic-scratchpad">
Problem: Oko kruga je opisan trapez cija srednja linija iznosi 8 cm. Obim trapeza je?
Ponudjeni odgovori: (A) 16, (B) 24, (C) 32, (D) 36, (E) 30

Korak 1: Oznacimo stranice trapeza
  Neka su a i c paralelne stranice (osnove), a b i d krakovi.
  Srednja linija trapeza = (a + c) / 2 = 8
  Dakle a + c = 16.

Korak 2: Osobina tangentnog cetvorougla
  Trapez je opisan oko kruga, sto znaci da krug dodiruje sve cetiri stranice.
  Za svaki cetvorougao opisan oko kruga vazi:
  a + c = b + d (zbir naspramnih stranica je jednak)

Korak 3: Racunanje obima
  Obim = a + b + c + d = (a + c) + (b + d) = 16 + 16 = 32

Odgovor: (C) 32

Verifikacija: Na primer, trapez sa a=10, c=6, b=9, d=7.
  Srednja linija = (10+6)/2 = 8 ✓
  a+c = 16, b+d = 16 ✓ (tangentni)
  Obim = 10+9+6+7 = 32 ✓
</script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  font-size: 2.2rem;
  font-weight: 800;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
  line-height: 1.3;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 30px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.4rem;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.card h3 {
  color: #e2e8f0;
  font-size: 1.15rem;
  margin-bottom: 10px;
}

.highlight {
  color: #f472b6;
  font-weight: 600;
}

.math-box {
  background: rgba(56,189,248,0.08);
  border: 1px solid rgba(56,189,248,0.15);
  border-radius: 10px;
  padding: 16px 20px;
  margin: 12px 0;
  overflow-x: auto;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 14px;
}

.given-item {
  background: rgba(96,165,250,0.08);
  border: 1px solid rgba(96,165,250,0.15);
  border-radius: 10px;
  padding: 12px 18px;
  min-width: 100px;
  text-align: center;
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-bottom: 4px;
}

.given-item .value {
  color: #60a5fa;
  font-size: 1.15rem;
  font-weight: 700;
}

.plan-card {
  border-left: 4px solid #a78bfa;
}

.plan-card h2 { color: #a78bfa; }

details {
  margin: 15px 0;
}

details summary {
  cursor: pointer;
  color: #60a5fa;
  font-weight: 600;
  padding: 10px 14px;
  background: rgba(96,165,250,0.06);
  border-radius: 8px;
  border: 1px solid rgba(96,165,250,0.12);
  list-style: none;
  user-select: none;
}

details summary::-webkit-details-marker { display: none; }

details summary::before {
  content: '\25B8 ';
  display: inline;
}

details[open] summary::before {
  content: '\25BE ';
}

details .details-content {
  padding: 14px 18px;
  margin-top: 8px;
  background: rgba(96,165,250,0.04);
  border-radius: 8px;
  border: 1px solid rgba(96,165,250,0.08);
}

.step-container {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
  align-items: flex-start;
}

.step-badge {
  min-width: 34px;
  height: 34px;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 800;
  font-size: 0.95rem;
  color: #0f172a;
  margin-top: 2px;
  flex-shrink: 0;
}

.step-content {
  flex: 1;
  min-width: 0;
}

.step-content h3 {
  margin-bottom: 8px;
}

.insight-box {
  background: linear-gradient(135deg, rgba(96,165,250,0.12), rgba(167,139,250,0.12));
  border: 1px solid rgba(167,139,250,0.3);
  border-radius: 14px;
  padding: 22px 26px;
  margin-bottom: 24px;
}

.insight-box h2 { color: #a78bfa; }

.final-answer-box {
  background: linear-gradient(135deg, rgba(52,211,153,0.1), rgba(74,222,128,0.08));
  border: 2px solid rgba(52,211,153,0.35);
  border-radius: 16px;
  padding: 28px;
  text-align: center;
  margin-bottom: 24px;
}

.final-answer-box .answer-value {
  font-size: 2.4rem;
  font-weight: 800;
  color: #4ade80;
  margin: 16px 0;
}

.options-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
  margin: 18px 0;
}

.option-chip {
  background: rgba(96,165,250,0.08);
  border: 1px solid #334155;
  border-radius: 10px;
  padding: 10px 22px;
  font-size: 1.05rem;
  color: #94a3b8;
  transition: all 0.2s;
}

.option-chip.correct {
  background: rgba(52,211,153,0.15);
  border-color: #34d399;
  color: #4ade80;
  font-weight: 700;
  box-shadow: 0 0 20px rgba(52,211,153,0.15);
}

.pitfall-box {
  border-left: 4px solid #e09468;
}

.pitfall-box h2 { color: #e09468; }

.challenge-box {
  border-left: 4px solid #a78bfa;
}

.challenge-box h2 { color: #a78bfa; }

.canvas-wrapper {
  background: #0c1222;
  border-radius: 12px;
  border: 1px solid #334155;
  overflow: hidden;
  margin: 14px 0;
}

canvas {
  width: 100%;
  display: block;
  touch-action: none;
}

.provera-note {
  color: #94a3b8;
  font-size: 0.95rem;
  margin-top: 12px;
  padding: 12px 16px;
  background: rgba(52,211,153,0.05);
  border-radius: 8px;
  border: 1px solid rgba(52,211,153,0.12);
}

.formula-list {
  list-style: none;
  padding: 0;
}

.formula-list li {
  padding: 8px 0;
  border-bottom: 1px solid rgba(51,65,85,0.5);
}

.formula-list li:last-child { border-bottom: none; }

.case-box {
  background: rgba(167,139,250,0.06);
  border: 1px solid rgba(167,139,250,0.15);
  border-radius: 10px;
  padding: 16px 20px;
  margin: 12px 0;
}

.case-box .case-label {
  color: #a78bfa;
  font-weight: 700;
  font-size: 1.05rem;
  margin-bottom: 8px;
}

.arrow-chain {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  margin: 10px 0;
}

.arrow-chain .chain-item {
  background: rgba(96,165,250,0.1);
  border: 1px solid rgba(96,165,250,0.2);
  border-radius: 8px;
  padding: 6px 14px;
  color: #60a5fa;
  font-weight: 600;
}

.arrow-chain .chain-arrow {
  color: #94a3b8;
  font-size: 1.2rem;
}

@media (max-width: 700px) {
  h1 { font-size: 1.6rem; }
  .card { padding: 16px; }
  .step-container { flex-direction: column; gap: 8px; }
  .given-grid { flex-direction: column; }
  .options-grid { flex-direction: column; align-items: center; }
  .final-answer-box .answer-value { font-size: 1.8rem; }
}
</style>
</head>
<body>

<div class="container">

  <!-- Title -->
  <h1>Obim trapeza opisanog oko kruga</h1>
  <p class="subtitle">Primena osobine tangentnog cetvorougla i srednje linije trapeza</p>

  <!-- Problem Statement -->
  <div class="card">
    <h2>Postavka zadatka</h2>
    <p>Oko kruga je opisan trapez cija srednja linija iznosi \(8\) cm. Obim trapeza je (u cm):</p>
    <div class="given-grid">
      <div class="given-item">
        <div class="label">Odgovor (A)</div>
        <div class="value">\(16\)</div>
      </div>
      <div class="given-item">
        <div class="label">Odgovor (B)</div>
        <div class="value">\(24\)</div>
      </div>
      <div class="given-item">
        <div class="label">Odgovor (C)</div>
        <div class="value">\(32\)</div>
      </div>
      <div class="given-item">
        <div class="label">Odgovor (D)</div>
        <div class="value">\(36\)</div>
      </div>
      <div class="given-item">
        <div class="label">Odgovor (E)</div>
        <div class="value">\(30\)</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card plan-card">
    <h2>Plan resavanja</h2>
    <p>Koristicemo dve kljucne cinjenice: formulu za srednju liniju trapeza i osobinu
       cetvorougla opisanog oko kruga (tangentnog cetvorougla). Srednja linija nam daje
       zbir osnova, a tangentna osobina izjednacava zbir naspramnih stranica. Kombinujuci
       ove dve informacije, dobicemo obim.</p>
    <div class="arrow-chain">
      <div class="chain-item">Srednja linija = 8</div>
      <div class="chain-arrow">\(\Rightarrow\)</div>
      <div class="chain-item">\(a + c = 16\)</div>
      <div class="chain-arrow">\(\Rightarrow\)</div>
      <div class="chain-item">\(b + d = 16\)</div>
      <div class="chain-arrow">\(\Rightarrow\)</div>
      <div class="chain-item">Obim = 32</div>
    </div>
  </div>

  <!-- Theory Refresher -->
  <div class="card">
    <details>
      <summary>Podsetnik: Kljucne formule i osobine</summary>
      <div class="details-content">
        <ul class="formula-list">
          <li><strong>Srednja linija trapeza:</strong> \(s = \dfrac{a + c}{2}\), gde su \(a\) i \(c\) paralelne stranice (osnove)</li>
          <li><strong>Tangentni cetvorougao</strong> (cetvorougao opisan oko kruga): zbir naspramnih stranica je jednak, tj. \(a + c = b + d\)</li>
          <li><strong>Obim cetvorougla:</strong> \(O = a + b + c + d\)</li>
          <li><strong>Zasto vazi \(a + c = b + d\)?</strong> Kada krug dodiruje stranicu, tangentni odsecci iz istog temena su jednaki. Ako oznacimo te odsecke sa \(p, q, r, s\), tada je \(a = p + q\), \(b = q + r\), \(c = r + s\), \(d = s + p\), pa \(a + c = p + q + r + s = b + d\).</li>
        </ul>
      </div>
    </details>
  </div>

  <!-- Visual Aid -->
  <div class="card">
    <h2>Vizuelni prikaz</h2>
    <p style="color: #94a3b8; margin-bottom: 10px;">Trapez opisan oko kruga sa oznacenim stranicama i upisanim krugom koji dodiruje sve cetiri stranice. Prevlacite klizac da menjate odnos osnova.</p>
    <div class="canvas-wrapper">
      <canvas id="diagram" width="800" height="520"></canvas>
    </div>
    <p style="color: #94a3b8; font-size: 0.85rem; margin-top: 6px;">Prevlacite klizac ili dodirnite da menjate gornju osnovu \(c\) (zbir \(a + c = 16\) ostaje fiksan).</p>
  </div>

  <!-- Step-by-step Solution -->
  <div class="card">
    <h2>Resenje korak po korak</h2>

    <!-- Step 1 -->
    <div class="step-container">
      <div class="step-badge">1</div>
      <div class="step-content">
        <h3>Oznacimo stranice trapeza</h3>
        <p>Neka su \(a\) i \(c\) paralelne stranice (osnove) trapeza, pri cemu je \(a \geq c\). Neka su \(b\) i \(d\) krakovi (bocne stranice).</p>
        <div class="math-box">
          \[
          \text{Osnove: } a \text{ i } c \qquad \text{Krakovi: } b \text{ i } d
          \]
        </div>
      </div>
    </div>

    <!-- Step 2 -->
    <div class="step-container">
      <div class="step-badge">2</div>
      <div class="step-content">
        <h3>Iskoristimo srednju liniju trapeza</h3>
        <p>Srednja linija trapeza jednaka je poluzbiru paralelnih stranica:</p>
        <div class="math-box">
          \[
          s = \frac{a + c}{2} = 8 \quad \Longrightarrow \quad a + c = 16
          \]
        </div>
        <p>Dakle, zbir osnova trapeza je <span class="highlight">\(16\) cm</span>.</p>
      </div>
    </div>

    <!-- Checkpoint 1 -->
    <details>
      <summary>Proveri se: Sta je srednja linija trapeza?</summary>
      <div class="details-content">
        <p>Srednja linija trapeza je duz koja spaja sredista krakova. Njena duzina je
           uvek jednaka aritmetickoj sredini duzina dveju osnova:</p>
        <div class="math-box">
          \[s = \frac{a + c}{2}\]
        </div>
        <p>Na primer, ako je \(a = 10\) i \(c = 6\), srednja linija je \((10 + 6)/2 = 8\).</p>
      </div>
    </details>

    <!-- Step 3 -->
    <div class="step-container">
      <div class="step-badge">3</div>
      <div class="step-content">
        <h3>Primenimo osobinu tangentnog cetvorougla</h3>
        <p>Trapez je <em>opisan oko kruga</em>, sto znaci da krug dodiruje sve cetiri stranice trapeza. Za svaki takav cetvorougao vazi kljucna osobina:</p>
        <div class="math-box">
          \[
          a + c = b + d
          \]
        </div>
        <p>To znaci da je zbir naspramnih stranica jednak. Posto smo vec nasli da je \(a + c = 16\), odmah sledi:</p>
        <div class="math-box">
          \[
          b + d = 16
          \]
        </div>
      </div>
    </div>

    <!-- Checkpoint 2 -->
    <details>
      <summary>Proveri se: Zasto vazi \(a + c = b + d\)?</summary>
      <div class="details-content">
        <p>Kada je krug upisan u cetvorougao, svaka stranica je tangenta na krug. Iz svakog temena cetvorougla
           polaze dva tangentna odsecka do tacaka dodira, i ti odsecci su <strong>jednake duzine</strong>
           (osobina tangenti iz spoljasnje tacke).</p>
        <p>Oznacimo tangentne odsecke:</p>
        <div class="case-box">
          <div class="case-label">Iz temena A:</div>
          <p>Odsecci duzine \(p\) ka stranicama \(a\) i \(d\)</p>
        </div>
        <div class="case-box">
          <div class="case-label">Iz temena B:</div>
          <p>Odsecci duzine \(q\) ka stranicama \(a\) i \(b\)</p>
        </div>
        <div class="case-box">
          <div class="case-label">Iz temena C:</div>
          <p>Odsecci duzine \(r\) ka stranicama \(b\) i \(c\)</p>
        </div>
        <div class="case-box">
          <div class="case-label">Iz temena D:</div>
          <p>Odsecci duzine \(s\) ka stranicama \(c\) i \(d\)</p>
        </div>
        <p style="margin-top: 12px;">Tada je: \(a = p + q\), \(b = q + r\), \(c = r + s\), \(d = s + p\).</p>
        <div class="math-box">
          \[a + c = (p + q) + (r + s) = p + q + r + s\]
          \[b + d = (q + r) + (s + p) = p + q + r + s\]
        </div>
        <p>Dakle, \(a + c = b + d = p + q + r + s\).</p>
      </div>
    </details>

    <!-- Step 4 -->
    <div class="step-container">
      <div class="step-badge">4</div>
      <div class="step-content">
        <h3>Izracunamo obim trapeza</h3>
        <p>Obim je zbir svih cetiri stranice:</p>
        <div class="math-box">
          \[
          O = a + b + c + d = \underbrace{(a + c)}_{= 16} + \underbrace{(b + d)}_{= 16} = 16 + 16 = \boxed{32}
          \]
        </div>
        <p>Obim trapeza je <span class="highlight">\(32\) cm</span>.</p>
      </div>
    </div>
  </div>

  <!-- Key Insight -->
  <div class="insight-box">
    <h2>Kljucni uvid</h2>
    <p>Sustina resenja lezi u <strong>osobini tangentnog cetvorougla</strong>: zbir naspramnih stranica
       je jednak (\(a + c = b + d\)). Ova osobina, u kombinaciji sa formulom za srednju liniju,
       odmah daje obim bez potrebe da znamo pojedinacne duzine stranica!</p>
    <p style="margin-top: 10px; color: #94a3b8;">Zapravo, obim tangentnog trapeza uvek iznosi
       \(O = 4s\), gde je \(s\) srednja linija. Ovo je koristan precac za brzo resavanje slicnih zadataka.</p>
  </div>

  <!-- Final Answer -->
  <div class="final-answer-box">
    <h2 style="color: #34d399; margin-bottom: 10px;">Konacan odgovor</h2>
    <div class="options-grid">
      <div class="option-chip">(A) \(16\)</div>
      <div class="option-chip">(B) \(24\)</div>
      <div class="option-chip correct">(C) \(32\)</div>
      <div class="option-chip">(D) \(36\)</div>
      <div class="option-chip">(E) \(30\)</div>
    </div>
    <div class="answer-value">Odgovor je (C) 32 cm</div>
    <div class="provera-note">
      <strong>Provera:</strong> Konkretan primer -- trapez sa \(a = 10\), \(c = 6\), \(b = 9\), \(d = 7\):
      srednja linija = \((10 + 6)/2 = 8\) cm, tangentni uslov \(10 + 6 = 9 + 7 = 16\),
      obim = \(10 + 9 + 6 + 7 = 32\) cm.
    </div>
  </div>

  <!-- Common Pitfalls -->
  <div class="card pitfall-box">
    <h2>Ceste greske</h2>
    <ul style="list-style: disc; padding-left: 20px; color: #e2e8f0;">
      <li style="margin-bottom: 10px;"><strong>Zaboravljanje tangentne osobine:</strong>
        Bez osobine \(a + c = b + d\), ne mozemo odrediti obim samo na osnovu srednje linije.
        Kljucno je prepoznati da je trapez <em>opisan oko kruga</em>, a ne bilo koji trapez.</li>
      <li style="margin-bottom: 10px;"><strong>Mesanje srednje linije sa obimom:</strong>
        Srednja linija je \((a+c)/2 = 8\), pa je \(a + c = 16\). To je samo zbir osnova,
        ne ceo obim. Obim ukljucuje i krakove.</li>
      <li style="margin-bottom: 10px;"><strong>Odgovor 16 (samo zbir osnova):</strong>
        Cesta greska je zaboraviti da treba dodati i krakove -- odgovor 16 bi bio tacan
        samo da se trazi zbir osnova, ne ceo obim.</li>
      <li><strong>Nerazumevanje termina "opisan oko kruga":</strong>
        "Opisan oko kruga" znaci da krug dodiruje sve cetiri stranice cetvorougla iznutra
        (krug je upisan u trapez). Ovo je razlicito od "upisan u krug" (gde bi sva temena
        lezala na krugu).</li>
    </ul>
  </div>

  <!-- Optional Challenge -->
  <div class="card challenge-box">
    <h2>Bonus izazov</h2>
    <p>Oko kruga poluprecnika \(r = 4\) cm opisan je jednakokraki trapez cija srednja linija
       iznosi \(10\) cm. Kolika je povrsina tog trapeza?</p>
    <details>
      <summary>Pogledaj nagovestaj</summary>
      <div class="details-content">
        <p>Za tangentni cetvorougao vazi: \(P = r \cdot s\), gde je \(P\) povrsina, \(r\) poluprecnik
           upisanog kruga, a \(s\) poluobim. Obim tangentnog trapeza sa srednjom linijom 10 je
           \(O = 4 \cdot 10 = 40\), pa je poluobim \(s = 20\). Sada primeni formulu!</p>
      </div>
    </details>
  </div>

</div>

<script>
(() => {
  const canvas = document.getElementById('diagram');
  const ctx = canvas.getContext('2d');

  // Parameter: top base c (bottom base a = 16 - c)
  let cVal = 6;
  let dragging = false;
  let hoverSlider = false;

  const sliderY = 490;
  const sliderLeft = 100;
  const sliderRight = 700;

  function draw() {
    const dpr = window.devicePixelRatio || 1;
    const rect = canvas.getBoundingClientRect();
    canvas.width = rect.width * dpr;
    canvas.height = 520 * dpr;
    canvas.style.height = '520px';
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    const W = rect.width;
    const H = 520;
    const scaleX = W / 800;

    // Background
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    const a = 16 - cVal; // bottom base
    const c = cVal;       // top base

    // Compute inscribed circle radius
    // For a tangential trapezoid: area = r * semi-perimeter
    // Perimeter = 32, semi-perimeter = 16
    // For isosceles tangential trapezoid (we'll compute general case):
    // The legs: b + d = 16. We'll make it symmetric for visualization: b = d = 8
    const b = 8;
    const d = 8;
    const perimeter = a + b + c + d;
    const semiPerimeter = perimeter / 2; // = 16

    // Height of trapezoid: h = sqrt(b^2 - ((a - c)/2)^2) for isosceles
    const halfDiff = (a - c) / 2;
    const hSq = b * b - halfDiff * halfDiff;
    const h = hSq > 0 ? Math.sqrt(hSq) : 0;

    // Inscribed circle radius: r = Area / semiPerimeter
    const area = (a + c) / 2 * h;
    const r = semiPerimeter > 0 ? area / semiPerimeter : 0;

    // Drawing parameters
    const centerX = W / 2;
    const drawScale = scaleX * 18; // pixels per cm
    const topY = 70;
    const bottomY = topY + h * drawScale;
    const midY = (topY + bottomY) / 2;

    // Trapezoid vertices (Y-axis down in canvas)
    const Ax = centerX - (a / 2) * drawScale;
    const Ay = bottomY;
    const Bx = centerX + (a / 2) * drawScale;
    const By = bottomY;
    const Cx = centerX + (c / 2) * drawScale;
    const Cy = topY;
    const Dx = centerX - (c / 2) * drawScale;
    const Dy = topY;

    // Circle center
    const circleCX = centerX;
    const circleCY = midY;
    const circleR = r * drawScale;

    // Title
    ctx.fillStyle = '#60a5fa';
    ctx.font = 'bold ' + (15 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Trapez opisan oko kruga', centerX, 30 * scaleX);

    // Draw inscribed circle
    if (circleR > 0 && h > 0) {
      ctx.strokeStyle = '#a78bfa';
      ctx.lineWidth = 2.5;
      ctx.setLineDash([]);
      ctx.beginPath();
      ctx.arc(circleCX, circleCY, circleR, 0, Math.PI * 2);
      ctx.stroke();

      // Fill circle lightly
      ctx.fillStyle = 'rgba(167,139,250,0.06)';
      ctx.beginPath();
      ctx.arc(circleCX, circleCY, circleR, 0, Math.PI * 2);
      ctx.fill();

      // Circle center dot
      ctx.fillStyle = '#a78bfa';
      ctx.beginPath();
      ctx.arc(circleCX, circleCY, 3, 0, Math.PI * 2);
      ctx.fill();

      // Radius line
      ctx.strokeStyle = 'rgba(167,139,250,0.5)';
      ctx.lineWidth = 1;
      ctx.setLineDash([4, 3]);
      ctx.beginPath();
      ctx.moveTo(circleCX, circleCY);
      ctx.lineTo(circleCX, circleCY + circleR);
      ctx.stroke();
      ctx.setLineDash([]);

      // Radius label
      ctx.fillStyle = '#a78bfa';
      ctx.font = (12 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
      ctx.textAlign = 'left';
      ctx.fillText('r', circleCX + 5 * scaleX, circleCY + circleR / 2);

      // Draw tangent points (where circle touches each side)
      ctx.fillStyle = '#34d399';

      // Bottom tangent: center of bottom side (circle touches at (centerX, bottomY - ?) -- actually at (centerX, circleCY + circleR))
      // For isosceles: bottom tangent at center
      const tangBot = {x: circleCX, y: circleCY + circleR};
      const tangTop = {x: circleCX, y: circleCY - circleR};

      // Left side tangent point: foot of perpendicular from circle center to left leg
      // Left leg: from A(Ax, Ay) to D(Dx, Dy)
      const leftTang = footOfPerpendicular(circleCX, circleCY, Ax, Ay, Dx, Dy);
      const rightTang = footOfPerpendicular(circleCX, circleCY, Bx, By, Cx, Cy);

      // Draw tangent points
      const tangPoints = [tangBot, tangTop, leftTang, rightTang];
      for (const tp of tangPoints) {
        ctx.fillStyle = '#34d399';
        ctx.beginPath();
        ctx.arc(tp.x, tp.y, 4, 0, Math.PI * 2);
        ctx.fill();
      }

      // Draw tangent segments from vertices with labels
      // Tangent segment labels (p, q, r, s)
      ctx.setLineDash([3, 3]);
      ctx.strokeStyle = 'rgba(52,211,153,0.3)';
      ctx.lineWidth = 1;

      // From A: segments to tangBot and leftTang
      // From B: segments to tangBot and rightTang
      // From C: segments to tangTop and rightTang
      // From D: segments to tangTop and leftTang
      ctx.setLineDash([]);
    }

    // Draw trapezoid
    if (h > 0) {
      // Fill
      ctx.fillStyle = 'rgba(96,165,250,0.08)';
      ctx.beginPath();
      ctx.moveTo(Ax, Ay);
      ctx.lineTo(Bx, By);
      ctx.lineTo(Cx, Cy);
      ctx.lineTo(Dx, Dy);
      ctx.closePath();
      ctx.fill();

      // Stroke
      ctx.strokeStyle = '#60a5fa';
      ctx.lineWidth = 2.5;
      ctx.beginPath();
      ctx.moveTo(Ax, Ay);
      ctx.lineTo(Bx, By);
      ctx.lineTo(Cx, Cy);
      ctx.lineTo(Dx, Dy);
      ctx.closePath();
      ctx.stroke();

      // Side labels
      ctx.font = 'bold ' + (14 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
      ctx.textAlign = 'center';

      // Bottom side: a
      ctx.fillStyle = '#f472b6';
      ctx.fillText('a = ' + a.toFixed(1), (Ax + Bx) / 2, Ay + 22 * scaleX);

      // Top side: c
      ctx.fillStyle = '#f472b6';
      ctx.fillText('c = ' + c.toFixed(1), (Dx + Cx) / 2, Cy - 10 * scaleX);

      // Left side: d
      ctx.fillStyle = '#34d399';
      const leftMidX = (Ax + Dx) / 2;
      const leftMidY = (Ay + Dy) / 2;
      ctx.save();
      ctx.fillText('d = ' + d.toFixed(1), leftMidX - 28 * scaleX, leftMidY);
      ctx.restore();

      // Right side: b
      ctx.fillStyle = '#34d399';
      const rightMidX = (Bx + Cx) / 2;
      const rightMidY = (By + Cy) / 2;
      ctx.fillText('b = ' + b.toFixed(1), rightMidX + 28 * scaleX, rightMidY);

      // Middle line (dashed)
      const mlY = (Ay + Cy) / 2;
      const mlLeft = (Ax + Dx) / 2;
      const mlRight = (Bx + Cx) / 2;
      ctx.strokeStyle = '#fbbf24';
      ctx.lineWidth = 2;
      ctx.setLineDash([6, 4]);
      ctx.beginPath();
      ctx.moveTo(mlLeft, mlY);
      ctx.lineTo(mlRight, mlY);
      ctx.stroke();
      ctx.setLineDash([]);

      // Middle line label
      ctx.fillStyle = '#fbbf24';
      ctx.font = 'bold ' + (13 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
      ctx.fillText('s = 8', (mlLeft + mlRight) / 2, mlY - 8 * scaleX);

      // Vertex labels
      ctx.font = 'bold ' + (13 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
      ctx.fillStyle = '#e2e8f0';
      ctx.fillText('A', Ax - 14 * scaleX, Ay + 6);
      ctx.fillText('B', Bx + 14 * scaleX, By + 6);
      ctx.fillText('C', Cx + 14 * scaleX, Cy + 2);
      ctx.fillText('D', Dx - 14 * scaleX, Dy + 2);
    }

    // Info text below drawing
    const infoY = bottomY + 48 * scaleX;
    ctx.fillStyle = '#94a3b8';
    ctx.font = (12 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    const infoX = 40 * scaleX;

    ctx.fillStyle = '#f472b6';
    ctx.font = 'bold ' + (13 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
    ctx.fillText('Osnove:', infoX, infoY);
    ctx.font = (13 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
    ctx.fillStyle = '#e2e8f0';
    ctx.fillText('a + c = ' + a.toFixed(1) + ' + ' + c.toFixed(1) + ' = ' + (a + c).toFixed(1), infoX + 70 * scaleX, infoY);

    ctx.fillStyle = '#34d399';
    ctx.font = 'bold ' + (13 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
    ctx.fillText('Krakovi:', infoX, infoY + 24 * scaleX);
    ctx.font = (13 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
    ctx.fillStyle = '#e2e8f0';
    ctx.fillText('b + d = ' + b.toFixed(1) + ' + ' + d.toFixed(1) + ' = ' + (b + d).toFixed(1), infoX + 70 * scaleX, infoY + 24 * scaleX);

    ctx.fillStyle = '#4ade80';
    ctx.font = 'bold ' + (14 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Obim = (a + c) + (b + d) = ' + (a + c).toFixed(1) + ' + ' + (b + d).toFixed(1) + ' = ' + perimeter.toFixed(1) + ' cm', centerX, infoY + 56 * scaleX);

    // Tangent property highlight
    ctx.fillStyle = '#a78bfa';
    ctx.font = (12 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Tangentni uslov: a + c = b + d (zbir naspramnih stranica je jednak)', centerX, infoY + 80 * scaleX);

    // Slider
    const sY = sliderY * (H / 520);
    const sLeft = sliderLeft * scaleX;
    const sRight = sliderRight * scaleX;

    function cToSX(cv) {
      // c ranges from 1 to 15 (so a = 15 to 1)
      return sLeft + ((cv - 1) / 14) * (sRight - sLeft);
    }

    const sThumbX = cToSX(cVal);

    // Slider track
    ctx.strokeStyle = '#334155';
    ctx.lineWidth = 4;
    ctx.lineCap = 'round';
    ctx.beginPath();
    ctx.moveTo(sLeft, sY);
    ctx.lineTo(sRight, sY);
    ctx.stroke();

    // Active portion
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 4;
    ctx.beginPath();
    ctx.moveTo(sLeft, sY);
    ctx.lineTo(sThumbX, sY);
    ctx.stroke();

    // Thumb
    ctx.fillStyle = hoverSlider || dragging ? '#93c5fd' : '#60a5fa';
    ctx.beginPath();
    ctx.arc(sThumbX, sY, 10, 0, Math.PI * 2);
    ctx.fill();
    ctx.strokeStyle = '#0f172a';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.arc(sThumbX, sY, 10, 0, Math.PI * 2);
    ctx.stroke();

    // Slider labels
    ctx.fillStyle = '#94a3b8';
    ctx.font = (11 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('c = 1', sLeft, sY + 22);
    ctx.fillText('c = 15', sRight, sY + 22);
    ctx.fillStyle = '#60a5fa';
    ctx.font = 'bold ' + (12 * scaleX) + 'px Segoe UI, system-ui, sans-serif';
    ctx.fillText('c = ' + cVal.toFixed(1), sThumbX, sY - 18);
  }

  function footOfPerpendicular(px, py, ax, ay, bx, by) {
    const dx = bx - ax;
    const dy = by - ay;
    const t = ((px - ax) * dx + (py - ay) * dy) / (dx * dx + dy * dy);
    return {x: ax + t * dx, y: ay + t * dy};
  }

  function getCanvasCoords(e) {
    const rect = canvas.getBoundingClientRect();
    const scaleXVal = rect.width / 800;
    if (e.touches) {
      return {
        x: e.touches[0].clientX - rect.left,
        y: e.touches[0].clientY - rect.top,
        scaleX: scaleXVal
      };
    }
    return {
      x: e.clientX - rect.left,
      y: e.clientY - rect.top,
      scaleX: scaleXVal
    };
  }

  function isOnSlider(cx, cy, scaleXVal) {
    const sY = sliderY * (520 / 520); // Approximate
    const rr = canvas.getBoundingClientRect();
    const actualSY = sY * (rr.height / 520);
    const sLeft = sliderLeft * scaleXVal;
    const sRight = sliderRight * scaleXVal;
    return Math.abs(cy - actualSY) < 25 && cx >= sLeft - 15 && cx <= sRight + 15;
  }

  function updateC(cx, scaleXVal) {
    const sLeft = sliderLeft * scaleXVal;
    const sRight = sliderRight * scaleXVal;
    let newC = 1 + ((cx - sLeft) / (sRight - sLeft)) * 14;
    newC = Math.max(1, Math.min(15, newC));
    newC = Math.round(newC * 10) / 10;
    if (newC !== cVal) {
      cVal = newC;
      draw();
    }
  }

  canvas.addEventListener('mousedown', (e) => {
    const {x, y, scaleX} = getCanvasCoords(e);
    if (isOnSlider(x, y, scaleX)) {
      dragging = true;
      updateC(x, scaleX);
    }
  });

  canvas.addEventListener('mousemove', (e) => {
    const {x, y, scaleX} = getCanvasCoords(e);
    hoverSlider = isOnSlider(x, y, scaleX);
    if (dragging) {
      updateC(x, scaleX);
    } else {
      canvas.style.cursor = hoverSlider ? 'pointer' : 'default';
      draw();
    }
  });

  canvas.addEventListener('mouseup', () => { dragging = false; });
  canvas.addEventListener('mouseleave', () => { dragging = false; hoverSlider = false; draw(); });

  canvas.addEventListener('touchstart', (e) => {
    e.preventDefault();
    const {x, y, scaleX} = getCanvasCoords(e);
    if (isOnSlider(x, y, scaleX)) {
      dragging = true;
      updateC(x, scaleX);
    }
  }, { passive: false });

  canvas.addEventListener('touchmove', (e) => {
    e.preventDefault();
    if (dragging) {
      const {x, y, scaleX} = getCanvasCoords(e);
      updateC(x, scaleX);
    }
  }, { passive: false });

  canvas.addEventListener('touchend', () => { dragging = false; });

  draw();
  window.addEventListener('resize', draw);
})();
</script>

</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Obim trapeza opisanog oko kruga",
  "subject": "math",
  "unit": "geometry",
  "topic_tags": ["tangentni cetvorougao", "trapez", "srednja linija trapeza", "upisani krug", "obim"]
}
BRAINSPARK_META-->