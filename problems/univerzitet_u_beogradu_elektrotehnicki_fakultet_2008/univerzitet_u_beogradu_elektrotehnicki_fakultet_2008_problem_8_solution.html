<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jednacina sa ugnjezdenim apsolutnim vrednostima</title>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<script type="text/info" id="logic-scratchpad">
PROBLEM:
Zbir svih resenja jednacine ||x - 1| - 1| - 1 = 0 iznosi:
(A) -3  (B) 1  (C) 2  (D) -2  (E) 3
(N) Ne znam

SOLUTION:

1. Polazna jednacina:
   ||x - 1| - 1| - 1 = 0

2. Prebacimo 1 na desnu stranu:
   ||x - 1| - 1| = 1

3. Skinemo spoljasnju apsolutnu vrednost:
   |x - 1| - 1 = 1  ili  |x - 1| - 1 = -1

4. Slucaj 1: |x - 1| - 1 = 1
   |x - 1| = 2
   x - 1 = 2  =>  x = 3
   x - 1 = -2  =>  x = -1

5. Slucaj 2: |x - 1| - 1 = -1
   |x - 1| = 0
   x - 1 = 0  =>  x = 1

6. Resenja: x = -1, x = 1, x = 3

7. Zbir: -1 + 1 + 3 = 3

ANSWER: (E) 3

VERIFICATION:
- x = -1: ||-1-1|-1|-1 = ||{-2}|-1|-1 = |2-1|-1 = |1|-1 = 1-1 = 0 OK
- x = 1: ||1-1|-1|-1 = ||0|-1|-1 = |0-1|-1 = |-1|-1 = 1-1 = 0 OK
- x = 3: ||3-1|-1|-1 = ||2|-1|-1 = |2-1|-1 = |1|-1 = 1-1 = 0 OK
</script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  font-size: 2.2rem;
  font-weight: 800;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
  line-height: 1.3;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 32px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.4rem;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.card h3 {
  color: #a78bfa;
  font-size: 1.15rem;
  margin-bottom: 10px;
  margin-top: 16px;
}

.highlight {
  color: #f472b6;
  font-weight: 600;
}

.highlight-blue {
  color: #60a5fa;
  font-weight: 600;
}

.highlight-green {
  color: #4ade80;
  font-weight: 600;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 14px;
}

.given-item {
  background: rgba(96, 165, 250, 0.08);
  border: 1px solid rgba(96, 165, 250, 0.18);
  border-radius: 10px;
  padding: 12px 18px;
  min-width: 160px;
  flex: 1;
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-bottom: 4px;
}

.given-item .value {
  color: #60a5fa;
  font-size: 1.15rem;
  font-weight: 700;
}

.math-box {
  background: rgba(56, 189, 248, 0.08);
  border: 1px solid rgba(56, 189, 248, 0.15);
  border-radius: 10px;
  padding: 16px 20px;
  margin: 14px 0;
  overflow-x: auto;
}

.step-container {
  margin-bottom: 22px;
  padding-left: 16px;
  border-left: 3px solid #334155;
}

.step-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  border-radius: 50%;
  color: #fff;
  font-weight: 700;
  font-size: 0.9rem;
  margin-right: 10px;
  flex-shrink: 0;
}

.step-title {
  color: #e2e8f0;
  font-size: 1.1rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  margin-bottom: 10px;
}

.step-text {
  color: #cbd5e1;
  margin-bottom: 10px;
}

details {
  margin: 15px 0;
  background: rgba(167, 139, 250, 0.07);
  border: 1px solid rgba(167, 139, 250, 0.2);
  border-radius: 10px;
  padding: 12px 16px;
}

details summary {
  cursor: pointer;
  color: #a78bfa;
  font-weight: 600;
  user-select: none;
}

details[open] summary {
  margin-bottom: 10px;
}

details p, details ul {
  color: #cbd5e1;
}

.insight-box {
  background: linear-gradient(135deg, rgba(96,165,250,0.12), rgba(167,139,250,0.12));
  border: 1px solid rgba(167, 139, 250, 0.3);
  border-radius: 14px;
  padding: 20px 24px;
  margin-bottom: 24px;
}

.insight-box h2 {
  color: #a78bfa;
}

.answer-box {
  background: linear-gradient(135deg, rgba(52,211,153,0.1), rgba(74,222,128,0.1));
  border: 2px solid rgba(52, 211, 153, 0.4);
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  text-align: center;
}

.answer-box .final-answer {
  color: #4ade80;
  font-size: 1.6rem;
  font-weight: 800;
  margin: 12px 0;
}

.answer-box .answer-label {
  color: #34d399;
  font-size: 1rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 2px;
}

.options-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin: 16px 0;
  justify-content: center;
}

.option {
  background: rgba(51, 65, 85, 0.5);
  border: 1px solid #334155;
  border-radius: 10px;
  padding: 10px 18px;
  color: #94a3b8;
  font-size: 1rem;
  transition: all 0.2s;
}

.option.correct {
  background: rgba(52, 211, 153, 0.15);
  border-color: #34d399;
  color: #4ade80;
  font-weight: 700;
}

.pitfall-box {
  background: rgba(224, 148, 104, 0.07);
  border: 1px solid rgba(224, 148, 104, 0.25);
  border-radius: 14px;
  padding: 20px 24px;
  margin-bottom: 24px;
}

.pitfall-box h2 {
  color: #e09468;
}

.pitfall-box ul {
  list-style: none;
  padding-left: 0;
}

.pitfall-box li {
  color: #cbd5e1;
  margin-bottom: 8px;
  padding-left: 22px;
  position: relative;
}

.pitfall-box li::before {
  content: "\26A0";
  position: absolute;
  left: 0;
}

.canvas-card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 20px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
  display: flex;
  flex-direction: column;
  align-items: center;
}

.canvas-card h2 {
  align-self: flex-start;
}

.canvas-card p.canvas-hint {
  color: #94a3b8;
  font-size: 0.9rem;
  margin-top: 10px;
  text-align: center;
}

canvas {
  border-radius: 10px;
  touch-action: none;
  max-width: 100%;
  height: auto;
}

.challenge-box {
  background: rgba(96, 165, 250, 0.06);
  border: 1px solid rgba(96, 165, 250, 0.2);
  border-radius: 14px;
  padding: 20px 24px;
  margin-bottom: 24px;
}

.challenge-box h2 {
  color: #60a5fa;
}

.case-box {
  background: rgba(167, 139, 250, 0.06);
  border: 1px solid rgba(167, 139, 250, 0.15);
  border-radius: 10px;
  padding: 16px 20px;
  margin: 12px 0;
}

.case-box h4 {
  color: #a78bfa;
  font-size: 1rem;
  margin-bottom: 8px;
}

.tree-diagram {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  margin: 16px 0;
  padding: 16px;
  background: rgba(96, 165, 250, 0.05);
  border-radius: 10px;
}

.tree-level {
  display: flex;
  gap: 30px;
  justify-content: center;
  flex-wrap: wrap;
}

.tree-node {
  background: rgba(96, 165, 250, 0.12);
  border: 1px solid rgba(96, 165, 250, 0.25);
  border-radius: 8px;
  padding: 8px 16px;
  text-align: center;
  color: #e2e8f0;
  font-size: 0.95rem;
}

.tree-node.solution {
  background: rgba(52, 211, 153, 0.15);
  border-color: rgba(52, 211, 153, 0.4);
  color: #4ade80;
  font-weight: 700;
}

.tree-arrow {
  color: #64748b;
  font-size: 1.2rem;
  text-align: center;
}

@media (max-width: 700px) {
  h1 { font-size: 1.6rem; }
  .card { padding: 16px; }
  .given-grid { flex-direction: column; }
  .options-grid { flex-direction: column; align-items: stretch; }
  .option { text-align: center; }
  .tree-level { gap: 12px; }
}
</style>
</head>
<body>
<div class="container">

  <h1>Jednacina sa ugnjezdenim apsolutnim vrednostima</h1>
  <p class="subtitle">Apsolutna vrednost -- sistematicno raslonjavanje slojeva</p>

  <!-- Problem Statement -->
  <div class="card">
    <h2>Zadatak</h2>
    <p>Zbir svih resenja jednacine</p>
    <div class="math-box" style="text-align: center;">
      \[\big|\,|x - 1| - 1\big| - 1 = 0\]
    </div>
    <p>iznosi:</p>
    <div class="options-grid" style="justify-content: flex-start; margin-top: 12px;">
      <div class="option">(A) \(-3\)</div>
      <div class="option">(B) \(1\)</div>
      <div class="option">(C) \(2\)</div>
      <div class="option">(D) \(-2\)</div>
      <div class="option">(E) \(3\)</div>
    </div>

    <div class="given-grid">
      <div class="given-item">
        <div class="label">Tip jednacine</div>
        <div class="value">Ugnjezdena apsolutna vrednost</div>
      </div>
      <div class="given-item">
        <div class="label">Metoda</div>
        <div class="value">Sloj po sloj</div>
      </div>
      <div class="given-item">
        <div class="label">Trazi se</div>
        <div class="value">Zbir svih resenja</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card">
    <h2>Plan resavanja</h2>
    <p>Jednacina sadrzi <span class="highlight-blue">tri sloja apsolutne vrednosti</span>. Resavacemo je iznutra ka spolja -- skinucemo spoljasnji sloj apsolutne vrednosti, zatim srednji, pa unutrasnji. Na svakom koraku koristimo definiciju: \(|A| = B\) ima resenja \(A = B\) ili \(A = -B\) (pod uslovom da je \(B \geq 0\)).</p>
    <p style="margin-top: 10px;">Na kraju sabracemo sva dobijena resenja.</p>
  </div>

  <!-- Theory Refresher -->
  <details>
    <summary>Kljucne formule i pojmovi</summary>
    <ul style="list-style: disc; padding-left: 20px; margin-top: 10px;">
      <li style="margin-bottom: 8px;"><strong>Definicija apsolutne vrednosti:</strong> \(|a| = \begin{cases} a, & \text{ako } a \geq 0 \\ -a, & \text{ako } a < 0 \end{cases}\)</li>
      <li style="margin-bottom: 8px;"><strong>Osnovna jednacina:</strong> \(|A| = B\) ima resenja \(A = B\) ili \(A = -B\), ali samo ako je \(B \geq 0\). Ako je \(B < 0\), jednacina nema resenja.</li>
      <li style="margin-bottom: 8px;"><strong>Ugnjezdene apsolutne vrednosti:</strong> Kada imamo vise slojeva, skinemo ih jedan po jedan, pocevsi od spoljasnjeg. Svaki sloj moze da udvostruci broj slucajeva.</li>
      <li style="margin-bottom: 8px;"><strong>Graficka interpretacija:</strong> Funkcija \(f(x) = ||x-1|-1|-1\) se dobija uzastopnim transformacijama grafika -- svaka apsolutna vrednost "presavija" negativni deo grafika na gore.</li>
    </ul>
  </details>

  <!-- Canvas Visualization -->
  <div class="canvas-card">
    <h2>Grafik funkcije \(f(x) = \big|\,|x-1|-1\big|-1\)</h2>
    <canvas id="graphCanvas" width="800" height="480"></canvas>
    <p class="canvas-hint">Pomerajte kursor (ili dodirnite) da biste videli vrednost funkcije u bilo kojoj tacki. Resenja su tacke gde grafik sece x-osu.</p>
  </div>

  <!-- Step-by-step Solution -->
  <div class="card">
    <h2>Resenje korak po korak</h2>

    <!-- Step 1 -->
    <div class="step-container">
      <div class="step-title"><span class="step-badge">1</span>Preuredjivanje jednacine</div>
      <p class="step-text">Polazna jednacina je:</p>
      <div class="math-box" style="text-align: center;">
        \[\big|\,|x - 1| - 1\big| - 1 = 0\]
      </div>
      <p class="step-text">Prebacimo \(1\) na desnu stranu:</p>
      <div class="math-box" style="text-align: center; border-color: rgba(96,165,250,0.3); background: rgba(96,165,250,0.06);">
        \[\big|\,|x - 1| - 1\big| = 1\]
      </div>
      <p class="step-text">Sada imamo jednacinu oblika \(|A| = 1\), gde je \(A = |x-1| - 1\).</p>
    </div>

    <!-- Step 2 -->
    <div class="step-container">
      <div class="step-title"><span class="step-badge">2</span>Skidanje spoljasnje apsolutne vrednosti</div>
      <p class="step-text">Iz \(\big|\,|x-1| - 1\big| = 1\) sledi:</p>
      <div class="math-box">
        \[|x - 1| - 1 = 1 \quad \text{ili} \quad |x - 1| - 1 = -1\]
      </div>
      <p class="step-text">Sredimo oba slucaja:</p>

      <div class="case-box">
        <h4>Slucaj 1: \(|x - 1| - 1 = 1\)</h4>
        <div class="math-box">
          \[|x - 1| = 2\]
        </div>
      </div>

      <div class="case-box">
        <h4>Slucaj 2: \(|x - 1| - 1 = -1\)</h4>
        <div class="math-box">
          \[|x - 1| = 0\]
        </div>
      </div>

      <p class="step-text">Oba slucaja imaju smisla jer su desne strane nenegativne (\(2 \geq 0\) i \(0 \geq 0\)).</p>
    </div>

    <!-- Step 3 -->
    <div class="step-container">
      <div class="step-title"><span class="step-badge">3</span>Resavanje Slucaja 1: \(|x - 1| = 2\)</div>
      <p class="step-text">Skidamo poslednji sloj apsolutne vrednosti:</p>
      <div class="math-box">
        \[x - 1 = 2 \quad \Rightarrow \quad \boxed{x = 3}\]
        \[x - 1 = -2 \quad \Rightarrow \quad \boxed{x = -1}\]
      </div>
      <p class="step-text">Slucaj 1 daje <span class="highlight-green">dva resenja</span>: \(x = 3\) i \(x = -1\).</p>
    </div>

    <!-- Step 4 -->
    <div class="step-container">
      <div class="step-title"><span class="step-badge">4</span>Resavanje Slucaja 2: \(|x - 1| = 0\)</div>
      <p class="step-text">Apsolutna vrednost je nula samo kad je argument nula:</p>
      <div class="math-box">
        \[x - 1 = 0 \quad \Rightarrow \quad \boxed{x = 1}\]
      </div>
      <p class="step-text">Slucaj 2 daje <span class="highlight-green">jedno resenje</span>: \(x = 1\).</p>
    </div>

    <!-- Step 5 -->
    <div class="step-container">
      <div class="step-title"><span class="step-badge">5</span>Provera svih resenja</div>
      <p class="step-text">Proverimo da sva tri resenja zadovoljavaju polaznu jednacinu:</p>

      <div class="math-box">
        \[x = -1: \quad \big|\,|\underbrace{-1 - 1}_{-2}| - 1\big| - 1 = \big|\,2 - 1\big| - 1 = |1| - 1 = 1 - 1 = 0 \quad \color{#4ade80}{\checkmark}\]
      </div>
      <div class="math-box">
        \[x = 1: \quad \big|\,|\underbrace{1 - 1}_{0}| - 1\big| - 1 = \big|\,0 - 1\big| - 1 = |-1| - 1 = 1 - 1 = 0 \quad \color{#4ade80}{\checkmark}\]
      </div>
      <div class="math-box">
        \[x = 3: \quad \big|\,|\underbrace{3 - 1}_{2}| - 1\big| - 1 = \big|\,2 - 1\big| - 1 = |1| - 1 = 1 - 1 = 0 \quad \color{#4ade80}{\checkmark}\]
      </div>
      <p class="step-text">Sva tri resenja su <span class="highlight-green">tacna</span>.</p>
    </div>

    <!-- Step 6 -->
    <div class="step-container">
      <div class="step-title"><span class="step-badge">6</span>Racunanje zbira</div>
      <p class="step-text">Zbir svih resenja:</p>
      <div class="math-box" style="text-align: center; border-color: rgba(52,211,153,0.3); background: rgba(52,211,153,0.06);">
        \[(-1) + 1 + 3 = \boxed{3}\]
      </div>
    </div>
  </div>

  <!-- Key Insight -->
  <div class="insight-box">
    <h2>Kljucni uvid</h2>
    <p style="margin-top: 8px;">Ugnjezdene apsolutne vrednosti resavamo <span class="highlight-blue">sloj po sloj, od spolja ka unutra</span>. Na svakom nivou jednacina \(|A| = B\) se rasclanjuje na dva slucaja: \(A = B\) i \(A = -B\). Medjutim, kljucno je proveriti da li je \(B \geq 0\) -- ako nije, taj slucaj nema resenja. U nasem problemu, oba slucaja (\(B = 2\) i \(B = 0\)) su dali validna resenja.</p>
    <p style="margin-top: 10px;">Takodje, primetite <span class="highlight">simetriju resenja</span> u odnosu na tacku \(x = 1\): resenja \(x = -1\) i \(x = 3\) su simetricna oko \(x = 1\) (oba su na rastojanju 2 od te tacke), dok je \(x = 1\) centar simetrije. Ovo je posledica toga sto je cela jednacina formulisana preko \(|x - 1|\).</p>
  </div>

  <!-- Final Answer -->
  <div class="answer-box">
    <div class="answer-label">Konacan odgovor</div>
    <div class="final-answer">(E) \(3\)</div>
    <p style="color: #94a3b8; margin-bottom: 12px;">Resenja su \(x = -1\), \(x = 1\) i \(x = 3\), a njihov zbir je \((-1) + 1 + 3 = 3\).</p>
    <div class="options-grid">
      <div class="option">(A) \(-3\)</div>
      <div class="option">(B) \(1\)</div>
      <div class="option">(C) \(2\)</div>
      <div class="option">(D) \(-2\)</div>
      <div class="option correct">(E) \(3\)</div>
    </div>
  </div>

  <!-- Common Pitfalls -->
  <div class="pitfall-box">
    <h2>Ceste greske</h2>
    <ul>
      <li><strong>Zaboravljanje slucaja \(|x-1| = 0\):</strong> Kada se dobije \(|x-1|-1 = -1\), mnogi ucenici pomisle da nema resenja jer je desna strana negativna. Medjutim, nakon sredivanja dobijamo \(|x-1| = 0\), sto je sasvim validna jednacina sa resenjem \(x = 1\).</li>
      <li><strong>Pogresno skidanje apsolutne vrednosti:</strong> Neki ucenici odmah pokusavaju da "razviju" sve slojeve odjednom, sto cesto dovodi do propustanja nekih slucajeva. Uvek treba raditi sistematski, sloj po sloj.</li>
      <li><strong>Racunska greska u zbiru:</strong> Cak i kada se nadju sva resenja, greska u sabiranju (npr. zamena znaka za \(x = -1\)) moze dovesti do pogresnog odgovora. Uvek proverite sabiranje.</li>
      <li><strong>Dupliranje resenja:</strong> U slozenijim primerima, razliciti slucajevi mogu dati isto resenje. Vazno je da svako resenje brojimo samo jednom.</li>
    </ul>
  </div>

  <!-- Optional Challenge -->
  <div class="challenge-box">
    <h2>Dodatni izazov</h2>
    <p>Resi slicnu jednacinu sa jednim dodatnim slojem:</p>
    <div class="math-box" style="text-align: center;">
      \[\big|\,\big|\,|x - 1| - 1\big| - 1\big| = 2\]
    </div>
    <details>
      <summary>Prikazi nagovestaj</summary>
      <p style="margin-top: 8px;">Ovde treba skinuti jos jedan sloj apsolutne vrednosti. Jednacina \(|A| = 2\) daje \(A = 2\) ili \(A = -2\), gde je \(A = ||x-1|-1|-1\). Zatim resavas po istoj metodi kao u zadatku.</p>
    </details>
    <details>
      <summary>Prikazi resenje</summary>
      <p style="margin-top: 8px;">Iz \(\big|\,||x-1|-1|-1\big| = 2\) dobijamo:</p>
      <p>\(||x-1|-1|-1 = 2 \;\Rightarrow\; ||x-1|-1| = 3 \;\Rightarrow\; |x-1|-1 = 3 \text{ ili } |x-1|-1 = -3\)</p>
      <p>Iz \(|x-1| = 4\): \(x = 5\) ili \(x = -3\). Iz \(|x-1| = -2\): nema resenja.</p>
      <p>\(||x-1|-1|-1 = -2 \;\Rightarrow\; ||x-1|-1| = -1\): nema resenja (apsolutna vrednost ne moze biti negativna).</p>
      <p><strong>Resenja:</strong> \(x = -3\) i \(x = 5\). <strong>Zbir:</strong> \(-3 + 5 = 2\).</p>
    </details>
  </div>

</div>

<script>
(() => {
  const canvas = document.getElementById('graphCanvas');
  const ctx = canvas.getContext('2d');
  const W = canvas.width;
  const H = canvas.height;
  let mouseX = -1;
  let mouseY = -1;

  // Coordinate system
  const margin = { left: 60, right: 40, top: 50, bottom: 50 };
  const plotW = W - margin.left - margin.right;
  const plotH = H - margin.top - margin.bottom;

  const xMin = -3;
  const xMax = 5;
  const yMin = -1.5;
  const yMax = 3.5;

  function xToCanvas(x) {
    return margin.left + (x - xMin) / (xMax - xMin) * plotW;
  }

  function yToCanvas(y) {
    return margin.top + plotH - (y - yMin) / (yMax - yMin) * plotH;
  }

  function canvasToX(cx) {
    return xMin + (cx - margin.left) / plotW * (xMax - xMin);
  }

  function f(x) {
    return Math.abs(Math.abs(x - 1) - 1) - 1;
  }

  function drawAll() {
    // Background
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    // Title
    ctx.fillStyle = '#94a3b8';
    ctx.font = 'bold 15px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('f(x) = ||x \u2212 1| \u2212 1| \u2212 1', W / 2, 28);

    // Grid lines
    ctx.strokeStyle = '#1e293b';
    ctx.lineWidth = 1;
    for (let x = Math.ceil(xMin); x <= Math.floor(xMax); x++) {
      const cx = xToCanvas(x);
      ctx.beginPath();
      ctx.moveTo(cx, margin.top);
      ctx.lineTo(cx, H - margin.bottom);
      ctx.stroke();
    }
    for (let y = Math.ceil(yMin); y <= Math.floor(yMax); y++) {
      const cy = yToCanvas(y);
      ctx.beginPath();
      ctx.moveTo(margin.left, cy);
      ctx.lineTo(W - margin.right, cy);
      ctx.stroke();
    }

    // Axes
    ctx.strokeStyle = '#475569';
    ctx.lineWidth = 2;

    // X axis (y = 0)
    const y0 = yToCanvas(0);
    ctx.beginPath();
    ctx.moveTo(margin.left, y0);
    ctx.lineTo(W - margin.right, y0);
    ctx.stroke();

    // Y axis (x = 0)
    const x0 = xToCanvas(0);
    ctx.beginPath();
    ctx.moveTo(x0, margin.top);
    ctx.lineTo(x0, H - margin.bottom);
    ctx.stroke();

    // Axis arrows
    ctx.fillStyle = '#475569';
    // X arrow
    ctx.beginPath();
    ctx.moveTo(W - margin.right, y0);
    ctx.lineTo(W - margin.right - 8, y0 - 4);
    ctx.lineTo(W - margin.right - 8, y0 + 4);
    ctx.fill();
    // Y arrow
    ctx.beginPath();
    ctx.moveTo(x0, margin.top);
    ctx.lineTo(x0 - 4, margin.top + 8);
    ctx.lineTo(x0 + 4, margin.top + 8);
    ctx.fill();

    // Axis labels
    ctx.fillStyle = '#64748b';
    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('x', W - margin.right + 16, y0 + 5);
    ctx.textAlign = 'center';
    ctx.fillText('y', x0, margin.top - 10);

    // Tick marks and labels
    ctx.font = '12px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    for (let x = Math.ceil(xMin); x <= Math.floor(xMax); x++) {
      if (x === 0) continue;
      const cx = xToCanvas(x);
      ctx.strokeStyle = '#475569';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.moveTo(cx, y0 - 4);
      ctx.lineTo(cx, y0 + 4);
      ctx.stroke();
      ctx.fillStyle = '#94a3b8';
      ctx.fillText(x.toString(), cx, y0 + 20);
    }

    ctx.textAlign = 'right';
    for (let y = Math.ceil(yMin); y <= Math.floor(yMax); y++) {
      if (y === 0) continue;
      const cy = yToCanvas(y);
      ctx.strokeStyle = '#475569';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.moveTo(x0 - 4, cy);
      ctx.lineTo(x0 + 4, cy);
      ctx.stroke();
      ctx.fillStyle = '#94a3b8';
      ctx.fillText(y.toString(), x0 - 10, cy + 4);
    }

    // Origin label
    ctx.fillStyle = '#64748b';
    ctx.textAlign = 'right';
    ctx.fillText('0', x0 - 10, y0 + 18);

    // y = 0 line highlight (solution line)
    ctx.strokeStyle = 'rgba(52, 211, 153, 0.25)';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([6, 4]);
    ctx.beginPath();
    ctx.moveTo(margin.left, y0);
    ctx.lineTo(W - margin.right, y0);
    ctx.stroke();
    ctx.setLineDash([]);

    // Plot function f(x) = ||x-1|-1|-1
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 3;
    ctx.beginPath();
    let started = false;
    const step = 0.02;
    for (let x = xMin; x <= xMax; x += step) {
      const y = f(x);
      const cx = xToCanvas(x);
      const cy = yToCanvas(y);
      if (cy < margin.top - 5 || cy > H - margin.bottom + 5) {
        started = false;
        continue;
      }
      if (!started) {
        ctx.moveTo(cx, cy);
        started = true;
      } else {
        ctx.lineTo(cx, cy);
      }
    }
    ctx.stroke();

    // Mark the solutions (x-axis crossings)
    const solutions = [
      { x: -1, label: 'x = \u22121' },
      { x: 1, label: 'x = 1' },
      { x: 3, label: 'x = 3' }
    ];

    for (const sol of solutions) {
      const cx = xToCanvas(sol.x);
      const cy = yToCanvas(0);

      // Glow effect
      ctx.beginPath();
      ctx.arc(cx, cy, 12, 0, Math.PI * 2);
      ctx.fillStyle = 'rgba(52, 211, 153, 0.15)';
      ctx.fill();

      // Point
      ctx.beginPath();
      ctx.arc(cx, cy, 6, 0, Math.PI * 2);
      ctx.fillStyle = '#4ade80';
      ctx.fill();
      ctx.strokeStyle = '#fff';
      ctx.lineWidth = 2;
      ctx.stroke();

      // Label
      ctx.fillStyle = '#4ade80';
      ctx.font = 'bold 13px Segoe UI, system-ui, sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText(sol.label, cx, cy + 28);
    }

    // Mark the vertex points where the function reaches its minimum (-1)
    const minPoints = [
      { x: 0, y: f(0) },
      { x: 2, y: f(2) }
    ];

    for (const pt of minPoints) {
      const cx = xToCanvas(pt.x);
      const cy = yToCanvas(pt.y);
      ctx.beginPath();
      ctx.arc(cx, cy, 4, 0, Math.PI * 2);
      ctx.fillStyle = '#f472b6';
      ctx.fill();
    }

    // Mark the peak point at x=1, f(1) = 0 already marked as solution

    // Label for function
    ctx.fillStyle = 'rgba(96, 165, 250, 0.9)';
    ctx.font = 'italic 13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    const labelX = xToCanvas(3.3);
    const labelY = yToCanvas(f(3.3)) - 14;
    ctx.fillText('f(x) = ||x\u22121|\u22121|\u22121', labelX, labelY);

    // Legend
    ctx.font = '11px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    const legY = H - 14;

    ctx.fillStyle = '#4ade80';
    ctx.beginPath();
    ctx.arc(30, legY - 3, 5, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = '#cbd5e1';
    ctx.fillText('Resenja jednacine f(x) = 0', 42, legY);

    ctx.fillStyle = '#f472b6';
    ctx.beginPath();
    ctx.arc(280, legY - 3, 4, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = '#cbd5e1';
    ctx.fillText('Lokalni minimumi (f = \u22121)', 290, legY);

    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.moveTo(510, legY - 3);
    ctx.lineTo(530, legY - 3);
    ctx.stroke();
    ctx.fillStyle = '#cbd5e1';
    ctx.fillText('Grafik funkcije', 536, legY);

    // Interactive hover
    if (mouseX >= margin.left && mouseX <= W - margin.right) {
      const xVal = canvasToX(mouseX);
      const yVal = f(xVal);
      const cx = mouseX;
      const cy = yToCanvas(yVal);

      // Vertical dashed line
      ctx.strokeStyle = 'rgba(226, 232, 240, 0.25)';
      ctx.lineWidth = 1;
      ctx.setLineDash([4, 4]);
      ctx.beginPath();
      ctx.moveTo(cx, margin.top);
      ctx.lineTo(cx, H - margin.bottom);
      ctx.stroke();
      ctx.setLineDash([]);

      // Horizontal dashed line to y-axis
      if (cy >= margin.top && cy <= H - margin.bottom) {
        ctx.strokeStyle = 'rgba(226, 232, 240, 0.15)';
        ctx.lineWidth = 1;
        ctx.setLineDash([4, 4]);
        ctx.beginPath();
        ctx.moveTo(margin.left, cy);
        ctx.lineTo(cx, cy);
        ctx.stroke();
        ctx.setLineDash([]);

        // Point on curve
        ctx.beginPath();
        ctx.arc(cx, cy, 5, 0, Math.PI * 2);
        const isZero = Math.abs(yVal) < 0.05;
        ctx.fillStyle = isZero ? '#4ade80' : '#e2e8f0';
        ctx.fill();
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 1.5;
        ctx.stroke();
      }

      // Info box
      const xStr = xVal.toFixed(2).replace('.', ',');
      const yStr = yVal.toFixed(2).replace('.', ',');
      let info = 'x = ' + xStr + '  |  f(x) = ' + yStr;
      if (Math.abs(yVal) < 0.05) {
        info += '  (resenje!)';
      }

      ctx.font = '12px Segoe UI, system-ui, sans-serif';
      const infoW = ctx.measureText(info).width + 24;
      let infoX = cx - infoW / 2;
      if (infoX < 5) infoX = 5;
      if (infoX + infoW > W - 5) infoX = W - 5 - infoW;
      const infoY = margin.top - 2;

      ctx.fillStyle = 'rgba(30, 41, 59, 0.92)';
      ctx.strokeStyle = '#475569';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.roundRect(infoX, infoY - 22, infoW, 26, 6);
      ctx.fill();
      ctx.stroke();

      ctx.fillStyle = Math.abs(yVal) < 0.05 ? '#4ade80' : '#e2e8f0';
      ctx.textAlign = 'center';
      ctx.fillText(info, infoX + infoW / 2, infoY - 4);
    }
  }

  function handlePointer(e) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width;
    mouseX = (e.clientX - rect.left) * scaleX;
    mouseY = (e.clientY - rect.top) * (canvas.height / rect.height);
    drawAll();
  }

  canvas.addEventListener('mousemove', handlePointer);
  canvas.addEventListener('touchmove', (e) => {
    e.preventDefault();
    if (e.touches.length > 0) {
      handlePointer(e.touches[0]);
    }
  }, { passive: false });

  canvas.addEventListener('mouseleave', () => {
    mouseX = -1;
    mouseY = -1;
    drawAll();
  });

  drawAll();
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Jednacina sa ugnjezdenim apsolutnim vrednostima",
  "subject": "math",
  "unit": "algebra",
  "topic_tags": ["apsolutna vrednost", "ugnjezdene apsolutne vrednosti", "jednacine", "zbir resenja", "grafik funkcije"]
}
BRAINSPARK_META-->