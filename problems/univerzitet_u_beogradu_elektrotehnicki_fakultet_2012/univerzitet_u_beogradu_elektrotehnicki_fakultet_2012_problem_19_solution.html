<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RasporeÄ‘ivanje uÄenika u red</title>

<script type="text/info" id="logic-scratchpad">
PROBLEM:
Na koliko naÄina se u red mogu poredati 5 uÄenika i 2 uÄenice, tako da uÄenice ne stoje jedna pored druge?

(A) 240    (B) 3600    (C) 7680    (D) 2400    (E) 250

SOLUTION:

Strategy: Use the "gaps method" (also known as the insertion method).
- First, arrange the 5 boys in a row. There are 5! = 120 ways.
- Once the boys are placed, they create 6 gaps (including the two ends):
  _ B _ B _ B _ B _ B _
  Gap positions: before first boy, between boy 1 and 2, between 2 and 3,
                 between 3 and 4, between 4 and 5, after last boy = 6 gaps.
- We need to choose 2 of these 6 gaps for the 2 girls (so they are not adjacent).
  C(6,2) = 6! / (2! * 4!) = 15 ways.
- The 2 girls can be arranged in 2! = 2 ways in their chosen positions.

Total = 5! * C(6,2) * 2! = 120 * 15 * 2 = 3600

Answer: (B) 3600

VERIFICATION:
Alternative approach: Total arrangements of 7 people = 7! = 5040.
Arrangements where the 2 girls ARE adjacent:
- Treat 2 girls as a single block â†’ 6 objects to arrange â†’ 6! = 720 ways.
- The 2 girls within the block can swap â†’ 2! = 2 ways.
- Total with girls adjacent = 720 * 2 = 1440.
- Arrangements with girls NOT adjacent = 5040 - 1440 = 3600. Confirmed!

Answer: (B) 3600.
</script>

<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  font-size: 2.2rem;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
  line-height: 1.3;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 30px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.4rem;
  margin-bottom: 16px;
}

.highlight {
  color: #f472b6;
  font-weight: 600;
}

.math-box {
  background: rgba(56,189,248,0.08);
  border: 1px solid rgba(56,189,248,0.15);
  border-radius: 8px;
  padding: 14px 18px;
  margin: 12px 0;
  font-family: 'Courier New', monospace;
  overflow-x: auto;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.given-item {
  background: rgba(96,165,250,0.08);
  border: 1px solid rgba(96,165,250,0.18);
  border-radius: 10px;
  padding: 12px 18px;
  min-width: 80px;
  text-align: center;
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-bottom: 4px;
}

.given-item .value {
  color: #e2e8f0;
  font-size: 1.1rem;
  font-weight: 600;
}

.answer-option {
  cursor: default;
  transition: border-color 0.2s;
}

.plan-card {
  border-left: 3px solid #a78bfa;
}

details {
  margin: 15px 0;
}

details summary {
  cursor: pointer;
  color: #60a5fa;
  font-weight: 600;
  padding: 10px 0;
  user-select: none;
}

details summary:hover {
  color: #93bbfc;
}

details[open] summary {
  margin-bottom: 10px;
}

.theory-content ul {
  list-style: none;
  padding-left: 0;
}

.theory-content li {
  padding: 8px 0;
  border-bottom: 1px solid rgba(51,65,85,0.5);
  color: #cbd5e1;
}

.theory-content li:last-child {
  border-bottom: none;
}

.canvas-card {
  text-align: center;
}

canvas {
  border-radius: 10px;
  width: 100%;
  max-width: 750px;
  touch-action: none;
}

.drag-hint {
  color: #64748b;
  font-size: 0.85rem;
  margin-top: 8px;
}

.step-container {
  margin-bottom: 18px;
  padding: 18px;
  padding-left: 24px;
  background: rgba(30,41,59,0.5);
  border-left: 3px solid #334155;
  border-radius: 0 10px 10px 0;
  cursor: pointer;
  transition: border-color 0.25s, background 0.25s;
}

.step-container:hover,
.step-container.active {
  border-left-color: #4ade80;
  background: rgba(30,41,59,0.9);
}

.step-badge {
  display: inline-block;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  color: #0f172a;
  font-weight: 700;
  font-size: 0.8rem;
  padding: 3px 10px;
  border-radius: 20px;
  margin-bottom: 8px;
}

.step-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: #e2e8f0;
  margin-bottom: 8px;
}

.step-text {
  color: #cbd5e1;
  font-size: 0.97rem;
}

.checkpoint {
  background: rgba(167,139,250,0.08);
  border: 1px solid rgba(167,139,250,0.2);
  border-radius: 8px;
  padding: 12px 16px;
  margin: 15px 0;
}

.checkpoint summary {
  color: #a78bfa;
}

.insight-box {
  background: linear-gradient(135deg, rgba(96,165,250,0.12), rgba(167,139,250,0.12));
  border: 1px solid rgba(167,139,250,0.25);
  border-radius: 14px;
  padding: 22px;
  margin-bottom: 24px;
}

.insight-box h3 {
  color: #a78bfa;
  margin-bottom: 10px;
}

.final-answer {
  text-align: center;
  padding: 30px;
  border: 2px solid rgba(74,222,128,0.3);
  background: rgba(74,222,128,0.06);
}

.final-answer .answer-value {
  font-size: 2rem;
  font-weight: 700;
  color: #4ade80;
  margin: 16px 0;
}

.final-answer .answer-label {
  color: #94a3b8;
  font-size: 0.95rem;
}

.options-row {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 12px;
  margin: 20px 0;
}

.option-box {
  padding: 12px 22px;
  border-radius: 10px;
  border: 2px solid #334155;
  background: rgba(30,41,59,0.6);
  color: #94a3b8;
  font-size: 1.05rem;
  font-weight: 600;
  transition: all 0.3s;
}

.option-box.correct {
  border-color: #4ade80;
  background: rgba(74,222,128,0.12);
  color: #4ade80;
}

.pitfall-list {
  list-style: none;
  padding: 0;
}

.pitfall-list li {
  padding: 10px 0;
  padding-left: 16px;
  position: relative;
  color: #cbd5e1;
}

.pitfall-list li::before {
  content: '\26A0';
  position: absolute;
  left: 0;
}

.challenge-box {
  border-left: 3px solid #f472b6;
}

.verification-note {
  color: #94a3b8;
  font-size: 0.9rem;
  margin-top: 10px;
}

.toggle-container {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin: 14px 0 8px 0;
  flex-wrap: wrap;
}

.toggle-btn {
  padding: 8px 18px;
  border-radius: 8px;
  border: 1px solid #334155;
  background: rgba(30,41,59,0.7);
  color: #94a3b8;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.25s;
}

.toggle-btn:hover {
  border-color: #60a5fa;
  color: #e2e8f0;
}

.toggle-btn.active {
  border-color: #60a5fa;
  background: rgba(96,165,250,0.15);
  color: #60a5fa;
}

@media (max-width: 700px) {
  h1 { font-size: 1.5rem; }
  .container { padding: 10px; }
  .card { padding: 16px; }
  .given-grid { flex-direction: column; }
  .options-row { flex-direction: column; align-items: center; }
  .toggle-container { flex-direction: column; align-items: center; }
}
</style>
</head>
<body>
<div class="container">

  <h1>RasporeÄ‘ivanje u red bez susednih uÄenica</h1>
  <p class="subtitle">Kombinatorika - permutacije sa ograniÄenjima, metoda praznina</p>

  <!-- PROBLEM STATEMENT -->
  <div class="card problem-statement">
    <h2>Zadatak</h2>
    <p>Na koliko naÄina se u red mogu poredati <span class="highlight">5 uÄenika</span> i <span class="highlight">2 uÄenice</span>, tako da uÄenice <span class="highlight">ne stoje jedna pored druge</span>?</p>
    <div class="given-grid">
      <div class="given-item">
        <div class="label">UÄenici</div>
        <div class="value">\(5\)</div>
      </div>
      <div class="given-item">
        <div class="label">UÄenice</div>
        <div class="value">\(2\)</div>
      </div>
      <div class="given-item">
        <div class="label">Uslov</div>
        <div class="value" style="font-size:0.9rem;">UÄenice razdvojene</div>
      </div>
    </div>
    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\(240\)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\(3600\)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\(7680\)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\(2400\)</div>
      </div>
      <div class="given-item answer-option" data-option="E">
        <div class="label">(E)</div>
        <div class="value">\(250\)</div>
      </div>
    </div>
  </div>

  <!-- PLAN -->
  <div class="card plan-card">
    <h2>Plan reÅ¡avanja</h2>
    <p>KoristiÄ‡emo <strong>metodu praznina</strong> (metodu umetanja): prvo rasporedimo 5 uÄenika, Äime nastaje 6 praznina (mesta) izmeÄ‘u i oko njih, a zatim od tih 6 praznina biramo 2 za uÄenice. Ovim pristupom automatski garantujemo da uÄenice neÄ‡e biti susedne.</p>
  </div>

  <!-- THEORY -->
  <div class="card">
    <details>
      <summary>ğŸ“ KljuÄne formule i teoreme</summary>
      <div class="theory-content">
        <ul>
          <li><strong>Faktorijel (permutacije):</strong> Broj naÄina da se \(n\) razliÄitih objekata poreÄ‘a u red je \(n! = n \cdot (n-1) \cdot (n-2) \cdots 2 \cdot 1\)</li>
          <li><strong>Binomni koeficijent:</strong> Broj naÄina da se izabere \(k\) elemenata iz skupa od \(n\) elemenata je \(\displaystyle \binom{n}{k} = \frac{n!}{k!(n-k)!}\)</li>
          <li><strong>Metoda praznina:</strong> Kada rasporedimo \(m\) objekata u red, nastaje \(m+1\) praznina (ukljuÄujuÄ‡i krajeve). Umetanjem drugih objekata u razliÄite praznine obezbeÄ‘ujemo da oni nisu susedni.</li>
          <li><strong>Princip mnoÅ¾enja:</strong> Ako se jedan posao moÅ¾e izvrÅ¡iti na \(a\) naÄina, a drugi nezavisno na \(b\) naÄina, tada se oba posla mogu izvrÅ¡iti na \(a \cdot b\) naÄina.</li>
        </ul>
      </div>
    </details>
  </div>

  <!-- VISUAL AID -->
  <div class="card canvas-card">
    <h2>Vizuelni prikaz</h2>
    <p style="color:#94a3b8; margin-bottom:10px;">Dijagram prikazuje kako 5 uÄenika u redu stvara 6 praznina za umetanje uÄenica. Koristite dugmad za prikaz razliÄitih faza.</p>
    <canvas id="diagram" width="750" height="420"></canvas>
    <div class="toggle-container">
      <button class="toggle-btn active" id="btn-step1">Korak 1: UÄenici</button>
      <button class="toggle-btn" id="btn-step2">Korak 2: Praznine</button>
      <button class="toggle-btn" id="btn-step3">Korak 3: Umetanje</button>
    </div>
    <p class="drag-hint">Kliknite na dugmad za prikaz koraka</p>
  </div>

  <!-- STEP-BY-STEP -->
  <div class="card">
    <h2>ReÅ¡enje korak po korak</h2>

    <!-- Step 1 -->
    <div class="step-container" id="step1">
      <span class="step-badge">Korak 1</span>
      <div class="step-title">Rasporedimo 5 uÄenika u red</div>
      <div class="step-text">
        <p>Prvo, 5 uÄenika (oznaÄimo ih U1, U2, U3, U4, U5) rasporeÄ‘ujemo u red. Svaki raspored je jedna permutacija od 5 elemenata:</p>
        <div class="math-box">
          \[ 5! = 5 \cdot 4 \cdot 3 \cdot 2 \cdot 1 = 120 \text{ naÄina} \]
        </div>
      </div>
    </div>

    <!-- Step 2 -->
    <div class="step-container" id="step2">
      <span class="step-badge">Korak 2</span>
      <div class="step-title">UoÄimo praznine koje nastaju</div>
      <div class="step-text">
        <p>Kada su uÄenici postavljeni u red, nastaje <span class="highlight">6 praznina</span> - mesta gde moÅ¾emo umetnuti uÄenice:</p>
        <div class="math-box" style="text-align:center; font-size:1.05rem; letter-spacing:1px;">
          \[ \underset{1}{\_} \;\; \text{U} \;\; \underset{2}{\_} \;\; \text{U} \;\; \underset{3}{\_} \;\; \text{U} \;\; \underset{4}{\_} \;\; \text{U} \;\; \underset{5}{\_} \;\; \text{U} \;\; \underset{6}{\_} \]
        </div>
        <p>UoÄite: 5 uÄenika u redu stvara \(5 + 1 = 6\) praznina (jedna pre prvog, po jedna izmeÄ‘u svaka dva susedna, i jedna posle poslednjeg uÄenika).</p>
      </div>
    </div>

    <!-- Checkpoint 1 -->
    <details class="checkpoint">
      <summary>ğŸ§  Proveri se: ZaÅ¡to umetanje u razliÄite praznine garantuje da uÄenice neÄ‡e biti susedne?</summary>
      <p style="padding-top:8px; color:#cbd5e1;">
        Zato Å¡to je izmeÄ‘u svake dve praznine bar jedan uÄenik. Ako uÄenice stavimo u dve razliÄite praznine, izmeÄ‘u njih Ä‡e uvek stajati bar jedan uÄenik - Äime je uslov zadovoljen.
      </p>
    </details>

    <!-- Step 3 -->
    <div class="step-container" id="step3">
      <span class="step-badge">Korak 3</span>
      <div class="step-title">Izaberemo 2 od 6 praznina za uÄenice</div>
      <div class="step-text">
        <p>Od 6 raspoloÅ¾ivih praznina, biramo 2 (za svaku uÄenicu po jednu). Broj naÄina:</p>
        <div class="math-box">
          \[ \binom{6}{2} = \frac{6!}{2! \cdot 4!} = \frac{6 \cdot 5}{2 \cdot 1} = 15 \text{ naÄina} \]
        </div>
      </div>
    </div>

    <!-- Step 4 -->
    <div class="step-container" id="step4">
      <span class="step-badge">Korak 4</span>
      <div class="step-title">Rasporedimo 2 uÄenice na izabrana mesta</div>
      <div class="step-text">
        <p>Dve uÄenice su razliÄite osobe, pa ih moÅ¾emo rasporediti na 2 izabrana mesta na:</p>
        <div class="math-box">
          \[ 2! = 2 \text{ naÄina} \]
        </div>
        <p>Na primer, ako su izabrane praznine 1 i 4, uÄenica A moÅ¾e biti na mestu 1 a uÄenica B na mestu 4, ili obrnuto.</p>
      </div>
    </div>

    <!-- Checkpoint 2 -->
    <details class="checkpoint">
      <summary>ğŸ§  Proveri se: Koliko iznosi \(\binom{6}{2}\)?</summary>
      <p style="padding-top:8px; color:#cbd5e1;">
        \(\binom{6}{2} = \frac{6 \cdot 5}{2} = 15\). MoÅ¾emo i direktno nabrojati: parovi praznina su (1,2), (1,3), (1,4), (1,5), (1,6), (2,3), (2,4), (2,5), (2,6), (3,4), (3,5), (3,6), (4,5), (4,6), (5,6) - ukupno 15 parova.
      </p>
    </details>

    <!-- Step 5 -->
    <div class="step-container" id="step5">
      <span class="step-badge">Korak 5</span>
      <div class="step-title">Primenimo princip mnoÅ¾enja</div>
      <div class="step-text">
        <p>Sva tri koraka su nezavisna, pa ukupan broj naÄina raÄunamo mnoÅ¾enjem:</p>
        <div class="math-box">
          \[ \text{Ukupno} = \underbrace{5!}_{\text{uÄenici}} \times \underbrace{\binom{6}{2}}_{\text{izbor praznina}} \times \underbrace{2!}_{\text{uÄenice}} = 120 \times 15 \times 2 = 3600 \]
        </div>
      </div>
    </div>

    <!-- Step 6 -->
    <div class="step-container" id="step6">
      <span class="step-badge">Korak 6</span>
      <div class="step-title">Verifikacija komplementarnim pristupom</div>
      <div class="step-text">
        <p>Proverimo rezultat alternativno: izbrojimo sve rasporede, pa oduzmemo one gde su uÄenice susedne.</p>
        <p><strong>Ukupno rasporeda</strong> 7 osoba u redu:</p>
        <div class="math-box">
          \[ 7! = 5040 \]
        </div>
        <p><strong>Rasporedi gde su uÄenice susedne:</strong> Tretiramo dve uÄenice kao jedan blok. Tada imamo 6 objekata (5 uÄenika + 1 blok):</p>
        <div class="math-box">
          \[ 6! \times 2! = 720 \times 2 = 1440 \]
        </div>
        <p>(MnoÅ¾imo sa \(2!\) jer uÄenice unutar bloka mogu da zamene mesta.)</p>
        <p><strong>Rasporedi gde uÄenice NISU susedne:</strong></p>
        <div class="math-box">
          \[ 5040 - 1440 = 3600 \]
        </div>
        <p>Rezultat se poklapa. Odgovor je potvrÄ‘en!</p>
      </div>
    </div>

    <!-- Checkpoint 3 -->
    <details class="checkpoint">
      <summary>ğŸ§  Proveri se: ZaÅ¡to mnoÅ¾imo sa \(2!\) kada uÄenice tretiramo kao blok?</summary>
      <p style="padding-top:8px; color:#cbd5e1;">
        Zato Å¡to unutar bloka uÄenice mogu da zamene mesta: [uÄenica A, uÄenica B] ili [uÄenica B, uÄenica A]. To su dva razliÄita rasporeda, pa mnoÅ¾imo sa \(2! = 2\).
      </p>
    </details>
  </div>

  <!-- KEY INSIGHT -->
  <div class="insight-box">
    <h3>KljuÄni uvid</h3>
    <p>Metoda praznina je elegantna tehnika za probleme gde se traÅ¾i da odreÄ‘eni objekti <em>ne budu susedni</em>. Umesto komplikovanog uslova razdvajanja, jednostavno prvo rasporedimo ostale objekte, a zatim â€problematiÄne" umetnemo u praznine. Formula za ovaj tip zadatka:</p>
    <div class="math-box" style="text-align:center; font-size:1.15rem;">
      \[ \underbrace{m!}_{\text{ostali}} \times \underbrace{\binom{m+1}{k}}_{\text{izbor praznina}} \times \underbrace{k!}_{\text{razdvojeni}} \]
    </div>
    <p style="margin-top:8px;">gde je \(m\) broj objekata bez ograniÄenja, a \(k\) broj objekata koji ne smeju biti susedni.</p>
  </div>

  <!-- FINAL ANSWER -->
  <div class="card final-answer">
    <h2>KonaÄan odgovor</h2>
    <p class="answer-label">Ukupan broj naÄina rasporeÄ‘ivanja je:</p>
    <div class="answer-value">(B) 3600</div>
    <div class="options-row">
      <div class="option-box">(A) 240</div>
      <div class="option-box correct">(B) 3600</div>
      <div class="option-box">(C) 7680</div>
      <div class="option-box">(D) 2400</div>
      <div class="option-box">(E) 250</div>
    </div>
    <p class="verification-note">Provera: Metoda praznina daje \(120 \times 15 \times 2 = 3600\). Komplementarni pristup daje \(7! - 6! \times 2! = 5040 - 1440 = 3600\). Oba pristupa potvrÄ‘uju isti rezultat.</p>
  </div>

  <!-- PITFALLS -->
  <div class="card">
    <h2>ÄŒeste greÅ¡ke</h2>
    <ul class="pitfall-list">
      <li>Zaboraviti da se uÄenice na izabranim mestima mogu rasporediti na \(2!\) naÄina. Bez toga, dobili bismo \(120 \times 15 = 1800\), Å¡to je duplo manje od taÄnog odgovora.</li>
      <li>PogreÅ¡no raÄunanje broja praznina: 5 uÄenika stvara 6 praznina (ne 5!). Praznina ima uvek za 1 viÅ¡e od broja rasporeÄ‘enih objekata, jer ukljuÄujemo i oba kraja reda.</li>
      <li>MeÅ¡anje sa problemom gde uÄenice ne smeju biti na krajevima. Ovde je jedini uslov da uÄenice ne budu jedna pored druge, ali mogu biti na krajevima reda.</li>
    </ul>
  </div>

  <!-- CHALLENGE -->
  <div class="card challenge-box">
    <h2>Dodatni izazov</h2>
    <p>Na koliko naÄina se u red moÅ¾e poredati 6 uÄenika i 3 uÄenice tako da nikoje dve uÄenice ne stoje jedna pored druge?</p>
    <details>
      <summary>PomoÄ‡</summary>
      <p style="padding-top:8px; color:#cbd5e1;">
        Isti pristup: rasporedimo 6 uÄenika (\(6!\) naÄina), nastaje 7 praznina, biramo 3 od 7 praznina za uÄenice (\(\binom{7}{3}\) naÄina), i uÄenice rasporedimo (\(3!\) naÄina). Ukupno: \(6! \times \binom{7}{3} \times 3! = 720 \times 35 \times 6 = 151200\) naÄina.
      </p>
    </details>
  </div>

</div>

<script>
(() => {
  // Step click highlighting
  const steps = document.querySelectorAll('.step-container');
  steps.forEach(step => {
    step.addEventListener('click', () => {
      steps.forEach(s => s.classList.remove('active'));
      step.classList.toggle('active');
    });
  });

  // Canvas diagram
  const canvas = document.getElementById('diagram');
  const ctx = canvas.getContext('2d');
  const W = canvas.width;
  const H = canvas.height;

  // State
  let phase = 1; // 1 = boys only, 2 = boys + gaps, 3 = boys + girls inserted

  // Colors
  const bgColor = '#0c1222';
  const boyColor = '#60a5fa';
  const girlColor = '#f472b6';
  const gapColor = '#4ade80';
  const mutedColor = '#64748b';
  const textColor = '#e2e8f0';

  // Positions
  const boyRadius = 24;
  const spacing = 100;
  const startX = (W - (4 * spacing)) / 2;
  const boyY = H / 2 - 20;

  // Boys positions
  const boys = [];
  for (let i = 0; i < 5; i++) {
    boys.push({ x: startX + i * spacing, y: boyY, label: 'U' + (i + 1) });
  }

  // Gap positions (6 gaps: before first, between each pair, after last)
  const gaps = [];
  const gapY = boyY + 75;
  for (let i = 0; i <= 5; i++) {
    let gx;
    if (i === 0) {
      gx = boys[0].x - spacing / 2;
    } else if (i === 5) {
      gx = boys[4].x + spacing / 2;
    } else {
      gx = (boys[i - 1].x + boys[i].x) / 2;
    }
    gaps.push({ x: gx, y: gapY, label: String(i + 1) });
  }

  // Selected gaps for insertion demo (gap 2 and gap 5, 0-indexed: 1 and 4)
  const selectedGaps = [1, 4];
  const girlLabels = ['UÄ1', 'UÄ2'];

  function drawRoundedRect(x, y, w, h, r) {
    ctx.beginPath();
    ctx.moveTo(x + r, y);
    ctx.lineTo(x + w - r, y);
    ctx.arcTo(x + w, y, x + w, y + r, r);
    ctx.lineTo(x + w, y + h - r);
    ctx.arcTo(x + w, y + h, x + w - r, y + h, r);
    ctx.lineTo(x + r, y + h);
    ctx.arcTo(x, y + h, x, y + h - r, r);
    ctx.lineTo(x, y + r);
    ctx.arcTo(x, y, x + r, y, r);
    ctx.closePath();
  }

  function drawBoy(x, y, label, dimmed) {
    // Circle
    ctx.beginPath();
    ctx.arc(x, y, boyRadius, 0, 2 * Math.PI);
    if (dimmed) {
      ctx.fillStyle = 'rgba(96,165,250,0.25)';
      ctx.strokeStyle = 'rgba(96,165,250,0.35)';
    } else {
      ctx.fillStyle = 'rgba(96,165,250,0.2)';
      ctx.strokeStyle = boyColor;
    }
    ctx.lineWidth = 2.5;
    ctx.fill();
    ctx.stroke();

    // Label
    ctx.fillStyle = dimmed ? 'rgba(96,165,250,0.5)' : boyColor;
    ctx.font = 'bold 14px Segoe UI, sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(label, x, y);
  }

  function drawGap(x, y, label, highlighted) {
    const r = 16;
    ctx.beginPath();
    ctx.arc(x, y, r, 0, 2 * Math.PI);
    if (highlighted) {
      ctx.fillStyle = 'rgba(74,222,128,0.3)';
      ctx.strokeStyle = gapColor;
      ctx.lineWidth = 2.5;
      // Glow
      ctx.shadowColor = gapColor;
      ctx.shadowBlur = 10;
    } else {
      ctx.fillStyle = 'rgba(74,222,128,0.1)';
      ctx.strokeStyle = 'rgba(74,222,128,0.4)';
      ctx.lineWidth = 1.5;
      ctx.setLineDash([4, 4]);
    }
    ctx.fill();
    ctx.stroke();
    ctx.shadowBlur = 0;
    ctx.setLineDash([]);

    // Label
    ctx.fillStyle = highlighted ? gapColor : 'rgba(74,222,128,0.7)';
    ctx.font = (highlighted ? 'bold ' : '') + '13px Segoe UI, sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(label, x, y);
  }

  function drawGirl(x, y, label) {
    // Circle
    ctx.beginPath();
    ctx.arc(x, y, boyRadius, 0, 2 * Math.PI);
    ctx.fillStyle = 'rgba(244,114,182,0.2)';
    ctx.strokeStyle = girlColor;
    ctx.lineWidth = 2.5;
    ctx.shadowColor = girlColor;
    ctx.shadowBlur = 12;
    ctx.fill();
    ctx.stroke();
    ctx.shadowBlur = 0;

    // Label
    ctx.fillStyle = girlColor;
    ctx.font = 'bold 13px Segoe UI, sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(label, x, y);
  }

  function drawArrow(fromX, fromY, toX, toY, color) {
    ctx.strokeStyle = color;
    ctx.lineWidth = 1.5;
    ctx.setLineDash([4, 4]);
    ctx.beginPath();
    ctx.moveTo(fromX, fromY);
    ctx.lineTo(toX, toY);
    ctx.stroke();
    ctx.setLineDash([]);

    // Arrowhead
    const angle = Math.atan2(toY - fromY, toX - fromX);
    const headLen = 8;
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.moveTo(toX, toY);
    ctx.lineTo(toX - headLen * Math.cos(angle - 0.4), toY - headLen * Math.sin(angle - 0.4));
    ctx.lineTo(toX - headLen * Math.cos(angle + 0.4), toY - headLen * Math.sin(angle + 0.4));
    ctx.closePath();
    ctx.fill();
  }

  function draw() {
    // Background
    ctx.fillStyle = bgColor;
    ctx.fillRect(0, 0, W, H);

    // Title text
    ctx.fillStyle = '#94a3b8';
    ctx.font = '14px Segoe UI, sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';

    if (phase === 1) {
      ctx.fillText('Korak 1: Rasporedimo 5 uÄenika u red (5! = 120 naÄina)', W / 2, 15);
    } else if (phase === 2) {
      ctx.fillText('Korak 2: Nastaje 6 praznina za umetanje uÄenica', W / 2, 15);
    } else {
      ctx.fillText('Korak 3: Umetanje uÄenica u izabrane praznine (primer: praznine 2 i 5)', W / 2, 15);
    }

    // Draw connecting line between boys
    ctx.strokeStyle = 'rgba(96,165,250,0.15)';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(boys[0].x, boyY);
    ctx.lineTo(boys[4].x, boyY);
    ctx.stroke();

    // Draw boys
    const dimBoys = (phase === 3);
    for (let i = 0; i < 5; i++) {
      drawBoy(boys[i].x, boys[i].y, boys[i].label, false);
    }

    // Draw gaps (phase 2 and 3)
    if (phase >= 2) {
      // Draw dashed lines from gap area to boy line to show positions
      for (let i = 0; i <= 5; i++) {
        const highlighted = (phase === 3 && selectedGaps.includes(i));
        if (phase === 2) {
          // Draw all gaps evenly
          drawGap(gaps[i].x, gaps[i].y, gaps[i].label, false);
          // Arrow from gap to position
          const targetX = gaps[i].x;
          const targetY = boyY + boyRadius + 5;
          drawArrow(gaps[i].x, gaps[i].y - 18, targetX, targetY, 'rgba(74,222,128,0.3)');
        } else {
          // Phase 3: highlight selected gaps
          drawGap(gaps[i].x, gaps[i].y, gaps[i].label, highlighted);
          if (!highlighted) {
            const targetX = gaps[i].x;
            const targetY = boyY + boyRadius + 5;
            drawArrow(gaps[i].x, gaps[i].y - 18, targetX, targetY, 'rgba(74,222,128,0.15)');
          }
        }
      }
    }

    // Phase 3: draw girls at selected gap positions
    if (phase === 3) {
      for (let g = 0; g < selectedGaps.length; g++) {
        const gapIdx = selectedGaps[g];
        const gx = gaps[gapIdx].x;
        const gy = boyY - 70;
        drawGirl(gx, gy, girlLabels[g]);
        // Arrow from girl to gap
        drawArrow(gx, gy + boyRadius + 2, gx, boyY - boyRadius - 5, girlColor);
      }

      // Legend
      ctx.fillStyle = '#94a3b8';
      ctx.font = '12px Segoe UI, sans-serif';
      ctx.textAlign = 'left';
      ctx.textBaseline = 'top';

      const legendX = 30;
      const legendY = H - 80;

      // Boy legend
      ctx.beginPath();
      ctx.arc(legendX + 8, legendY + 8, 8, 0, 2 * Math.PI);
      ctx.fillStyle = 'rgba(96,165,250,0.2)';
      ctx.fill();
      ctx.strokeStyle = boyColor;
      ctx.lineWidth = 1.5;
      ctx.stroke();
      ctx.fillStyle = '#94a3b8';
      ctx.fillText('UÄenik', legendX + 22, legendY + 2);

      // Girl legend
      ctx.beginPath();
      ctx.arc(legendX + 8, legendY + 30, 8, 0, 2 * Math.PI);
      ctx.fillStyle = 'rgba(244,114,182,0.2)';
      ctx.fill();
      ctx.strokeStyle = girlColor;
      ctx.lineWidth = 1.5;
      ctx.stroke();
      ctx.fillStyle = '#94a3b8';
      ctx.fillText('UÄenica', legendX + 22, legendY + 24);

      // Gap legend
      ctx.beginPath();
      ctx.arc(legendX + 8, legendY + 52, 8, 0, 2 * Math.PI);
      ctx.fillStyle = 'rgba(74,222,128,0.1)';
      ctx.fill();
      ctx.strokeStyle = gapColor;
      ctx.lineWidth = 1.5;
      ctx.setLineDash([3, 3]);
      ctx.stroke();
      ctx.setLineDash([]);
      ctx.fillStyle = '#94a3b8';
      ctx.fillText('Praznina (slobodno mesto)', legendX + 22, legendY + 46);
    }

    // Formula summary at bottom
    if (phase === 1) {
      drawFormulaBox('5! = 120 naÄina za raspored uÄenika');
    } else if (phase === 2) {
      drawFormulaBox('6 praznina: _ U _ U _ U _ U _ U _');
    } else {
      drawFormulaBox('120 Ã— 15 Ã— 2 = 3600 ukupno naÄina');
    }
  }

  function drawFormulaBox(text) {
    ctx.fillStyle = 'rgba(30,41,59,0.85)';
    const boxW = 400;
    const boxH = 40;
    const boxX = W / 2 - boxW / 2;
    const boxY = H - 52;
    drawRoundedRect(boxX, boxY, boxW, boxH, 10);
    ctx.fill();
    ctx.strokeStyle = '#334155';
    ctx.lineWidth = 1;
    drawRoundedRect(boxX, boxY, boxW, boxH, 10);
    ctx.stroke();

    ctx.fillStyle = '#4ade80';
    ctx.font = 'bold 15px Segoe UI, sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(text, W / 2, boxY + boxH / 2);
  }

  draw();

  // Toggle controls
  const btnS1 = document.getElementById('btn-step1');
  const btnS2 = document.getElementById('btn-step2');
  const btnS3 = document.getElementById('btn-step3');
  const allBtns = [btnS1, btnS2, btnS3];

  function setPhase(p) {
    phase = p;
    allBtns.forEach((b, i) => {
      if (i + 1 === p) {
        b.classList.add('active');
      } else {
        b.classList.remove('active');
      }
    });
    draw();
  }

  btnS1.addEventListener('click', function() { setPhase(1); });
  btnS2.addEventListener('click', function() { setPhase(2); });
  btnS3.addEventListener('click', function() { setPhase(3); });

  // Touch support
  btnS1.addEventListener('touchstart', function(e) { e.preventDefault(); setPhase(1); });
  btnS2.addEventListener('touchstart', function(e) { e.preventDefault(); setPhase(2); });
  btnS3.addEventListener('touchstart', function(e) { e.preventDefault(); setPhase(3); });
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "RasporeÄ‘ivanje u red bez susednih uÄenica",
  "subject": "math",
  "unit": "combinatorics",
  "topic_tags": ["kombinatorika", "permutacije", "metoda praznina", "binomni koeficijent", "princip mnoÅ¾enja"]
}
BRAINSPARK_META-->