<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jednačina kruga - presek pravih i tangenta</title>

<script type="text/info" id="logic-scratchpad">
PROBLEM:
Jednačina kruga čiji centar je tačka preseka pravih x - 2y + 4 = 0 i 3x + y - 9 = 0
a koji dodiruje pravu 3x + 4y + 2 = 0 glasi:

(A) x² + y² - 4x - 6y - 2 = 0
(B) x² + y² - 4x - 6y = 0
(C) x² + y² - 4x - 6y - 3 = 0
(D) x² + y² - 4x - 6y + 1 = 0
(E) x² + y² - 4x - 6y - 1 = 0

SOLUTION:

Step 1: Find the center — intersection of x - 2y + 4 = 0 and 3x + y - 9 = 0.
From the first equation: x = 2y - 4
Substitute into second: 3(2y - 4) + y - 9 = 0
  6y - 12 + y - 9 = 0
  7y - 21 = 0
  7y = 21
  y = 3
Then x = 2(3) - 4 = 6 - 4 = 2

Center C = (2, 3).

Step 2: Find the radius — distance from center (2,3) to the tangent line 3x + 4y + 2 = 0.
Using distance formula: d = |Ax₀ + By₀ + C| / √(A² + B²)
d = |3·2 + 4·3 + 2| / √(3² + 4²)
d = |6 + 12 + 2| / √(9 + 16)
d = |20| / √25
d = 20 / 5
d = 4

So radius r = 4.

Step 3: Write the equation of the circle.
(x - 2)² + (y - 3)² = 16
x² - 4x + 4 + y² - 6y + 9 = 16
x² + y² - 4x - 6y + 13 = 16
x² + y² - 4x - 6y - 3 = 0

Answer: (C) x² + y² - 4x - 6y - 3 = 0

VERIFICATION:
- Center (2,3): check it lies on both lines.
  x - 2y + 4 = 2 - 6 + 4 = 0 ✓
  3x + y - 9 = 6 + 3 - 9 = 0 ✓
- Distance from (2,3) to 3x + 4y + 2 = 0: |6+12+2|/5 = 20/5 = 4 = r ✓
- Expanded form: (x-2)² + (y-3)² = 16 → x² + y² - 4x - 6y + 13 - 16 = 0 → x² + y² - 4x - 6y - 3 = 0 ✓
- Matches option (C) ✓
</script>

<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  font-size: 2.2rem;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
  line-height: 1.3;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 30px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.4rem;
  margin-bottom: 16px;
}

.highlight {
  color: #f472b6;
  font-weight: 600;
}

.math-box {
  background: rgba(56,189,248,0.08);
  border: 1px solid rgba(56,189,248,0.15);
  border-radius: 8px;
  padding: 14px 18px;
  margin: 12px 0;
  font-family: 'Courier New', monospace;
  overflow-x: auto;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.given-item {
  background: rgba(96,165,250,0.08);
  border: 1px solid rgba(96,165,250,0.18);
  border-radius: 10px;
  padding: 12px 18px;
  min-width: 80px;
  text-align: center;
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-bottom: 4px;
}

.given-item .value {
  color: #e2e8f0;
  font-size: 1rem;
  font-weight: 600;
}

.answer-option {
  cursor: default;
  transition: border-color 0.2s;
}

.plan-card {
  border-left: 3px solid #a78bfa;
}

details {
  margin: 15px 0;
}

details summary {
  cursor: pointer;
  color: #60a5fa;
  font-weight: 600;
  padding: 10px 0;
  user-select: none;
}

details summary:hover {
  color: #93bbfc;
}

details[open] summary {
  margin-bottom: 10px;
}

.theory-content ul {
  list-style: none;
  padding-left: 0;
}

.theory-content li {
  padding: 8px 0;
  border-bottom: 1px solid rgba(51,65,85,0.5);
  color: #cbd5e1;
}

.theory-content li:last-child {
  border-bottom: none;
}

.canvas-card {
  text-align: center;
}

canvas {
  border-radius: 10px;
  width: 100%;
  max-width: 700px;
  touch-action: none;
}

.canvas-hint {
  color: #64748b;
  font-size: 0.85rem;
  margin-top: 8px;
}

.step-container {
  margin-bottom: 18px;
  padding: 18px;
  padding-left: 24px;
  background: rgba(30,41,59,0.5);
  border-left: 3px solid #334155;
  border-radius: 0 10px 10px 0;
  cursor: pointer;
  transition: border-color 0.25s, background 0.25s;
}

.step-container:hover,
.step-container.active {
  border-left-color: #4ade80;
  background: rgba(30,41,59,0.9);
}

.step-badge {
  display: inline-block;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  color: #0f172a;
  font-weight: 700;
  font-size: 0.8rem;
  padding: 3px 10px;
  border-radius: 20px;
  margin-bottom: 8px;
}

.step-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: #e2e8f0;
  margin-bottom: 8px;
}

.step-text {
  color: #cbd5e1;
  font-size: 0.97rem;
}

.checkpoint {
  background: rgba(167,139,250,0.08);
  border: 1px solid rgba(167,139,250,0.2);
  border-radius: 8px;
  padding: 12px 16px;
  margin: 15px 0;
}

.checkpoint summary {
  color: #a78bfa;
}

.insight-box {
  background: linear-gradient(135deg, rgba(96,165,250,0.12), rgba(167,139,250,0.12));
  border: 1px solid rgba(167,139,250,0.25);
  border-radius: 14px;
  padding: 22px;
  margin-bottom: 24px;
}

.insight-box h3 {
  color: #a78bfa;
  margin-bottom: 10px;
}

.final-answer {
  text-align: center;
  padding: 30px;
  border: 2px solid rgba(74,222,128,0.3);
  background: rgba(74,222,128,0.06);
}

.final-answer .answer-value {
  font-size: 1.6rem;
  font-weight: 700;
  color: #4ade80;
  margin: 16px 0;
}

.final-answer .answer-label {
  color: #94a3b8;
  font-size: 0.95rem;
}

.options-row {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 12px;
  margin: 20px 0;
}

.option-box {
  padding: 10px 16px;
  border-radius: 10px;
  border: 2px solid #334155;
  background: rgba(30,41,59,0.6);
  color: #94a3b8;
  font-size: 0.95rem;
  font-weight: 600;
  transition: all 0.3s;
  text-align: left;
}

.option-box.correct {
  border-color: #4ade80;
  background: rgba(74,222,128,0.12);
  color: #4ade80;
}

.pitfall-list {
  list-style: none;
  padding: 0;
}

.pitfall-list li {
  padding: 10px 0;
  padding-left: 16px;
  position: relative;
  color: #cbd5e1;
}

.pitfall-list li::before {
  content: '\26A0';
  position: absolute;
  left: 0;
}

.challenge-box {
  border-left: 3px solid #f472b6;
}

.verification-note {
  color: #94a3b8;
  font-size: 0.9rem;
  margin-top: 10px;
}

@media (max-width: 700px) {
  h1 { font-size: 1.5rem; }
  .container { padding: 10px; }
  .card { padding: 16px; }
  .given-grid { flex-direction: column; }
  .options-row { flex-direction: column; align-items: center; }
  .option-box { width: 100%; text-align: center; }
}
</style>
</head>
<body>
<div class="container">

  <h1>Jednačina kruga sa datim centrom i tangentom</h1>
  <p class="subtitle">Analitička geometrija: presek pravih, rastojanje tačke od prave, jednačina kružnice</p>

  <!-- PROBLEM STATEMENT -->
  <div class="card problem-statement">
    <h2>Zadatak</h2>
    <p>Jednačina kruga čiji centar je tačka preseka pravih <span class="highlight">\(x - 2y + 4 = 0\)</span> i <span class="highlight">\(3x + y - 9 = 0\)</span>, a koji dodiruje pravu <span class="highlight">\(3x + 4y + 2 = 0\)</span>, glasi:</p>

    <div class="given-grid" style="margin-bottom: 12px;">
      <div class="given-item">
        <div class="label">Prava 1</div>
        <div class="value">\(x - 2y + 4 = 0\)</div>
      </div>
      <div class="given-item">
        <div class="label">Prava 2</div>
        <div class="value">\(3x + y - 9 = 0\)</div>
      </div>
      <div class="given-item">
        <div class="label">Tangenta</div>
        <div class="value">\(3x + 4y + 2 = 0\)</div>
      </div>
    </div>

    <p style="margin-top:16px; margin-bottom:4px; color:#94a3b8;">Ponudjeni odgovori:</p>
    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\(x^2 + y^2 - 4x - 6y - 2 = 0\)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\(x^2 + y^2 - 4x - 6y = 0\)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\(x^2 + y^2 - 4x - 6y - 3 = 0\)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\(x^2 + y^2 - 4x - 6y + 1 = 0\)</div>
      </div>
      <div class="given-item answer-option" data-option="E">
        <div class="label">(E)</div>
        <div class="value">\(x^2 + y^2 - 4x - 6y - 1 = 0\)</div>
      </div>
    </div>
  </div>

  <!-- PLAN -->
  <div class="card plan-card">
    <h2>Plan rešavanja</h2>
    <p>Najpre ćemo naći centar kruga kao presek dve zadate prave (sistem linearnih jednačina). Zatim ćemo odrediti poluprečnik kao rastojanje tog centra od tangentne prave. Na kraju ćemo zapisati jednačinu kružnice i razviti je u opšti oblik.</p>
  </div>

  <!-- THEORY -->
  <div class="card">
    <details>
      <summary>Ključne formule i teoreme</summary>
      <div class="theory-content">
        <ul>
          <li><strong>Presek dve prave:</strong> Rešavamo sistem \(a_1 x + b_1 y + c_1 = 0\) i \(a_2 x + b_2 y + c_2 = 0\) metodom zamene ili eliminacije.</li>
          <li><strong>Rastojanje tačke od prave:</strong> Za tačku \((x_0, y_0)\) i pravu \(Ax + By + C = 0\):
            \[ d = \frac{|Ax_0 + By_0 + C|}{\sqrt{A^2 + B^2}} \]
          </li>
          <li><strong>Jednačina kružnice (kanonski oblik):</strong> Sa centrom \((p, q)\) i poluprečnikom \(r\):
            \[ (x - p)^2 + (y - q)^2 = r^2 \]
          </li>
          <li><strong>Opšti oblik jednačine kružnice:</strong>
            \[ x^2 + y^2 + Dx + Ey + F = 0 \]
            gde je centar \(\left(-\frac{D}{2},\; -\frac{E}{2}\right)\) i \(r = \sqrt{\frac{D^2}{4} + \frac{E^2}{4} - F}\).
          </li>
          <li><strong>Tangenta kružnice:</strong> Prava <em>dodiruje</em> kružnicu kada je rastojanje centra od te prave jednako poluprečniku (\(d = r\)).</li>
        </ul>
      </div>
    </details>
  </div>

  <!-- VISUAL AID -->
  <div class="card canvas-card">
    <h2>Grafički prikaz</h2>
    <p style="color:#94a3b8; margin-bottom:14px;">Krug sa centrom u preseku dve prave i tangentom. Prevlačite centar da istražite kako se krug menja.</p>
    <canvas id="diagram" width="700" height="700"></canvas>
    <p class="canvas-hint">Prevucite zelenu tačku (centar) da istražite kako se menja poluprečnik i jednačina kruga.</p>
  </div>

  <!-- STEP-BY-STEP -->
  <div class="card">
    <h2>Rešenje korak po korak</h2>

    <!-- Step 1 -->
    <div class="step-container" id="step1">
      <span class="step-badge">Korak 1</span>
      <div class="step-title">Nalaženje centra kruga — presek dve prave</div>
      <div class="step-text">
        <p>Centar kruga je presek pravih \(x - 2y + 4 = 0\) i \(3x + y - 9 = 0\). Iz prve jednačine izrazimo \(x\):</p>
        <div class="math-box">
          \[ x = 2y - 4 \]
        </div>
        <p>Uvrštavamo u drugu jednačinu:</p>
        <div class="math-box">
          \[ 3(2y - 4) + y - 9 = 0 \]
        </div>
      </div>
    </div>

    <!-- Step 2 -->
    <div class="step-container" id="step2">
      <span class="step-badge">Korak 2</span>
      <div class="step-title">Rešavanje po \(y\)</div>
      <div class="step-text">
        <p>Razvijamo zagrade i sređujemo:</p>
        <div class="math-box">
          \[ 6y - 12 + y - 9 = 0 \]
          \[ 7y - 21 = 0 \]
          \[ 7y = 21 \]
          \[ y = 3 \]
        </div>
        <p>Vraćamo u izraz za \(x\):</p>
        <div class="math-box">
          \[ x = 2 \cdot 3 - 4 = 6 - 4 = 2 \]
        </div>
        <p>Dakle, centar kruga je tačka <span class="highlight">\(C = (2,\; 3)\)</span>.</p>
      </div>
    </div>

    <!-- Checkpoint 1 -->
    <details class="checkpoint">
      <summary>Proveri se: Da li tačka \((2, 3)\) zaista leži na obe prave?</summary>
      <p style="padding-top:8px; color:#cbd5e1;">
        Prva prava: \(2 - 2 \cdot 3 + 4 = 2 - 6 + 4 = 0\) &mdash; tačno!<br>
        Druga prava: \(3 \cdot 2 + 3 - 9 = 6 + 3 - 9 = 0\) &mdash; tačno!
      </p>
    </details>

    <!-- Step 3 -->
    <div class="step-container" id="step3">
      <span class="step-badge">Korak 3</span>
      <div class="step-title">Nalaženje poluprečnika — rastojanje centra od tangente</div>
      <div class="step-text">
        <p>Krug <em>dodiruje</em> pravu \(3x + 4y + 2 = 0\), što znači da je rastojanje centra od te prave jednako poluprečniku. Koristimo formulu za rastojanje tačke od prave:</p>
        <div class="math-box">
          \[ r = d = \frac{|Ax_0 + By_0 + C|}{\sqrt{A^2 + B^2}} \]
        </div>
        <p>Sa \(A = 3\), \(B = 4\), \(C = 2\) i tačkom \((x_0, y_0) = (2, 3)\):</p>
        <div class="math-box">
          \[ r = \frac{|3 \cdot 2 + 4 \cdot 3 + 2|}{\sqrt{3^2 + 4^2}} \]
        </div>
      </div>
    </div>

    <!-- Step 4 -->
    <div class="step-container" id="step4">
      <span class="step-badge">Korak 4</span>
      <div class="step-title">Izračunavanje poluprečnika</div>
      <div class="step-text">
        <p>Izračunavamo brojilac:</p>
        <div class="math-box">
          \[ |3 \cdot 2 + 4 \cdot 3 + 2| = |6 + 12 + 2| = |20| = 20 \]
        </div>
        <p>Izračunavamo imenilac:</p>
        <div class="math-box">
          \[ \sqrt{3^2 + 4^2} = \sqrt{9 + 16} = \sqrt{25} = 5 \]
        </div>
        <p>Prema tome:</p>
        <div class="math-box">
          \[ r = \frac{20}{5} = 4 \]
        </div>
        <p>Poluprečnik kruga je <span class="highlight">\(r = 4\)</span>.</p>
      </div>
    </div>

    <!-- Checkpoint 2 -->
    <details class="checkpoint">
      <summary>Proveri se: Koliko je \(r^2\)?</summary>
      <p style="padding-top:8px; color:#cbd5e1;">
        \(r^2 = 4^2 = 16\). Ovo nam treba za jednačinu kružnice u sledećem koraku.
      </p>
    </details>

    <!-- Step 5 -->
    <div class="step-container" id="step5">
      <span class="step-badge">Korak 5</span>
      <div class="step-title">Pisanje jednačine kružnice u kanonskom obliku</div>
      <div class="step-text">
        <p>Sa centrom \(C(2, 3)\) i poluprečnikom \(r = 4\) zapisujemo:</p>
        <div class="math-box">
          \[ (x - 2)^2 + (y - 3)^2 = 16 \]
        </div>
      </div>
    </div>

    <!-- Step 6 -->
    <div class="step-container" id="step6">
      <span class="step-badge">Korak 6</span>
      <div class="step-title">Razvijanje u opšti oblik</div>
      <div class="step-text">
        <p>Razvijamo kvadrate binoma:</p>
        <div class="math-box">
          \[ (x-2)^2 = x^2 - 4x + 4 \]
          \[ (y-3)^2 = y^2 - 6y + 9 \]
        </div>
        <p>Sabiramo:</p>
        <div class="math-box">
          \[ x^2 - 4x + 4 + y^2 - 6y + 9 = 16 \]
        </div>
        <p>Sređujemo (sve na levu stranu):</p>
        <div class="math-box">
          \[ x^2 + y^2 - 4x - 6y + 13 - 16 = 0 \]
          \[ \boxed{x^2 + y^2 - 4x - 6y - 3 = 0} \]
        </div>
      </div>
    </div>

    <!-- Checkpoint 3 -->
    <details class="checkpoint">
      <summary>Proveri se: Provera sa opštim oblikom jednačine kružnice</summary>
      <p style="padding-top:8px; color:#cbd5e1;">
        Iz \(x^2 + y^2 - 4x - 6y - 3 = 0\) čitamo: \(D = -4\), \(E = -6\), \(F = -3\).<br>
        Centar: \(\left(-\frac{-4}{2},\; -\frac{-6}{2}\right) = (2, 3)\) &mdash; tačno!<br>
        Poluprečnik: \(r = \sqrt{\frac{16}{4} + \frac{36}{4} + 3} = \sqrt{4 + 9 + 3} = \sqrt{16} = 4\) &mdash; tačno!
      </p>
    </details>
  </div>

  <!-- KEY INSIGHT -->
  <div class="insight-box">
    <h3>Ključni uvid</h3>
    <p>Kada krug <em>dodiruje</em> (tangira) pravu, rastojanje od centra do te prave je jednako poluprečniku. Ovo je ključna veza koja nam omogućava da odredimo \(r\). Trojka \((3, 4, 5)\) je Pitagorina trojka, pa imenilac \(\sqrt{9 + 16} = 5\) izlazi lepo &mdash; ovo je česta pojava u zadacima iz analitičke geometrije.</p>
  </div>

  <!-- FINAL ANSWER -->
  <div class="card final-answer">
    <h2>Konačan odgovor</h2>
    <p class="answer-label">Jednačina kruga glasi:</p>
    <div class="answer-value">(C) \(x^2 + y^2 - 4x - 6y - 3 = 0\)</div>
    <div class="options-row">
      <div class="option-box">(A) \(x^2 + y^2 - 4x - 6y - 2 = 0\)</div>
      <div class="option-box">(B) \(x^2 + y^2 - 4x - 6y = 0\)</div>
      <div class="option-box correct">(C) \(x^2 + y^2 - 4x - 6y - 3 = 0\)</div>
      <div class="option-box">(D) \(x^2 + y^2 - 4x - 6y + 1 = 0\)</div>
      <div class="option-box">(E) \(x^2 + y^2 - 4x - 6y - 1 = 0\)</div>
    </div>
    <p class="verification-note">Provera: Centar \((2, 3)\) leži na obe zadate prave, a rastojanje od centra do tangente \(3x + 4y + 2 = 0\) iznosi tačno \(4\), što je poluprečnik kruga. Razvijanjem \((x-2)^2 + (y-3)^2 = 16\) dobijamo upravo opciju (C).</p>
  </div>

  <!-- PITFALLS -->
  <div class="card">
    <h2>Česte greške</h2>
    <ul class="pitfall-list">
      <li>Pogrešno izračunavanje preseka pravih &mdash; pazite na znakove pri zameni. Lako je pogrešiti minus u \(x = 2y - 4\).</li>
      <li>Zaboraviti apsolutnu vrednost u formuli za rastojanje. Rastojanje je uvek pozitivno, pa je \(|20|/5 = 4\), ne \(-20/5\).</li>
      <li>Greška pri razvijanju \((x-2)^2 + (y-3)^2 = 16\): slobodan član je \(4 + 9 - 16 = -3\), ne \(+3\) ili neka druga vrednost. Mnogi kandidati pogreše znak na ovom koraku.</li>
    </ul>
  </div>

  <!-- CHALLENGE -->
  <div class="card challenge-box">
    <h2>Dodatni izazov</h2>
    <p>Šta ako krug treba da prolazi kroz koordinatni početak \((0, 0)\) umesto da dodiruje pravu \(3x + 4y + 2 = 0\)? Kako bi tada glasila jednačina?</p>
    <details>
      <summary>Pomoć</summary>
      <p style="padding-top:8px; color:#cbd5e1;">
        Ako krug sa centrom \((2, 3)\) prolazi kroz \((0, 0)\), tada je poluprečnik \(r = \sqrt{(2-0)^2 + (3-0)^2} = \sqrt{4 + 9} = \sqrt{13}\). Jednačina bi bila \((x-2)^2 + (y-3)^2 = 13\), odnosno \(x^2 + y^2 - 4x - 6y = 0\) &mdash; što je upravo opcija (B)!
      </p>
    </details>
  </div>

</div>

<script>
(() => {
  // Step click highlighting
  const steps = document.querySelectorAll('.step-container');
  steps.forEach(step => {
    step.addEventListener('click', () => {
      steps.forEach(s => s.classList.remove('active'));
      step.classList.toggle('active');
    });
  });

  // Canvas diagram
  const canvas = document.getElementById('diagram');
  const ctx = canvas.getContext('2d');
  const W = canvas.width;
  const H = canvas.height;

  // Coordinate system: center of canvas is the origin
  const scale = 40; // pixels per unit
  const originX = W / 2;
  const originY = H / 2;

  // Draggable center point
  let centerX = 2;
  let centerY = 3;
  let isDragging = false;
  let isLocked = true; // start locked at correct position

  function toCanvas(x, y) {
    return { x: originX + x * scale, y: originY - y * scale };
  }

  function toMath(cx, cy) {
    return { x: (cx - originX) / scale, y: (originY - cy) / scale };
  }

  // Distance from point (px,py) to line Ax + By + C = 0
  function distToLine(px, py, A, B, C) {
    return Math.abs(A * px + B * py + C) / Math.sqrt(A * A + B * B);
  }

  // Line-line intersection
  function lineIntersection(a1, b1, c1, a2, b2, c2) {
    // a1*x + b1*y + c1 = 0, a2*x + b2*y + c2 = 0
    const det = a1 * b2 - a2 * b1;
    if (Math.abs(det) < 1e-10) return null;
    return {
      x: (b1 * c2 - b2 * c1) / det,
      y: (a2 * c1 - a1 * c2) / det
    };
  }

  function drawLine(a, b, c, color, dashed) {
    // Draw line ax + by + c = 0 across the canvas
    ctx.strokeStyle = color;
    ctx.lineWidth = 2;
    if (dashed) ctx.setLineDash([6, 4]);
    else ctx.setLineDash([]);

    // Find two points on the line within view range
    const range = 12;
    let pts = [];
    if (Math.abs(b) > 1e-10) {
      // y = (-a*x - c) / b
      for (let xv = -range; xv <= range; xv += 2 * range) {
        pts.push({ x: xv, y: (-a * xv - c) / b });
      }
    } else {
      // x = -c/a
      const xv = -c / a;
      pts.push({ x: xv, y: -range });
      pts.push({ x: xv, y: range });
    }

    const p1 = toCanvas(pts[0].x, pts[0].y);
    const p2 = toCanvas(pts[1].x, pts[1].y);
    ctx.beginPath();
    ctx.moveTo(p1.x, p1.y);
    ctx.lineTo(p2.x, p2.y);
    ctx.stroke();
    ctx.setLineDash([]);
  }

  function draw() {
    // Background
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    // Grid
    ctx.strokeStyle = '#1a2436';
    ctx.lineWidth = 1;
    for (let i = -10; i <= 10; i++) {
      const p1 = toCanvas(i, -10);
      const p2 = toCanvas(i, 10);
      ctx.beginPath();
      ctx.moveTo(p1.x, p1.y);
      ctx.lineTo(p2.x, p2.y);
      ctx.stroke();

      const p3 = toCanvas(-10, i);
      const p4 = toCanvas(10, i);
      ctx.beginPath();
      ctx.moveTo(p3.x, p3.y);
      ctx.lineTo(p4.x, p4.y);
      ctx.stroke();
    }

    // Axes
    ctx.strokeStyle = '#475569';
    ctx.lineWidth = 2;
    ctx.setLineDash([]);
    ctx.beginPath();
    ctx.moveTo(0, originY);
    ctx.lineTo(W, originY);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(originX, 0);
    ctx.lineTo(originX, H);
    ctx.stroke();

    // Axis labels
    ctx.fillStyle = '#94a3b8';
    ctx.font = '14px Segoe UI, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('x', W - 20, originY - 8);
    ctx.textAlign = 'center';
    ctx.fillText('y', originX + 14, 18);

    // Tick marks
    ctx.fillStyle = '#64748b';
    ctx.font = '11px Segoe UI, sans-serif';
    ctx.textAlign = 'center';
    for (let i = -8; i <= 8; i++) {
      if (i === 0) continue;
      const p = toCanvas(i, 0);
      ctx.fillText(String(i), p.x, p.y + 16);
      const p2 = toCanvas(0, i);
      ctx.textAlign = 'right';
      ctx.fillText(String(i), p2.x - 6, p2.y + 4);
      ctx.textAlign = 'center';
    }

    // Line 1: x - 2y + 4 = 0 (blue, dashed)
    drawLine(1, -2, 4, '#60a5fa', true);
    // Label
    ctx.fillStyle = '#60a5fa';
    ctx.font = '13px Segoe UI, sans-serif';
    ctx.textAlign = 'left';
    const lbl1Pos = toCanvas(6, 5);
    ctx.fillText('x - 2y + 4 = 0', lbl1Pos.x - 40, lbl1Pos.y - 6);

    // Line 2: 3x + y - 9 = 0 (purple, dashed)
    drawLine(3, 1, -9, '#a78bfa', true);
    // Label
    ctx.fillStyle = '#a78bfa';
    ctx.textAlign = 'left';
    const lbl2Pos = toCanvas(4.5, -4.5);
    ctx.fillText('3x + y - 9 = 0', lbl2Pos.x - 30, lbl2Pos.y - 6);

    // Tangent line: 3x + 4y + 2 = 0 (pink, solid)
    drawLine(3, 4, 2, '#f472b6', false);
    // Label
    ctx.fillStyle = '#f472b6';
    ctx.textAlign = 'left';
    const lbl3Pos = toCanvas(-7, 4.7);
    ctx.fillText('3x + 4y + 2 = 0', lbl3Pos.x, lbl3Pos.y);

    // Calculate radius = distance from center to tangent line
    const r = distToLine(centerX, centerY, 3, 4, 2);

    // Draw the circle
    const cCanvas = toCanvas(centerX, centerY);
    ctx.strokeStyle = '#34d399';
    ctx.lineWidth = 2.5;
    ctx.setLineDash([]);
    ctx.beginPath();
    ctx.arc(cCanvas.x, cCanvas.y, r * scale, 0, 2 * Math.PI);
    ctx.stroke();

    // Circle fill (very subtle)
    ctx.fillStyle = 'rgba(52, 211, 153, 0.04)';
    ctx.beginPath();
    ctx.arc(cCanvas.x, cCanvas.y, r * scale, 0, 2 * Math.PI);
    ctx.fill();

    // Draw radius line from center to closest point on tangent
    // Closest point on 3x + 4y + 2 = 0 to (centerX, centerY)
    const A = 3, B = 4, C2 = 2;
    const denom = A * A + B * B;
    const footX = centerX - A * (A * centerX + B * centerY + C2) / denom;
    const footY = centerY - B * (A * centerX + B * centerY + C2) / denom;

    const footCanvas = toCanvas(footX, footY);
    ctx.strokeStyle = 'rgba(52, 211, 153, 0.5)';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([4, 4]);
    ctx.beginPath();
    ctx.moveTo(cCanvas.x, cCanvas.y);
    ctx.lineTo(footCanvas.x, footCanvas.y);
    ctx.stroke();
    ctx.setLineDash([]);

    // Right angle marker at foot
    const dx = (centerX - footX);
    const dy = (centerY - footY);
    const len = Math.sqrt(dx * dx + dy * dy);
    if (len > 0.1) {
      const ux = dx / len;
      const uy = dy / len;
      // perpendicular direction along the line
      const vx = -uy;
      const vy = ux;
      const sz = 0.4; // size in math coords
      const corner1 = toCanvas(footX + ux * sz, footY + uy * sz);
      const corner2 = toCanvas(footX + ux * sz + vx * sz, footY + uy * sz + vy * sz);
      const corner3 = toCanvas(footX + vx * sz, footY + vy * sz);
      ctx.strokeStyle = '#34d399';
      ctx.lineWidth = 1.5;
      ctx.beginPath();
      ctx.moveTo(corner1.x, corner1.y);
      ctx.lineTo(corner2.x, corner2.y);
      ctx.lineTo(corner3.x, corner3.y);
      ctx.stroke();
    }

    // Radius label
    ctx.fillStyle = '#34d399';
    ctx.font = 'bold 13px Segoe UI, sans-serif';
    ctx.textAlign = 'center';
    const midRX = (cCanvas.x + footCanvas.x) / 2;
    const midRY = (cCanvas.y + footCanvas.y) / 2;
    ctx.fillText('r = ' + r.toFixed(2).replace('.', ','), midRX + 18, midRY - 8);

    // Tangent point (foot)
    ctx.beginPath();
    ctx.arc(footCanvas.x, footCanvas.y, 4, 0, 2 * Math.PI);
    ctx.fillStyle = '#f472b6';
    ctx.fill();

    // Center point (draggable, green)
    // Glow
    ctx.beginPath();
    ctx.arc(cCanvas.x, cCanvas.y, 12, 0, 2 * Math.PI);
    ctx.fillStyle = 'rgba(74,222,128,0.25)';
    ctx.fill();
    // Point
    ctx.beginPath();
    ctx.arc(cCanvas.x, cCanvas.y, 6, 0, 2 * Math.PI);
    ctx.fillStyle = '#4ade80';
    ctx.fill();
    ctx.strokeStyle = '#166534';
    ctx.lineWidth = 1.5;
    ctx.stroke();
    // Label
    ctx.fillStyle = '#4ade80';
    ctx.font = 'bold 13px Segoe UI, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('C(' + centerX.toFixed(1).replace('.', ',') + '; ' + centerY.toFixed(1).replace('.', ',') + ')', cCanvas.x + 12, cCanvas.y - 12);

    // Intersection point marker (the actual correct center)
    if (!isLocked) {
      const actualCenter = toCanvas(2, 3);
      ctx.beginPath();
      ctx.arc(actualCenter.x, actualCenter.y, 4, 0, 2 * Math.PI);
      ctx.fillStyle = 'rgba(96,165,250,0.5)';
      ctx.fill();
      ctx.fillStyle = '#60a5fa';
      ctx.font = '11px Segoe UI, sans-serif';
      ctx.textAlign = 'left';
      ctx.fillText('Presek (2, 3)', actualCenter.x + 8, actualCenter.y + 14);
    }

    // Legend
    const legendX = 14;
    let legendY = 22;
    ctx.font = '12px Segoe UI, sans-serif';
    ctx.textAlign = 'left';

    // Line 1
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2;
    ctx.setLineDash([4, 3]);
    ctx.beginPath();
    ctx.moveTo(legendX, legendY - 4);
    ctx.lineTo(legendX + 16, legendY - 4);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillStyle = '#60a5fa';
    ctx.fillText('x - 2y + 4 = 0', legendX + 22, legendY);
    legendY += 20;

    // Line 2
    ctx.strokeStyle = '#a78bfa';
    ctx.lineWidth = 2;
    ctx.setLineDash([4, 3]);
    ctx.beginPath();
    ctx.moveTo(legendX, legendY - 4);
    ctx.lineTo(legendX + 16, legendY - 4);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillStyle = '#a78bfa';
    ctx.fillText('3x + y - 9 = 0', legendX + 22, legendY);
    legendY += 20;

    // Tangent
    ctx.strokeStyle = '#f472b6';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(legendX, legendY - 4);
    ctx.lineTo(legendX + 16, legendY - 4);
    ctx.stroke();
    ctx.fillStyle = '#f472b6';
    ctx.fillText('3x + 4y + 2 = 0 (tangenta)', legendX + 22, legendY);
    legendY += 20;

    // Circle
    ctx.beginPath();
    ctx.arc(legendX + 8, legendY - 5, 6, 0, 2 * Math.PI);
    ctx.strokeStyle = '#34d399';
    ctx.lineWidth = 2;
    ctx.stroke();
    ctx.fillStyle = '#34d399';
    ctx.fillText('Krug', legendX + 22, legendY);
    legendY += 20;

    // Center
    ctx.beginPath();
    ctx.arc(legendX + 8, legendY - 5, 4, 0, 2 * Math.PI);
    ctx.fillStyle = '#4ade80';
    ctx.fill();
    ctx.fillStyle = '#4ade80';
    ctx.fillText('Centar (prevucite)', legendX + 22, legendY);
  }

  draw();

  // --- Interaction: dragging the center ---
  function getEventPos(e) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = W / rect.width;
    const scaleY = H / rect.height;
    let clientX, clientY;
    if (e.touches) {
      clientX = e.touches[0].clientX;
      clientY = e.touches[0].clientY;
    } else {
      clientX = e.clientX;
      clientY = e.clientY;
    }
    return {
      x: (clientX - rect.left) * scaleX,
      y: (clientY - rect.top) * scaleY
    };
  }

  function isNearCenter(pos) {
    const c = toCanvas(centerX, centerY);
    const dx = pos.x - c.x;
    const dy = pos.y - c.y;
    return dx * dx + dy * dy < 400; // within 20px
  }

  function onPointerDown(e) {
    const pos = getEventPos(e);
    if (isNearCenter(pos)) {
      isDragging = true;
      isLocked = false;
      e.preventDefault();
    }
  }

  function onPointerMove(e) {
    if (!isDragging) return;
    e.preventDefault();
    const pos = getEventPos(e);
    const m = toMath(pos.x, pos.y);
    centerX = Math.round(m.x * 2) / 2; // snap to 0.5 grid
    centerY = Math.round(m.y * 2) / 2;
    // clamp
    centerX = Math.max(-8, Math.min(8, centerX));
    centerY = Math.max(-8, Math.min(8, centerY));
    draw();
  }

  function onPointerUp() {
    isDragging = false;
  }

  canvas.addEventListener('mousedown', onPointerDown);
  canvas.addEventListener('mousemove', onPointerMove);
  canvas.addEventListener('mouseup', onPointerUp);
  canvas.addEventListener('mouseleave', onPointerUp);
  canvas.addEventListener('touchstart', onPointerDown, { passive: false });
  canvas.addEventListener('touchmove', onPointerMove, { passive: false });
  canvas.addEventListener('touchend', onPointerUp);

  // Double-click to reset center to correct position
  canvas.addEventListener('dblclick', () => {
    centerX = 2;
    centerY = 3;
    isLocked = true;
    draw();
  });
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Jednačina kruga sa centrom u preseku pravih i tangentom",
  "subject": "math",
  "unit": "geometry",
  "topic_tags": ["analitička geometrija", "kružnica", "presek pravih", "rastojanje tačke od prave", "tangenta"]
}
BRAINSPARK_META-->