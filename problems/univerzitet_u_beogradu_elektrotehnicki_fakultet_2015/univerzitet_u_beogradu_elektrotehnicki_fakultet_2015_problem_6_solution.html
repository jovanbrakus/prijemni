<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Odnos povrsina valjka i kupe</title>
<script type="text/info" id="logic-scratchpad">
Problem: Prav valjak i prava kupa imaju zajednicku osnovu. Vrh kupe je centar druge osnove valjka.
Odnos visine valjka i izvodnice kupe je h:l = 4:5.
Trazi se odnos povrsina valjka i kupe.

Neka su:
  r = poluprecnik zajednicke osnove
  h = visina valjka (= visina kupe, jer je vrh kupe centar druge osnove)
  l = izvodnica kupe

Korak 1: Iz odnosa h/l = 4/5 dobijamo l = 5h/4.

Korak 2: Pitagorina teorema za kupu:
  l^2 = r^2 + h^2
  (5h/4)^2 = r^2 + h^2
  25h^2/16 = r^2 + h^2
  r^2 = 25h^2/16 - h^2 = 25h^2/16 - 16h^2/16 = 9h^2/16
  r = 3h/4

Korak 3: Povrsina valjka (ukupna):
  P_v = 2*pi*r^2 + 2*pi*r*h
  = 2*pi*(9h^2/16) + 2*pi*(3h/4)*h
  = 9*pi*h^2/8 + 3*pi*h^2/2
  = 9*pi*h^2/8 + 12*pi*h^2/8
  = 21*pi*h^2/8

Korak 4: Povrsina kupe (ukupna):
  P_k = pi*r^2 + pi*r*l
  = pi*(9h^2/16) + pi*(3h/4)*(5h/4)
  = 9*pi*h^2/16 + 15*pi*h^2/16
  = 24*pi*h^2/16
  = 3*pi*h^2/2
  = 12*pi*h^2/8

Korak 5: Odnos:
  P_v : P_k = 21*pi*h^2/8 : 12*pi*h^2/8 = 21 : 12 = 7 : 4

Odgovor: (E) 7 : 4
</script>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  font-size: 2.2rem;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
  line-height: 1.3;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 32px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.4rem;
  margin-bottom: 16px;
}

.card h3 {
  color: #e2e8f0;
  font-size: 1.15rem;
  margin-bottom: 10px;
}

.highlight {
  color: #f472b6;
  font-weight: 600;
}

.math-box {
  background: rgba(56,189,248,0.08);
  border: 1px solid rgba(56,189,248,0.15);
  border-radius: 8px;
  padding: 14px 18px;
  margin: 12px 0;
  font-family: 'Courier New', monospace;
  font-size: 1.05rem;
  overflow-x: auto;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.given-item {
  background: rgba(96,165,250,0.08);
  border: 1px solid rgba(96,165,250,0.18);
  border-radius: 10px;
  padding: 12px 18px;
  min-width: 80px;
  text-align: center;
  transition: transform 0.2s, border-color 0.2s;
}

.given-item:hover {
  transform: translateY(-2px);
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-bottom: 4px;
}

.given-item .value {
  color: #e2e8f0;
  font-size: 1.1rem;
  font-weight: 600;
}

.answer-option {
  cursor: default;
}

/* Plan card */
.plan-card {
  border-left: 3px solid #a78bfa;
}

.plan-card h2 {
  color: #a78bfa;
}

/* Details/collapsible */
details {
  margin: 15px 0;
  background: rgba(167,139,250,0.06);
  border: 1px solid rgba(167,139,250,0.15);
  border-radius: 10px;
  padding: 14px 18px;
}

details summary {
  cursor: pointer;
  color: #a78bfa;
  font-weight: 600;
  font-size: 1.05rem;
  user-select: none;
}

details summary:hover {
  color: #c4b5fd;
}

details[open] summary {
  margin-bottom: 12px;
}

details ul {
  list-style: none;
  padding-left: 0;
}

details li {
  padding: 6px 0;
  border-bottom: 1px solid rgba(51,65,85,0.5);
  color: #e2e8f0;
}

details li:last-child {
  border-bottom: none;
}

/* Canvas card */
.canvas-card {
  text-align: center;
}

.canvas-card canvas {
  width: 100%;
  max-width: 700px;
  border-radius: 10px;
  border: 1px solid #334155;
  touch-action: none;
}

.canvas-hint {
  color: #64748b;
  font-size: 0.85rem;
  margin-top: 8px;
}

/* Steps */
.step {
  display: flex;
  gap: 16px;
  padding: 16px;
  border-radius: 10px;
  margin-bottom: 14px;
  border-left: 3px solid transparent;
  transition: border-color 0.2s, background 0.2s;
  cursor: pointer;
}

.step:hover, .step.active {
  border-left-color: #4ade80;
  background: rgba(74,222,128,0.04);
}

.step-badge {
  flex-shrink: 0;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  color: #fff;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.95rem;
}

.step-content {
  flex: 1;
}

.step-content p {
  color: #94a3b8;
  margin-top: 6px;
}

/* Checkpoint */
.checkpoint {
  background: rgba(52,211,153,0.06);
  border: 1px solid rgba(52,211,153,0.18);
}

.checkpoint summary {
  color: #34d399;
}

/* Key insight */
.insight-card {
  background: linear-gradient(135deg, rgba(96,165,250,0.1), rgba(167,139,250,0.1));
  border: 1px solid rgba(167,139,250,0.25);
}

.insight-card h2 {
  color: #a78bfa;
}

/* Final answer */
.final-answer {
  border: 2px solid rgba(74,222,128,0.3);
  background: linear-gradient(135deg, rgba(74,222,128,0.06), rgba(52,211,153,0.04));
}

.final-answer h2 {
  color: #4ade80;
}

.answer-big {
  font-size: 1.6rem;
  font-weight: 700;
  color: #4ade80;
  text-align: center;
  margin: 20px 0;
}

.options-row {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  margin: 16px 0;
}

.option-box {
  padding: 10px 20px;
  border-radius: 10px;
  border: 2px solid #334155;
  background: #1e293b;
  text-align: center;
  min-width: 90px;
  transition: transform 0.2s;
}

.option-box.correct {
  border-color: #4ade80;
  background: rgba(74,222,128,0.1);
  transform: scale(1.05);
}

.option-box .opt-label {
  color: #94a3b8;
  font-size: 0.85rem;
}

.option-box .opt-value {
  font-size: 1.15rem;
  font-weight: 600;
  color: #e2e8f0;
}

.option-box.correct .opt-value {
  color: #4ade80;
}

.verification {
  color: #94a3b8;
  font-size: 0.95rem;
  margin-top: 14px;
  padding-top: 14px;
  border-top: 1px solid #334155;
}

/* Pitfalls */
.pitfall-list {
  list-style: none;
  padding: 0;
}

.pitfall-list li {
  padding: 10px 14px;
  margin-bottom: 8px;
  background: rgba(224,148,104,0.06);
  border-left: 3px solid #e09468;
  border-radius: 0 8px 8px 0;
  color: #e2e8f0;
}

.pitfall-list li strong {
  color: #e09468;
}

/* Challenge */
.challenge-card {
  border: 1px solid rgba(244,114,182,0.2);
  background: rgba(244,114,182,0.04);
}

.challenge-card h2 {
  color: #f472b6;
}

@media (max-width: 700px) {
  h1 { font-size: 1.6rem; }
  .card { padding: 16px; }
  .step { flex-direction: column; gap: 10px; }
  .given-grid { flex-direction: column; }
  .options-row { flex-direction: column; align-items: center; }
}
</style>
</head>
<body>
<div class="container">

  <h1>Odnos povrsina valjka i kupe</h1>
  <p class="subtitle">Stereometrija, povrsine rotacionih tela, Pitagorina teorema</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <h2>Postavka zadatka</h2>
    <p>Prav valjak i prava kupa imaju zajednicku osnovu. Vrh kupe je centar druge osnove valjka. Ako je odnos visine valjka i izvodnice kupe \(4:5\), tada je odnos povrsina valjka i kupe jednak:</p>

    <div class="given-grid" style="margin-bottom: 18px;">
      <div class="given-item">
        <div class="label">Zajednicka osnova</div>
        <div class="value">poluprecnik \(r\)</div>
      </div>
      <div class="given-item">
        <div class="label">Visina valjka</div>
        <div class="value">\(h\)</div>
      </div>
      <div class="given-item">
        <div class="label">Izvodnica kupe</div>
        <div class="value">\(l\)</div>
      </div>
      <div class="given-item">
        <div class="label">Odnos</div>
        <div class="value">\(h : l = 4 : 5\)</div>
      </div>
      <div class="given-item">
        <div class="label">Trazi se</div>
        <div class="value">\(P_{\text{valjka}} : P_{\text{kupe}}\)</div>
      </div>
    </div>

    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\(3 : 2\)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\(7 : 5\)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\(4 : 3\)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\(8 : 5\)</div>
      </div>
      <div class="given-item answer-option" data-option="E">
        <div class="label">(E)</div>
        <div class="value">\(7 : 4\)</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card plan-card">
    <h2>Plan resavanja</h2>
    <ol style="color:#94a3b8; padding-left: 20px;">
      <li>Iz odnosa \(h : l = 4 : 5\) izraziti izvodnica \(l\) preko visine \(h\).</li>
      <li>Pitagorinom teoremom (iz pravouglog trougla u preseku kupe) naci vezu izmedju \(r\) i \(h\).</li>
      <li>Izracunati ukupnu povrsinu valjka: \(P_v = 2\pi r^2 + 2\pi r h\).</li>
      <li>Izracunati ukupnu povrsinu kupe: \(P_k = \pi r^2 + \pi r l\).</li>
      <li>Naci odnos \(P_v : P_k\).</li>
    </ol>
  </div>

  <!-- Theory Refresher -->
  <details>
    <summary>Kljucne formule i pojmovi</summary>
    <ul>
      <li><strong>Povrsina pravog valjka:</strong> \(P_v = 2\pi r^2 + 2\pi r h\), gde su \(r\) poluprecnik osnove i \(h\) visina.</li>
      <li><strong>Povrsina prave kupe:</strong> \(P_k = \pi r^2 + \pi r l\), gde su \(r\) poluprecnik osnove i \(l\) izvodnica.</li>
      <li><strong>Veza izvodnice i visine kupe:</strong> \(l^2 = r^2 + h_k^2\), gde je \(h_k\) visina kupe (Pitagorina teorema u aksijalnom preseku).</li>
      <li><strong>Aksijalni presek valjka:</strong> pravougaonik sa stranicama \(2r\) i \(h\).</li>
      <li><strong>Aksijalni presek kupe:</strong> jednakokraki trougao sa osnovicom \(2r\) i kracima \(l\).</li>
    </ul>
  </details>

  <!-- Canvas Visualization -->
  <div class="card canvas-card">
    <h2>3D prikaz valjka i kupe</h2>
    <p style="color:#94a3b8; margin-bottom: 14px;">Valjak (plavo) i kupa (narandzasto) sa zajednickom osnovom. Vrh kupe je u centru gornje osnove valjka.</p>
    <canvas id="scene-canvas" width="700" height="600"></canvas>
    <p class="canvas-hint">Prevlacite levo-desno da rotirate 3D prikaz</p>
  </div>

  <!-- Step-by-step solution -->
  <div class="card">
    <h2>Resenje korak po korak</h2>

    <div class="step" id="step-1">
      <div class="step-badge">1</div>
      <div class="step-content">
        <h3>Oznacavanje velicina i uslov zadatka</h3>
        <p>Neka je \(r\) poluprecnik zajednicke osnove valjka i kupe, \(h\) visina valjka, a \(l\) izvodnica kupe.</p>
        <p>Posto je vrh kupe centar <em>druge</em> osnove valjka, visina kupe jednaka je visini valjka: \(h_k = h\).</p>
        <p>Dato je:</p>
        <div class="math-box">
          \[ \frac{h}{l} = \frac{4}{5} \quad \Longrightarrow \quad l = \frac{5h}{4} \]
        </div>
      </div>
    </div>

    <div class="step" id="step-2">
      <div class="step-badge">2</div>
      <div class="step-content">
        <h3>Nalazenje poluprecnika \(r\) pomocu Pitagorine teoreme</h3>
        <p>U aksijalnom preseku kupe, pravougli trougao ima katete \(r\) i \(h\), a hipotenuzu \(l\):</p>
        <div class="math-box">
          \[ l^2 = r^2 + h^2 \]
        </div>
        <p>Uvrstimo \(l = \dfrac{5h}{4}\):</p>
        <div class="math-box">
          \[ \left(\frac{5h}{4}\right)^{\!2} = r^2 + h^2 \]
        </div>
        <div class="math-box">
          \[ \frac{25h^2}{16} = r^2 + h^2 \]
        </div>
        <p>Izrazimo \(r^2\):</p>
        <div class="math-box">
          \[ r^2 = \frac{25h^2}{16} - h^2 = \frac{25h^2}{16} - \frac{16h^2}{16} = \frac{9h^2}{16} \]
        </div>
        <p>Dakle:</p>
        <div class="math-box">
          \[ \boxed{r = \frac{3h}{4}} \]
        </div>
        <p style="color: #f472b6;">Primetimo: trojka \((r,\, h,\, l) = \left(\frac{3h}{4},\, h,\, \frac{5h}{4}\right)\) odgovara Pitagorinoj trojci \(3 : 4 : 5\)!</p>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri se: Koliko je \(r^2 + h^2\)?</summary>
      <p>\(r^2 + h^2 = \dfrac{9h^2}{16} + h^2 = \dfrac{9h^2 + 16h^2}{16} = \dfrac{25h^2}{16} = l^2\). Tacno! &check;</p>
    </details>

    <div class="step" id="step-3">
      <div class="step-badge">3</div>
      <div class="step-content">
        <h3>Ukupna povrsina valjka</h3>
        <p>Povrsina valjka se sastoji od dve osnove (krugovi) i omotaca:</p>
        <div class="math-box">
          \[ P_v = 2\pi r^2 + 2\pi r h \]
        </div>
        <p>Uvrstimo \(r = \dfrac{3h}{4}\):</p>
        <div class="math-box">
          \[ P_v = 2\pi \cdot \frac{9h^2}{16} + 2\pi \cdot \frac{3h}{4} \cdot h \]
        </div>
        <div class="math-box">
          \[ P_v = \frac{18\pi h^2}{16} + \frac{6\pi h^2}{4} = \frac{9\pi h^2}{8} + \frac{12\pi h^2}{8} \]
        </div>
        <div class="math-box">
          \[ \boxed{P_v = \frac{21\pi h^2}{8}} \]
        </div>
      </div>
    </div>

    <div class="step" id="step-4">
      <div class="step-badge">4</div>
      <div class="step-content">
        <h3>Ukupna povrsina kupe</h3>
        <p>Povrsina kupe se sastoji od osnove (krug) i omotaca:</p>
        <div class="math-box">
          \[ P_k = \pi r^2 + \pi r l \]
        </div>
        <p>Uvrstimo \(r = \dfrac{3h}{4}\) i \(l = \dfrac{5h}{4}\):</p>
        <div class="math-box">
          \[ P_k = \pi \cdot \frac{9h^2}{16} + \pi \cdot \frac{3h}{4} \cdot \frac{5h}{4} \]
        </div>
        <div class="math-box">
          \[ P_k = \frac{9\pi h^2}{16} + \frac{15\pi h^2}{16} = \frac{24\pi h^2}{16} \]
        </div>
        <div class="math-box">
          \[ \boxed{P_k = \frac{3\pi h^2}{2} = \frac{12\pi h^2}{8}} \]
        </div>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri se: Da li se vrednosti za \(P_v\) i \(P_k\) mogu pojednostaviti?</summary>
      <p>Da! Svedemo na zajednicki imenilac 8: \(P_v = \dfrac{21\pi h^2}{8}\) i \(P_k = \dfrac{12\pi h^2}{8}\). Oba clana sadrze zajednicki faktor \(\dfrac{\pi h^2}{8}\), pa je odnos jednostavno \(21 : 12\). &check;</p>
    </details>

    <div class="step" id="step-5">
      <div class="step-badge">5</div>
      <div class="step-content">
        <h3>Racunanje odnosa povrsina</h3>
        <p>Formiramo odnos:</p>
        <div class="math-box">
          \[ P_v : P_k = \frac{21\pi h^2}{8} : \frac{12\pi h^2}{8} \]
        </div>
        <p>Skracujemo zajednicki faktor \(\dfrac{\pi h^2}{8}\):</p>
        <div class="math-box">
          \[ P_v : P_k = 21 : 12 \]
        </div>
        <p>Delimo oba clana sa \(\text{NZD}(21,\, 12) = 3\):</p>
        <div class="math-box">
          \[ \boxed{P_v : P_k = 7 : 4} \]
        </div>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri se numerickim primerom: Neka je \(h = 4\)</summary>
      <p>Ako je \(h = 4\), onda je \(r = 3\) i \(l = 5\).</p>
      <p>\(P_v = 2\pi \cdot 9 + 2\pi \cdot 3 \cdot 4 = 18\pi + 24\pi = 42\pi\).</p>
      <p>\(P_k = \pi \cdot 9 + \pi \cdot 3 \cdot 5 = 9\pi + 15\pi = 24\pi\).</p>
      <p>\(P_v : P_k = 42\pi : 24\pi = 42 : 24 = 7 : 4\). Potvrdjeno! &check;</p>
    </details>
  </div>

  <!-- Key Insight -->
  <div class="card insight-card">
    <h2>Kljucni uvid</h2>
    <p>Odnos \(h : l = 4 : 5\) u kombinaciji sa Pitagorinom teoremom (\(l^2 = r^2 + h^2\)) daje poznatu <span class="highlight">Pitagorinu trojku \(3 : 4 : 5\)</span> za dimenzije \(r : h : l\). To drasticno pojednostavljuje racun, jer se sve velicine izrazavaju preko jednog parametra \(h\). Kljuc je prepoznati da visina kupe jednaka visini valjka (vrh kupe je centar suprotne osnove).</p>
    <div class="math-box" style="text-align: center; font-size: 1.2rem;">
      \[ r : h : l = 3 : 4 : 5 \quad \Longrightarrow \quad P_v : P_k = 7 : 4 \]
    </div>
  </div>

  <!-- Final Answer -->
  <div class="card final-answer">
    <h2>Konacan odgovor</h2>
    <div class="answer-big">\(P_v : P_k = 7 : 4\)</div>

    <div class="options-row">
      <div class="option-box">
        <div class="opt-label">(A)</div>
        <div class="opt-value">\(3 : 2\)</div>
      </div>
      <div class="option-box">
        <div class="opt-label">(B)</div>
        <div class="opt-value">\(7 : 5\)</div>
      </div>
      <div class="option-box">
        <div class="opt-label">(C)</div>
        <div class="opt-value">\(4 : 3\)</div>
      </div>
      <div class="option-box">
        <div class="opt-label">(D)</div>
        <div class="opt-value">\(8 : 5\)</div>
      </div>
      <div class="option-box correct">
        <div class="opt-label">(E)</div>
        <div class="opt-value">\(7 : 4\)</div>
      </div>
    </div>

    <p class="verification"><strong>Provera:</strong> Za \(h = 4\): \(r = 3\), \(l = 5\). Povrsina valjka: \(2\pi(9) + 2\pi(3)(4) = 42\pi\). Povrsina kupe: \(\pi(9) + \pi(3)(5) = 24\pi\). Odnos: \(42 : 24 = 7 : 4\). &check;</p>
  </div>

  <!-- Common Pitfalls -->
  <div class="card">
    <h2>Ceste greske</h2>
    <ul class="pitfall-list">
      <li><strong>Zaboravljena osnova kupe:</strong> Povrsina kupe je \(\pi r^2 + \pi r l\), ne samo omotac \(\pi r l\). Ukupna povrsina uvek ukljucuje i osnovu.</li>
      <li><strong>Brkanje visine kupe i izvodnice:</strong> Izvodnica \(l\) je kosina strana kupe (hipotenuza), a \(h\) je visina (kateta). Veza izmedju njih je \(l^2 = r^2 + h^2\), a ne \(l = h\).</li>
      <li><strong>Pogresan zakljucak o visini kupe:</strong> Posto je vrh kupe centar druge osnove valjka, visina kupe je <em>jednaka</em> visini valjka. Neki ucenici pogresno uzimaju da je visina kupe razlicita od \(h\).</li>
      <li><strong>Nepotpuna povrsina valjka:</strong> Valjak ima <em>dve</em> osnove (\(2\pi r^2\)) plus omotac (\(2\pi rh\)). Cesta greska je racunanje sa samo jednom osnovom.</li>
    </ul>
  </div>

  <!-- Optional Challenge -->
  <div class="card challenge-card">
    <h2>Dodatni izazov</h2>
    <p>Za isti valjak i kupu iz zadatka, odredite odnos <em>zapremina</em> valjka i kupe.</p>
    <details>
      <summary>Pomoc i resenje</summary>
      <p>Zapremina valjka: \(V_v = \pi r^2 h = \pi \cdot \dfrac{9h^2}{16} \cdot h = \dfrac{9\pi h^3}{16}\).</p>
      <p>Zapremina kupe: \(V_k = \dfrac{1}{3}\pi r^2 h = \dfrac{1}{3} \cdot \pi \cdot \dfrac{9h^2}{16} \cdot h = \dfrac{3\pi h^3}{16}\).</p>
      <p>Odnos: \(V_v : V_k = \dfrac{9\pi h^3}{16} : \dfrac{3\pi h^3}{16} = 9 : 3 = 3 : 1\).</p>
      <p>Ovo je ocekivano, jer valjak i kupa imaju istu osnovu i visinu, a zapremina kupe je uvek tacno \(\frac{1}{3}\) zapremine odgovarajuceg valjka.</p>
    </details>
  </div>

</div>

<script>
(() => {
  const canvas = document.getElementById('scene-canvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const W = canvas.width;
  const H = canvas.height;

  // 3D parameters
  let angle = 0.6; // rotation angle around Y axis
  let isDragging = false;
  let lastX = 0;

  // Cylinder and cone dimensions (r:h:l = 3:4:5)
  const r = 120;  // radius in pixels
  const h = 160;  // height in pixels

  // 3D projection (isometric-like)
  const cx = W / 2;
  const cy = H / 2 + 20;
  const tiltAngle = 0.45; // tilt for 3D view

  function project3D(x, y, z) {
    // Rotate around Y axis
    var rx = x * Math.cos(angle) - z * Math.sin(angle);
    var rz = x * Math.sin(angle) + z * Math.cos(angle);
    // Simple perspective tilt
    var py = y * Math.cos(tiltAngle) - rz * Math.sin(tiltAngle);
    var pz = y * Math.sin(tiltAngle) + rz * Math.cos(tiltAngle);
    return { x: cx + rx, y: cy - py };
  }

  function drawEllipse(yPos, radius, color, lineWidth, dashed, fillColor) {
    ctx.save();
    ctx.strokeStyle = color;
    ctx.lineWidth = lineWidth;
    if (dashed) ctx.setLineDash([6, 4]);
    else ctx.setLineDash([]);

    var pts = [];
    for (var i = 0; i <= 72; i++) {
      var theta = (i / 72) * Math.PI * 2;
      var ex = radius * Math.cos(theta);
      var ez = radius * Math.sin(theta);
      pts.push(project3D(ex, yPos, ez));
    }

    if (fillColor) {
      ctx.fillStyle = fillColor;
      ctx.beginPath();
      ctx.moveTo(pts[0].x, pts[0].y);
      for (var i = 1; i < pts.length; i++) {
        ctx.lineTo(pts[i].x, pts[i].y);
      }
      ctx.closePath();
      ctx.fill();
    }

    ctx.beginPath();
    ctx.moveTo(pts[0].x, pts[0].y);
    for (var i = 1; i < pts.length; i++) {
      ctx.lineTo(pts[i].x, pts[i].y);
    }
    ctx.closePath();
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.restore();
  }

  function drawHalfEllipse(yPos, radius, color, lineWidth, topHalf) {
    ctx.save();
    ctx.strokeStyle = color;
    ctx.lineWidth = lineWidth;
    ctx.setLineDash([5, 4]);

    var start = topHalf ? 0 : 36;
    var end = topHalf ? 36 : 72;
    var pts = [];
    for (var i = 0; i <= 72; i++) {
      var theta = (i / 72) * Math.PI * 2;
      var ex = radius * Math.cos(theta);
      var ez = radius * Math.sin(theta);
      pts.push(project3D(ex, yPos, ez));
    }

    ctx.beginPath();
    ctx.moveTo(pts[start].x, pts[start].y);
    for (var i = start + 1; i <= end; i++) {
      ctx.lineTo(pts[i].x, pts[i].y);
    }
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.restore();
  }

  function draw() {
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    var bottomY = -h / 2;
    var topY = h / 2;

    // --- Draw cylinder body (vertical lines around) ---
    var numLines = 48;
    // Determine front/back for each line
    for (var i = 0; i < numLines; i++) {
      var theta = (i / numLines) * Math.PI * 2;
      var ex = r * Math.cos(theta);
      var ez = r * Math.sin(theta);
      var p1 = project3D(ex, bottomY, ez);
      var p2 = project3D(ex, topY, ez);

      // Check if this is a "back" line (behind the center)
      var rotZ = ex * Math.sin(angle) + ez * Math.cos(angle);
      if (rotZ < 0) {
        // Back side - draw dashed and dimmer
        ctx.strokeStyle = 'rgba(96,165,250,0.12)';
        ctx.lineWidth = 0.5;
        ctx.setLineDash([3, 3]);
        ctx.beginPath();
        ctx.moveTo(p1.x, p1.y);
        ctx.lineTo(p2.x, p2.y);
        ctx.stroke();
        ctx.setLineDash([]);
      }
    }

    // Draw bottom ellipse (shared base) filled
    drawEllipse(bottomY, r, '#60a5fa', 2.5, false, 'rgba(96,165,250,0.08)');

    // --- Draw cone surface (triangular lines from base to apex) ---
    var apex = project3D(0, topY, 0);
    for (var i = 0; i < numLines; i++) {
      var theta = (i / numLines) * Math.PI * 2;
      var ex = r * Math.cos(theta);
      var ez = r * Math.sin(theta);
      var pb = project3D(ex, bottomY, ez);

      var rotZ = ex * Math.sin(angle) + ez * Math.cos(angle);
      if (rotZ < 0) {
        // Back side of cone
        ctx.strokeStyle = 'rgba(251,146,60,0.1)';
        ctx.lineWidth = 0.5;
        ctx.setLineDash([3, 3]);
        ctx.beginPath();
        ctx.moveTo(pb.x, pb.y);
        ctx.lineTo(apex.x, apex.y);
        ctx.stroke();
        ctx.setLineDash([]);
      }
    }

    // Draw front cone lines
    for (var i = 0; i < numLines; i++) {
      var theta = (i / numLines) * Math.PI * 2;
      var ex = r * Math.cos(theta);
      var ez = r * Math.sin(theta);
      var pb = project3D(ex, bottomY, ez);

      var rotZ = ex * Math.sin(angle) + ez * Math.cos(angle);
      if (rotZ >= 0) {
        ctx.strokeStyle = 'rgba(251,146,60,0.15)';
        ctx.lineWidth = 0.7;
        ctx.beginPath();
        ctx.moveTo(pb.x, pb.y);
        ctx.lineTo(apex.x, apex.y);
        ctx.stroke();
      }
    }

    // Draw front cylinder lines
    for (var i = 0; i < numLines; i++) {
      var theta = (i / numLines) * Math.PI * 2;
      var ex = r * Math.cos(theta);
      var ez = r * Math.sin(theta);
      var p1 = project3D(ex, bottomY, ez);
      var p2 = project3D(ex, topY, ez);
      var rotZ = ex * Math.sin(angle) + ez * Math.cos(angle);
      if (rotZ >= 0) {
        ctx.strokeStyle = 'rgba(96,165,250,0.15)';
        ctx.lineWidth = 0.7;
        ctx.beginPath();
        ctx.moveTo(p1.x, p1.y);
        ctx.lineTo(p2.x, p2.y);
        ctx.stroke();
      }
    }

    // Draw two prominent silhouette lines for cylinder
    // Left and right visible edges
    var leftTheta = angle + Math.PI / 2;
    var rightTheta = angle - Math.PI / 2;

    var eL = project3D(r * Math.cos(leftTheta), bottomY, r * Math.sin(leftTheta));
    var eLt = project3D(r * Math.cos(leftTheta), topY, r * Math.sin(leftTheta));
    var eR = project3D(r * Math.cos(rightTheta), bottomY, r * Math.sin(rightTheta));
    var eRt = project3D(r * Math.cos(rightTheta), topY, r * Math.sin(rightTheta));

    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2.5;
    ctx.beginPath();
    ctx.moveTo(eL.x, eL.y);
    ctx.lineTo(eLt.x, eLt.y);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(eR.x, eR.y);
    ctx.lineTo(eRt.x, eRt.y);
    ctx.stroke();

    // Draw two prominent silhouette lines for cone
    ctx.strokeStyle = '#fb923c';
    ctx.lineWidth = 2.5;
    ctx.beginPath();
    ctx.moveTo(eL.x, eL.y);
    ctx.lineTo(apex.x, apex.y);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(eR.x, eR.y);
    ctx.lineTo(apex.x, apex.y);
    ctx.stroke();

    // Draw top ellipse of cylinder
    drawEllipse(topY, r, '#60a5fa', 2.5, false, 'rgba(96,165,250,0.05)');

    // Draw apex point
    ctx.fillStyle = '#fb923c';
    ctx.beginPath();
    ctx.arc(apex.x, apex.y, 5, 0, Math.PI * 2);
    ctx.fill();
    ctx.strokeStyle = '#0c1222';
    ctx.lineWidth = 1.5;
    ctx.stroke();

    // --- Dimension annotations ---
    // Height line (h) on the left side
    var dimOffset = -r - 40;
    var hBot = project3D(dimOffset, bottomY, 0);
    var hTop = project3D(dimOffset, topY, 0);

    ctx.strokeStyle = '#4ade80';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(hBot.x, hBot.y);
    ctx.lineTo(hTop.x, hTop.y);
    ctx.stroke();
    // Arrow heads
    drawArrow(ctx, hBot.x, hBot.y, hTop.x, hTop.y, '#4ade80');

    ctx.fillStyle = '#4ade80';
    ctx.font = 'bold 16px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'right';
    var hMid = project3D(dimOffset - 10, 0, 0);
    ctx.fillText('h', hMid.x - 4, hMid.y + 5);

    // Radius line (r) at the bottom
    var centerBot = project3D(0, bottomY, 0);
    var edgeBot = project3D(r, bottomY, 0);

    ctx.strokeStyle = '#a78bfa';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(centerBot.x, centerBot.y);
    ctx.lineTo(edgeBot.x, edgeBot.y);
    ctx.stroke();

    ctx.fillStyle = '#a78bfa';
    ctx.font = 'bold 16px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    var rMid = project3D(r / 2, bottomY - 16, 0);
    ctx.fillText('r', rMid.x, rMid.y);

    // Slant height line (l) - from base edge to apex
    var slantBase = project3D(r * Math.cos(rightTheta), bottomY, r * Math.sin(rightTheta));
    ctx.strokeStyle = '#fb923c';
    ctx.lineWidth = 2;
    ctx.setLineDash([6, 4]);
    ctx.beginPath();
    ctx.moveTo(slantBase.x, slantBase.y);
    ctx.lineTo(apex.x, apex.y);
    ctx.stroke();
    ctx.setLineDash([]);

    // Label l
    ctx.fillStyle = '#fb923c';
    ctx.font = 'bold 16px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    var lMidX = (slantBase.x + apex.x) / 2;
    var lMidY = (slantBase.y + apex.y) / 2;
    ctx.fillText('l', lMidX + 12, lMidY);

    // Center dot at bottom
    ctx.fillStyle = '#e2e8f0';
    ctx.beginPath();
    ctx.arc(centerBot.x, centerBot.y, 3, 0, Math.PI * 2);
    ctx.fill();

    // --- Labels ---
    ctx.fillStyle = '#60a5fa';
    ctx.font = 'bold 15px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('Valjak', eRt.x + 10, eRt.y);

    ctx.fillStyle = '#fb923c';
    ctx.font = 'bold 15px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('Kupa', apex.x + 12, apex.y - 8);

    // Apex label
    ctx.fillStyle = '#94a3b8';
    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.fillText('Vrh kupe = centar', apex.x + 12, apex.y + 10);
    ctx.fillText('gornje osnove', apex.x + 12, apex.y + 26);

    // Ratio info box
    ctx.fillStyle = '#1e293b';
    var boxX = 16, boxY = H - 110, boxW = 200, boxH = 95;
    ctx.fillRect(boxX, boxY, boxW, boxH);
    ctx.strokeStyle = '#334155';
    ctx.lineWidth = 1;
    ctx.strokeRect(boxX, boxY, boxW, boxH);

    ctx.fillStyle = '#e2e8f0';
    ctx.font = 'bold 14px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('Dimenzije (r : h : l)', boxX + 10, boxY + 22);
    ctx.fillStyle = '#f472b6';
    ctx.font = 'bold 16px Segoe UI, system-ui, sans-serif';
    ctx.fillText('3 : 4 : 5', boxX + 10, boxY + 46);
    ctx.fillStyle = '#94a3b8';
    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.fillText('Pitagorina trojka!', boxX + 10, boxY + 66);
    ctx.fillStyle = '#4ade80';
    ctx.font = 'bold 14px Segoe UI, system-ui, sans-serif';
    ctx.fillText('P\u1D65 : P\u2096 = 7 : 4', boxX + 10, boxY + 86);
  }

  function drawArrow(ctx, x1, y1, x2, y2, color) {
    var headLen = 8;
    var dx = x2 - x1;
    var dy = y2 - y1;
    var ang = Math.atan2(dy, dx);

    ctx.fillStyle = color;
    // Arrow at top
    ctx.beginPath();
    ctx.moveTo(x2, y2);
    ctx.lineTo(x2 - headLen * Math.cos(ang - Math.PI / 6), y2 - headLen * Math.sin(ang - Math.PI / 6));
    ctx.lineTo(x2 - headLen * Math.cos(ang + Math.PI / 6), y2 - headLen * Math.sin(ang + Math.PI / 6));
    ctx.closePath();
    ctx.fill();
    // Arrow at bottom
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x1 + headLen * Math.cos(ang - Math.PI / 6), y1 + headLen * Math.sin(ang - Math.PI / 6));
    ctx.lineTo(x1 + headLen * Math.cos(ang + Math.PI / 6), y1 + headLen * Math.sin(ang + Math.PI / 6));
    ctx.closePath();
    ctx.fill();
  }

  draw();

  // Mouse drag to rotate
  function getPointerX(e) {
    var rect = canvas.getBoundingClientRect();
    var scaleX = W / rect.width;
    return (e.clientX - rect.left) * scaleX;
  }

  function getTouchX(e) {
    var rect = canvas.getBoundingClientRect();
    var scaleX = W / rect.width;
    return (e.touches[0].clientX - rect.left) * scaleX;
  }

  canvas.addEventListener('mousedown', function(e) {
    isDragging = true;
    lastX = getPointerX(e);
  });

  canvas.addEventListener('mousemove', function(e) {
    if (!isDragging) return;
    var mx = getPointerX(e);
    var dx = mx - lastX;
    angle += dx * 0.005;
    lastX = mx;
    draw();
  });

  canvas.addEventListener('mouseup', function() { isDragging = false; });
  canvas.addEventListener('mouseleave', function() { isDragging = false; });

  canvas.addEventListener('touchstart', function(e) {
    e.preventDefault();
    isDragging = true;
    lastX = getTouchX(e);
  });

  canvas.addEventListener('touchmove', function(e) {
    e.preventDefault();
    if (!isDragging) return;
    var tx = getTouchX(e);
    var dx = tx - lastX;
    angle += dx * 0.005;
    lastX = tx;
    draw();
  });

  canvas.addEventListener('touchend', function() { isDragging = false; });

  // Step click interactivity
  var steps = document.querySelectorAll('.step');
  steps.forEach(function(step) {
    step.addEventListener('click', function() {
      steps.forEach(function(s) { s.classList.remove('active'); });
      step.classList.add('active');
    });
  });
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Odnos povrsina valjka i kupe",
  "subject": "math",
  "unit": "stereometrija",
  "topic_tags": ["stereometrija", "povrsina valjka", "povrsina kupe", "Pitagorina teorema", "rotaciona tela", "odnos povrsina"]
}
BRAINSPARK_META-->