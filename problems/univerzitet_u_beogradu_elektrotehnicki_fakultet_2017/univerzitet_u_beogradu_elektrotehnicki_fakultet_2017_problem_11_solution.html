<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zbir prvih 160 članova aritmetičke progresije</title>
<script type="text/info" id="logic-scratchpad">
Problem: U aritmetičkoj progresiji poznati su a_54 = α i a_70 = β (α, β ∈ R, α ≠ β).
Naći zbir prvih 160 članova.

Opšti član aritmetičke progresije: a_n = a_1 + (n-1)d

Korak 1: Postaviti sistem jednačina
  a_54 = a_1 + 53d = α   ... (1)
  a_70 = a_1 + 69d = β   ... (2)

Korak 2: Naći razliku d
  (2) - (1): 16d = β - α
  d = (β - α) / 16

Korak 3: Naći a_1
  Iz (1): a_1 = α - 53d = α - 53·(β - α)/16
  a_1 = (16α - 53β + 53α) / 16 = (69α - 53β) / 16

Korak 4: Izračunati S_160
  S_n = n/2 · (2a_1 + (n-1)d)
  S_160 = 160/2 · (2a_1 + 159d) = 80 · (2a_1 + 159d)

  2a_1 = 2 · (69α - 53β)/16 = (138α - 106β)/16
  159d = 159 · (β - α)/16 = (159β - 159α)/16

  2a_1 + 159d = (138α - 106β + 159β - 159α) / 16
              = (-21α + 53β) / 16

  S_160 = 80 · (-21α + 53β) / 16 = 5(-21α + 53β)

Korak 5: Provera odgovora
  S_160 = 5(-21α + 53β) = -105α + 265β

  Provera opcija:
  (A) 85α + 75β → ne odgovara
  (B) 5(-19α + 51β + 32) = -95α + 255β + 160 → ne odgovara (ima konstantu 160, a ne bi smelo)
  (C) 3(37α - 62β)/5 = (111α - 186β)/5 → ne odgovara
  (D) 5(-21α + 53β) = -105α + 265β → ODGOVARA ✓
  (E) 75(-11α + 43β)/16 = (-825α + 3225β)/16 → ne odgovara

Odgovor: (D)

Dodatna provera sa konkretnim brojevima:
  Neka je a_1 = 1, d = 2.
  a_54 = 1 + 53·2 = 107 = α
  a_70 = 1 + 69·2 = 139 = β
  S_160 = 160/2 · (2·1 + 159·2) = 80 · (2 + 318) = 80 · 320 = 25600

  (D): 5(-21·107 + 53·139) = 5(-2247 + 7367) = 5·5120 = 25600 ✓ Tačno!
</script>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  font-size: 2.2rem;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
  line-height: 1.3;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 32px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.4rem;
  margin-bottom: 16px;
}

.card h3 {
  color: #e2e8f0;
  font-size: 1.15rem;
  margin-bottom: 10px;
}

.highlight {
  color: #f472b6;
  font-weight: 600;
}

.math-box {
  background: rgba(56,189,248,0.08);
  border: 1px solid rgba(56,189,248,0.15);
  border-radius: 8px;
  padding: 14px 18px;
  margin: 12px 0;
  font-family: 'Courier New', monospace;
  font-size: 1.05rem;
  overflow-x: auto;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.given-item {
  background: rgba(96,165,250,0.08);
  border: 1px solid rgba(96,165,250,0.18);
  border-radius: 10px;
  padding: 12px 18px;
  min-width: 80px;
  text-align: center;
  transition: transform 0.2s, border-color 0.2s;
}

.given-item:hover {
  transform: translateY(-2px);
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-bottom: 4px;
}

.given-item .value {
  color: #e2e8f0;
  font-size: 1.1rem;
  font-weight: 600;
}

.answer-option {
  cursor: default;
}

/* Plan card */
.plan-card {
  border-left: 3px solid #a78bfa;
}

.plan-card h2 {
  color: #a78bfa;
}

/* Details/collapsible */
details {
  margin: 15px 0;
  background: rgba(167,139,250,0.06);
  border: 1px solid rgba(167,139,250,0.15);
  border-radius: 10px;
  padding: 14px 18px;
}

details summary {
  cursor: pointer;
  color: #a78bfa;
  font-weight: 600;
  font-size: 1.05rem;
  user-select: none;
}

details summary:hover {
  color: #c4b5fd;
}

details[open] summary {
  margin-bottom: 12px;
}

details ul {
  list-style: none;
  padding-left: 0;
}

details li {
  padding: 6px 0;
  border-bottom: 1px solid rgba(51,65,85,0.5);
  color: #e2e8f0;
}

details li:last-child {
  border-bottom: none;
}

/* Canvas card */
.canvas-card {
  text-align: center;
}

.canvas-card canvas {
  width: 100%;
  max-width: 700px;
  border-radius: 10px;
  border: 1px solid #334155;
  touch-action: none;
}

.drag-hint {
  color: #64748b;
  font-size: 0.85rem;
  margin-top: 8px;
  font-style: italic;
}

/* Steps */
.step {
  display: flex;
  gap: 16px;
  padding: 16px;
  border-radius: 10px;
  margin-bottom: 14px;
  border-left: 3px solid transparent;
  transition: border-color 0.2s, background 0.2s;
  cursor: pointer;
}

.step:hover, .step.active {
  border-left-color: #4ade80;
  background: rgba(74,222,128,0.04);
}

.step-badge {
  flex-shrink: 0;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  color: #fff;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.95rem;
}

.step-content {
  flex: 1;
}

.step-content p {
  color: #94a3b8;
  margin-top: 6px;
}

/* Checkpoint */
.checkpoint {
  background: rgba(52,211,153,0.06);
  border: 1px solid rgba(52,211,153,0.18);
}

.checkpoint summary {
  color: #34d399;
}

/* Key insight */
.insight-card {
  background: linear-gradient(135deg, rgba(96,165,250,0.1), rgba(167,139,250,0.1));
  border: 1px solid rgba(167,139,250,0.25);
}

.insight-card h2 {
  color: #a78bfa;
}

/* Final answer */
.final-answer {
  border: 2px solid rgba(74,222,128,0.3);
  background: linear-gradient(135deg, rgba(74,222,128,0.06), rgba(52,211,153,0.04));
}

.final-answer h2 {
  color: #4ade80;
}

.answer-big {
  font-size: 1.6rem;
  font-weight: 700;
  color: #4ade80;
  text-align: center;
  margin: 20px 0;
}

.options-row {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  margin: 16px 0;
}

.option-box {
  padding: 10px 20px;
  border-radius: 10px;
  border: 2px solid #334155;
  background: #1e293b;
  text-align: center;
  min-width: 90px;
  transition: transform 0.2s;
}

.option-box.correct {
  border-color: #4ade80;
  background: rgba(74,222,128,0.1);
  transform: scale(1.05);
}

.option-box .opt-label {
  color: #94a3b8;
  font-size: 0.85rem;
}

.option-box .opt-value {
  font-size: 1.15rem;
  font-weight: 600;
  color: #e2e8f0;
}

.option-box.correct .opt-value {
  color: #4ade80;
}

.verification {
  color: #94a3b8;
  font-size: 0.95rem;
  margin-top: 14px;
  padding-top: 14px;
  border-top: 1px solid #334155;
}

/* Pitfalls */
.pitfall-list {
  list-style: none;
  padding: 0;
}

.pitfall-list li {
  padding: 10px 14px;
  margin-bottom: 8px;
  background: rgba(224,148,104,0.06);
  border-left: 3px solid #e09468;
  border-radius: 0 8px 8px 0;
  color: #e2e8f0;
}

.pitfall-list li strong {
  color: #e09468;
}

/* Challenge */
.challenge-card {
  border: 1px solid rgba(244,114,182,0.2);
  background: rgba(244,114,182,0.04);
}

.challenge-card h2 {
  color: #f472b6;
}

@media (max-width: 700px) {
  h1 { font-size: 1.6rem; }
  .card { padding: 16px; }
  .step { flex-direction: column; gap: 10px; }
  .given-grid { flex-direction: column; }
  .options-row { flex-direction: column; align-items: center; }
}
</style>
</head>
<body>
<div class="container">

  <h1>Zbir članova aritmetičke progresije</h1>
  <p class="subtitle">Algebra: aritmetička progresija, opšti član, formula za zbir prvih n članova</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <h2>Postavka zadatka</h2>
    <p>U aritmetičkoj progresiji poznati su članovi \(a_{54} = \alpha\) i \(a_{70} = \beta\), gde su \(\alpha, \beta \in \mathbb{R}\), \(\alpha \neq \beta\). Tada je zbir prvih 160 članova te progresije jednak:</p>

    <div class="given-grid" style="margin-bottom: 18px;">
      <div class="given-item">
        <div class="label">Poznati član</div>
        <div class="value">\(a_{54} = \alpha\)</div>
      </div>
      <div class="given-item">
        <div class="label">Poznati član</div>
        <div class="value">\(a_{70} = \beta\)</div>
      </div>
      <div class="given-item">
        <div class="label">Traži se</div>
        <div class="value">\(S_{160}\)</div>
      </div>
    </div>

    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\(85\alpha + 75\beta\)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\(5(-19\alpha + 51\beta + 32)\)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\(\dfrac{3(37\alpha - 62\beta)}{5}\)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\(5(-21\alpha + 53\beta)\)</div>
      </div>
      <div class="given-item answer-option" data-option="E">
        <div class="label">(E)</div>
        <div class="value">\(\dfrac{75(-11\alpha + 43\beta)}{16}\)</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card plan-card">
    <h2>Plan rešavanja</h2>
    <p>Iz dva poznata člana aritmetičke progresije izrazićemo prvi član \(a_1\) i razliku \(d\) preko \(\alpha\) i \(\beta\), a zatim ćemo primeniti formulu za zbir prvih \(n\) članova. Na kraju ćemo rezultat proveriti uvrštavanjem konkretnih brojeva.</p>
  </div>

  <!-- Theory Refresher -->
  <details>
    <summary>Ključne formule i teoreme</summary>
    <ul>
      <li><strong>Opšti član aritmetičke progresije:</strong> \(a_n = a_1 + (n-1)d\), gde je \(a_1\) prvi član, a \(d\) razlika progresije.</li>
      <li><strong>Zbir prvih \(n\) članova:</strong> \(\displaystyle S_n = \frac{n}{2}\bigl(2a_1 + (n-1)d\bigr)\)</li>
      <li><strong>Alternativna formula za zbir:</strong> \(\displaystyle S_n = \frac{n}{2}(a_1 + a_n)\), gde je \(a_n\) poslednji član.</li>
      <li><strong>Izražavanje parametara iz dva člana:</strong> Ako su poznati \(a_m\) i \(a_k\) (za \(m \neq k\)), tada je \(\displaystyle d = \frac{a_k - a_m}{k - m}\) i \(a_1 = a_m - (m-1)d\).</li>
    </ul>
  </details>

  <!-- Canvas Visualization -->
  <div class="card canvas-card">
    <h2>Vizuelni prikaz: Aritmetička progresija</h2>
    <p style="color:#94a3b8; margin-bottom: 14px;">Dijagram prikazuje članove progresije sa poznatim članovima \(a_{54}\) i \(a_{70}\) i zbir prvih 160 članova</p>
    <canvas id="viz-canvas" width="700" height="420"></canvas>
    <p class="drag-hint">Koristite klizač ispod za promenu razlike d i posmatrajte kako se menja zbir</p>
    <div style="margin-top: 12px; display: flex; align-items: center; justify-content: center; gap: 12px;">
      <span style="color: #94a3b8; font-size: 0.9rem;">Razlika \(d\):</span>
      <input type="range" id="d-slider" min="-30" max="30" value="5" step="1" style="width: 200px; accent-color: #60a5fa;">
      <span id="d-value" style="color: #60a5fa; font-weight: 600; min-width: 40px;">5</span>
    </div>
  </div>

  <!-- Step-by-step solution -->
  <div class="card">
    <h2>Rešenje korak po korak</h2>

    <div class="step" id="step-1">
      <div class="step-badge">1</div>
      <div class="step-content">
        <h3>Zapisujemo poznate članove pomoću formule za opšti član</h3>
        <p>Opšti član aritmetičke progresije je \(a_n = a_1 + (n-1)d\). Primenjujemo ovu formulu na dato:</p>
        <div class="math-box">
          \[ a_{54} = a_1 + 53d = \alpha \quad \cdots (1) \]
        </div>
        <div class="math-box">
          \[ a_{70} = a_1 + 69d = \beta \quad \cdots (2) \]
        </div>
      </div>
    </div>

    <div class="step" id="step-2">
      <div class="step-badge">2</div>
      <div class="step-content">
        <h3>Nalazimo razliku \(d\)</h3>
        <p>Oduzimamo jednačinu (1) od jednačine (2) da eliminišemo \(a_1\):</p>
        <div class="math-box">
          \[ (a_1 + 69d) - (a_1 + 53d) = \beta - \alpha \]
        </div>
        <div class="math-box">
          \[ 16d = \beta - \alpha \]
        </div>
        <p>Odavde dobijamo:</p>
        <div class="math-box">
          \[ d = \frac{\beta - \alpha}{16} \]
        </div>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri se: Zašto je razlika indeksa baš 16?</summary>
      <p>Razlika indeksa je \(70 - 54 = 16\). Zato pri oduzimanju jednačina (2) i (1) ostaje \(16d\), jer se \(a_1\) poništi, a od \(69d - 53d = 16d\).</p>
    </details>

    <div class="step" id="step-3">
      <div class="step-badge">3</div>
      <div class="step-content">
        <h3>Nalazimo prvi član \(a_1\)</h3>
        <p>Iz jednačine (1) izražavamo \(a_1\):</p>
        <div class="math-box">
          \[ a_1 = \alpha - 53d = \alpha - 53 \cdot \frac{\beta - \alpha}{16} \]
        </div>
        <p>Svodimo na zajednički imenilac:</p>
        <div class="math-box">
          \[ a_1 = \frac{16\alpha - 53(\beta - \alpha)}{16} = \frac{16\alpha - 53\beta + 53\alpha}{16} \]
        </div>
        <div class="math-box">
          \[ a_1 = \frac{69\alpha - 53\beta}{16} \]
        </div>
      </div>
    </div>

    <div class="step" id="step-4">
      <div class="step-badge">4</div>
      <div class="step-content">
        <h3>Primenjujemo formulu za zbir \(S_{160}\)</h3>
        <p>Formula za zbir prvih \(n\) članova aritmetičke progresije glasi:</p>
        <div class="math-box">
          \[ S_n = \frac{n}{2}\bigl(2a_1 + (n-1)d\bigr) \]
        </div>
        <p>Za \(n = 160\):</p>
        <div class="math-box">
          \[ S_{160} = \frac{160}{2}\bigl(2a_1 + 159d\bigr) = 80\bigl(2a_1 + 159d\bigr) \]
        </div>
      </div>
    </div>

    <div class="step" id="step-5">
      <div class="step-badge">5</div>
      <div class="step-content">
        <h3>Računamo izraz \(2a_1 + 159d\)</h3>
        <p>Zamenjujemo dobijene vrednosti za \(a_1\) i \(d\):</p>
        <div class="math-box">
          \[ 2a_1 = 2 \cdot \frac{69\alpha - 53\beta}{16} = \frac{138\alpha - 106\beta}{16} \]
        </div>
        <div class="math-box">
          \[ 159d = 159 \cdot \frac{\beta - \alpha}{16} = \frac{159\beta - 159\alpha}{16} \]
        </div>
        <p>Sabiramo, pošto imaju isti imenilac:</p>
        <div class="math-box">
          \[ 2a_1 + 159d = \frac{138\alpha - 106\beta + 159\beta - 159\alpha}{16} \]
        </div>
        <div class="math-box">
          \[ = \frac{(138 - 159)\alpha + (-106 + 159)\beta}{16} = \frac{-21\alpha + 53\beta}{16} \]
        </div>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri se: Koliko je \(138 - 159\) i \(-106 + 159\)?</summary>
      <p>\(138 - 159 = -21\) i \(-106 + 159 = 53\). Koeficijenti u brojiocu su \(-21\) uz \(\alpha\) i \(53\) uz \(\beta\).</p>
    </details>

    <div class="step" id="step-6">
      <div class="step-badge">6</div>
      <div class="step-content">
        <h3>Izračunavamo konačan zbir \(S_{160}\)</h3>
        <p>Množimo sa 80:</p>
        <div class="math-box">
          \[ S_{160} = 80 \cdot \frac{-21\alpha + 53\beta}{16} \]
        </div>
        <p>Skraćujemo \(\frac{80}{16} = 5\):</p>
        <div class="math-box">
          \[ S_{160} = 5(-21\alpha + 53\beta) \]
        </div>
      </div>
    </div>

    <div class="step" id="step-7">
      <div class="step-badge">7</div>
      <div class="step-content">
        <h3>Provera uvrštavanjem konkretnih vrednosti</h3>
        <p>Neka je \(a_1 = 1\) i \(d = 2\). Tada:</p>
        <div class="math-box">
          \[ \alpha = a_{54} = 1 + 53 \cdot 2 = 107 \]
          \[ \beta = a_{70} = 1 + 69 \cdot 2 = 139 \]
        </div>
        <p>Direktan zbir:</p>
        <div class="math-box">
          \[ S_{160} = \frac{160}{2}(2 \cdot 1 + 159 \cdot 2) = 80 \cdot 320 = 25600 \]
        </div>
        <p>Naš odgovor (D):</p>
        <div class="math-box">
          \[ 5(-21 \cdot 107 + 53 \cdot 139) = 5(-2247 + 7367) = 5 \cdot 5120 = 25600 \;\checkmark \]
        </div>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri se: Da li opcija (A) daje isti rezultat za iste konkretne vrednosti?</summary>
      <p>Opcija (A): \(85 \cdot 107 + 75 \cdot 139 = 9095 + 10425 = 19520 \neq 25600\). Ne! Samo opcija (D) daje tačan rezultat.</p>
    </details>
  </div>

  <!-- Key Insight -->
  <div class="card insight-card">
    <h2>Ključni uvid</h2>
    <p>Kod ovakvih zadataka, ključna ideja je da <span class="highlight">ne moramo naći konkretne brojčane vrednosti</span> za \(a_1\) i \(d\) -- dovoljno ih je izraziti preko \(\alpha\) i \(\beta\), a zatim sve urstiti u formulu za zbir. Imenilac 16 (koji dolazi od razlike indeksa \(70 - 54 = 16\)) se lepo skraćuje sa \(\frac{160}{2} = 80\), jer je \(\frac{80}{16} = 5\).</p>
    <div class="math-box" style="text-align: center; font-size: 1.2rem;">
      \[ S_{160} = \frac{160}{2} \cdot \frac{-21\alpha + 53\beta}{16} = \color{#4ade80}{5(-21\alpha + 53\beta)} \]
    </div>
  </div>

  <!-- Final Answer -->
  <div class="card final-answer">
    <h2>Konačan odgovor</h2>
    <div class="answer-big">\(S_{160} = 5(-21\alpha + 53\beta)\)</div>

    <div class="options-row">
      <div class="option-box">
        <div class="opt-label">(A)</div>
        <div class="opt-value">\(85\alpha + 75\beta\)</div>
      </div>
      <div class="option-box">
        <div class="opt-label">(B)</div>
        <div class="opt-value">\(5(-19\alpha + 51\beta + 32)\)</div>
      </div>
      <div class="option-box">
        <div class="opt-label">(C)</div>
        <div class="opt-value">\(\frac{3(37\alpha - 62\beta)}{5}\)</div>
      </div>
      <div class="option-box correct">
        <div class="opt-label">(D)</div>
        <div class="opt-value">\(5(-21\alpha + 53\beta)\)</div>
      </div>
      <div class="option-box">
        <div class="opt-label">(E)</div>
        <div class="opt-value">\(\frac{75(-11\alpha + 43\beta)}{16}\)</div>
      </div>
    </div>

    <p class="verification"><strong>Provera:</strong> Uvrštavanjem konkretne progresije \(a_1 = 1\), \(d = 2\) dobijamo \(\alpha = 107\), \(\beta = 139\), \(S_{160} = 25600\). Opcija (D) daje \(5(-21 \cdot 107 + 53 \cdot 139) = 25600\). Opcija (B) se može eliminisati jer sadrži konstantu 32 -- zbir mora biti linearna kombinacija samo od \(\alpha\) i \(\beta\), bez slobodnog člana.</p>
  </div>

  <!-- Common Pitfalls -->
  <div class="card">
    <h2>Česte greške</h2>
    <ul class="pitfall-list">
      <li><strong>Pogrešan indeks u formuli za opšti član:</strong> Formla glasi \(a_n = a_1 + (n-1)d\), a ne \(a_n = a_1 + nd\). Za \(a_{54}\) koeficijent uz \(d\) je 53, ne 54. Ova greška menja sve koeficijente u konačnom rezultatu.</li>
      <li><strong>Greška pri sabiranju koeficijenata:</strong> U koraku gde sabiramo \(2a_1 + 159d\), lako je pogrešiti pri računanju \(138 - 159 = -21\) ili \(-106 + 159 = 53\). Preporučuje se pažljivo razvrstavanje članova uz \(\alpha\) i \(\beta\) odvojeno.</li>
    </ul>
  </div>

  <!-- Optional Challenge -->
  <div class="card challenge-card">
    <h2>Dodatni izazov</h2>
    <p>U istoj aritmetičkoj progresiji, za koje vrednosti parametara \(\alpha\) i \(\beta\) zbir prvih 160 članova iznosi nula? Kakva je geometrijska interpretacija tog uslova?</p>
    <details>
      <summary>Pomoć</summary>
      <p>Iz \(S_{160} = 5(-21\alpha + 53\beta) = 0\) sledi \(21\alpha = 53\beta\), tj. \(\frac{\alpha}{\beta} = \frac{53}{21}\). Razmislite šta to znači za položaj nule progresije u odnosu na članove \(a_{54}\) i \(a_{70}\).</p>
    </details>
  </div>

</div>

<script>
(() => {
  const canvas = document.getElementById('viz-canvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const W = canvas.width;
  const H = canvas.height;

  const slider = document.getElementById('d-slider');
  const dValueSpan = document.getElementById('d-value');

  let currentD = 5;
  let a1 = 10;

  function draw() {
    currentD = parseInt(slider.value, 10);
    dValueSpan.textContent = String(currentD);
    a1 = 10;

    // Compute key values
    var alpha = a1 + 53 * currentD; // a_54
    var beta = a1 + 69 * currentD;  // a_70
    var a160 = a1 + 159 * currentD; // a_160

    // S_160 using formula
    var S160 = 80 * (2 * a1 + 159 * currentD);

    // Also compute via our answer formula for verification
    var S160check = 5 * (-21 * alpha + 53 * beta);

    // Background
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    // Draw number line / sequence visualization
    var padding = 60;
    var plotAreaW = W - 2 * padding;
    var plotAreaH = H - 2 * padding - 40;

    // We'll plot a_n vs n for key points
    var keyPoints = [
      { n: 1, label: 'a\u2081', color: '#60a5fa' },
      { n: 54, label: 'a\u2085\u2084 = \u03B1', color: '#f472b6' },
      { n: 70, label: 'a\u2087\u2080 = \u03B2', color: '#a78bfa' },
      { n: 160, label: 'a\u2081\u2086\u2080', color: '#38bdf8' }
    ];

    var vals = keyPoints.map(function(p) { return a1 + (p.n - 1) * currentD; });
    var allN = keyPoints.map(function(p) { return p.n; });

    var minVal = Math.min.apply(null, vals);
    var maxVal = Math.max.apply(null, vals);
    if (minVal === maxVal) { minVal -= 10; maxVal += 10; }

    var valRange = maxVal - minVal;
    minVal -= valRange * 0.1;
    maxVal += valRange * 0.1;

    var minN = 0;
    var maxN = 165;

    function toCanvasX(n) {
      return padding + (n - minN) / (maxN - minN) * plotAreaW;
    }

    function toCanvasY(v) {
      return padding + 20 + plotAreaH - (v - minVal) / (maxVal - minVal) * plotAreaH;
    }

    // Grid lines
    ctx.strokeStyle = '#1e293b';
    ctx.lineWidth = 1;

    // Horizontal grid
    var ySteps = 5;
    for (var yi = 0; yi <= ySteps; yi++) {
      var yv = minVal + (maxVal - minVal) * yi / ySteps;
      var cy = toCanvasY(yv);
      ctx.beginPath();
      ctx.moveTo(padding, cy);
      ctx.lineTo(W - padding, cy);
      ctx.stroke();
    }

    // Vertical grid at key n values
    var nGridVals = [1, 20, 40, 54, 60, 70, 80, 100, 120, 140, 160];
    for (var ni = 0; ni < nGridVals.length; ni++) {
      var cx = toCanvasX(nGridVals[ni]);
      ctx.beginPath();
      ctx.moveTo(cx, padding + 20);
      ctx.lineTo(cx, padding + 20 + plotAreaH);
      ctx.stroke();
    }

    // Axes
    ctx.strokeStyle = '#334155';
    ctx.lineWidth = 1.5;

    // X-axis
    ctx.beginPath();
    ctx.moveTo(padding, padding + 20 + plotAreaH);
    ctx.lineTo(W - padding, padding + 20 + plotAreaH);
    ctx.stroke();

    // Y-axis
    ctx.beginPath();
    ctx.moveTo(padding, padding + 20);
    ctx.lineTo(padding, padding + 20 + plotAreaH);
    ctx.stroke();

    // Axis labels
    ctx.fillStyle = '#64748b';
    ctx.font = '11px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    for (var nj = 0; nj < nGridVals.length; nj++) {
      var nv = nGridVals[nj];
      ctx.fillText(String(nv), toCanvasX(nv), padding + 20 + plotAreaH + 16);
    }
    ctx.fillStyle = '#94a3b8';
    ctx.font = '12px Segoe UI, system-ui, sans-serif';
    ctx.fillText('n (redni broj člana)', W / 2, H - 10);

    // Y-axis labels
    ctx.textAlign = 'right';
    ctx.fillStyle = '#64748b';
    ctx.font = '11px Segoe UI, system-ui, sans-serif';
    for (var yk = 0; yk <= ySteps; yk++) {
      var yvl = minVal + (maxVal - minVal) * yk / ySteps;
      ctx.fillText(Math.round(yvl).toString(), padding - 8, toCanvasY(yvl) + 4);
    }

    // Draw the progression line
    ctx.strokeStyle = 'rgba(96, 165, 250, 0.4)';
    ctx.lineWidth = 2;
    ctx.setLineDash([]);
    ctx.beginPath();
    var firstY = toCanvasY(a1);
    var lastY = toCanvasY(a1 + 159 * currentD);
    ctx.moveTo(toCanvasX(1), firstY);
    ctx.lineTo(toCanvasX(160), lastY);
    ctx.stroke();

    // Shade area under the line (representing the sum) from n=1 to n=160
    ctx.fillStyle = 'rgba(96, 165, 250, 0.06)';
    var baseY = toCanvasY(0);
    // Clamp baseY to plot area
    var clampedBaseY = Math.max(padding + 20, Math.min(padding + 20 + plotAreaH, baseY));
    ctx.beginPath();
    ctx.moveTo(toCanvasX(1), clampedBaseY);
    ctx.lineTo(toCanvasX(1), firstY);
    ctx.lineTo(toCanvasX(160), lastY);
    ctx.lineTo(toCanvasX(160), clampedBaseY);
    ctx.closePath();
    ctx.fill();

    // Draw key points
    for (var ki = 0; ki < keyPoints.length; ki++) {
      var kp = keyPoints[ki];
      var kx = toCanvasX(kp.n);
      var kval = a1 + (kp.n - 1) * currentD;
      var ky = toCanvasY(kval);

      // Dashed line down to axis
      ctx.setLineDash([4, 3]);
      ctx.strokeStyle = kp.color;
      ctx.lineWidth = 1;
      ctx.globalAlpha = 0.4;
      ctx.beginPath();
      ctx.moveTo(kx, ky);
      ctx.lineTo(kx, padding + 20 + plotAreaH);
      ctx.stroke();
      ctx.globalAlpha = 1.0;
      ctx.setLineDash([]);

      // Point
      ctx.beginPath();
      ctx.arc(kx, ky, 7, 0, 2 * Math.PI);
      ctx.fillStyle = kp.color;
      ctx.fill();
      ctx.strokeStyle = '#0f172a';
      ctx.lineWidth = 2;
      ctx.stroke();

      // Label
      ctx.fillStyle = kp.color;
      ctx.font = 'bold 12px Segoe UI, system-ui, sans-serif';
      ctx.textAlign = 'center';
      var labelOff = ki % 2 === 0 ? -18 : -18;
      ctx.fillText(kp.label, kx, ky + labelOff);

      // Value
      ctx.fillStyle = '#e2e8f0';
      ctx.font = '11px Segoe UI, system-ui, sans-serif';
      ctx.fillText('= ' + Math.round(kval), kx, ky + labelOff - 14);
    }

    // Sum display
    ctx.fillStyle = '#4ade80';
    ctx.font = 'bold 14px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('S\u2081\u2086\u2080 = ' + S160, padding + 10, padding + 12);

    // Formula verification
    ctx.fillStyle = '#94a3b8';
    ctx.font = '11px Segoe UI, system-ui, sans-serif';
    ctx.fillText('5(-21\u03B1 + 53\u03B2) = ' + S160check, padding + 10, padding + 28);

    // Legend
    ctx.fillStyle = '#94a3b8';
    ctx.font = '12px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'right';

    // a1 fixed at 10 notice
    ctx.fillStyle = '#64748b';
    ctx.font = '11px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'right';
    ctx.fillText('(a\u2081 = ' + a1 + ', d = ' + currentD + ')', W - padding, padding + 12);
  }

  draw();

  slider.addEventListener('input', draw);

  // Step click interactivity
  var steps = document.querySelectorAll('.step');
  steps.forEach(function(step) {
    step.addEventListener('click', function() {
      steps.forEach(function(s) { s.classList.remove('active'); });
      step.classList.add('active');
    });
  });
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Zbir prvih 160 članova aritmetičke progresije",
  "subject": "math",
  "unit": "algebra",
  "topic_tags": ["aritmetička progresija", "zbir članova", "opšti član", "razlika progresije", "parametarski izrazi"]
}
BRAINSPARK_META-->