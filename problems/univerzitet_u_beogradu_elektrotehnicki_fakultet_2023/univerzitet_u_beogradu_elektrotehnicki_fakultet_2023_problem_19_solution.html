<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Polulopta upisana u piramidu - minimalna povrsina</title>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<script type="text/info" id="logic-scratchpad">
Problem: Hemisphere of radius r inscribed in a right regular square pyramid.
Base of hemisphere lies in base plane. All 4 lateral faces tangent to hemisphere.
Find base edge a when total surface area is minimal.

Setup:
- Square base with edge a, height h.
- Hemisphere center O at center of base, radius r.
- Apothem of base (distance from center to midpoint of edge) = a/2.

Cross-section through apex and midpoint of a base edge:
- This is an isosceles triangle. In this cross-section, the base goes from -a/2 to a/2.
- The slant edge goes from (a/2, 0) to (0, h).
- The hemisphere appears as a semicircle of radius r centered at origin.

Tangency condition:
The slant line from (a/2, 0) to (0, h) has equation: hx + (a/2)y = ah/2
Or: hx + (a/2)y - ah/2 = 0
Distance from origin (0,0) to this line:
  d = |ah/2| / sqrt(h^2 + a^2/4) = ah / (2*sqrt(h^2 + a^2/4))

Set d = r:
  ah / (2*sqrt(h^2 + a^2/4)) = r

Let l = slant height of lateral face = sqrt(h^2 + (a/2)^2) = sqrt(h^2 + a^2/4)
Then: ah/(2l) = r => ah = 2rl => h = 2rl/a

Total surface area:
S = base + lateral = a^2 + 4*(1/2)*a*l = a^2 + 2al

From constraint: h = 2rl/a
Also: l^2 = h^2 + a^2/4 = 4r^2*l^2/a^2 + a^2/4
=> l^2(1 - 4r^2/a^2) = a^2/4
=> l^2 * (a^2 - 4r^2)/a^2 = a^2/4
=> l^2 = a^4 / (4(a^2 - 4r^2))
=> l = a^2 / (2*sqrt(a^2 - 4r^2))

Note: need a > 2r for this to be valid.

S(a) = a^2 + 2a * a^2/(2*sqrt(a^2 - 4r^2))
     = a^2 + a^3/sqrt(a^2 - 4r^2)

Substitution: let t = a^2, then a = sqrt(t), and a^2 - 4r^2 = t - 4r^2

S = t + t^(3/2) / sqrt(t - 4r^2)

Better: let a = 2r*cosh(u) ... or try parametric.

Let me use substitution a^2 = 4r^2 + v^2 (so a > 2r, v > 0).
Then sqrt(a^2 - 4r^2) = v.
l = a^2/(2v) = (4r^2 + v^2)/(2v)

S = a^2 + a^3/v = (4r^2 + v^2) + (4r^2 + v^2)^(3/2)/v

This is still messy. Let me just differentiate directly.

dS/da = 2a + [3a^2*sqrt(a^2-4r^2) - a^3 * a/sqrt(a^2-4r^2)] / (a^2-4r^2)
       = 2a + [3a^2*(a^2-4r^2) - a^4] / (a^2-4r^2)^(3/2)
       = 2a + a^2[3(a^2-4r^2) - a^2] / (a^2-4r^2)^(3/2)
       = 2a + a^2[3a^2 - 12r^2 - a^2] / (a^2-4r^2)^(3/2)
       = 2a + a^2[2a^2 - 12r^2] / (a^2-4r^2)^(3/2)
       = 2a + 2a^2(a^2 - 6r^2) / (a^2-4r^2)^(3/2)

Set dS/da = 0:
  2a + 2a^2(a^2 - 6r^2)/(a^2-4r^2)^(3/2) = 0

Since a > 0:
  1 + a(a^2 - 6r^2)/(a^2-4r^2)^(3/2) = 0
  a(a^2 - 6r^2) = -(a^2-4r^2)^(3/2)

Since a > 2r, the right side is negative, so we need a^2 - 6r^2 < 0, i.e. a < r*sqrt(6).
So 2r < a < r*sqrt(6).

Let me square both sides (both sides negative, so squaring is valid):
  a^2(a^2-6r^2)^2 = (a^2-4r^2)^3

Let u = a^2:
  u(u-6r^2)^2 = (u-4r^2)^3

Expand left: u(u^2 - 12r^2*u + 36r^4) = u^3 - 12r^2*u^2 + 36r^4*u
Expand right: (u-4r^2)^3 = u^3 - 12r^2*u^2 + 48r^4*u - 64r^6

Setting equal:
u^3 - 12r^2*u^2 + 36r^4*u = u^3 - 12r^2*u^2 + 48r^4*u - 64r^6
36r^4*u = 48r^4*u - 64r^6
0 = 12r^4*u - 64r^6
12r^4*u = 64r^6
u = 64r^6/(12r^4) = 16r^2/3

So a^2 = 16r^2/3 => a = 4r/sqrt(3) = 4r*sqrt(3)/3 = (4*sqrt(3)*r)/3

This matches answer (C).

Verification:
a = 4sqrt(3)r/3, a^2 = 48r^2/9 = 16r^2/3
a^2 - 4r^2 = 16r^2/3 - 12r^2/3 = 4r^2/3
sqrt(a^2 - 4r^2) = 2r/sqrt(3) = 2sqrt(3)r/3
l = a^2/(2*2sqrt(3)r/3) = (16r^2/3)/(4sqrt(3)r/3) = 16r^2/(4sqrt(3)r) = 4r/sqrt(3) = 4sqrt(3)r/3

So l = a = 4sqrt(3)r/3. Interesting!

h = 2rl/a = 2r*l/a = 2r (since l=a) => h = 2r

S = a^2 + 2al = (16r^2/3) + 2*(4sqrt(3)r/3)*(4sqrt(3)r/3)
  = 16r^2/3 + 2*48r^2/9
  = 16r^2/3 + 96r^2/9
  = 48r^2/9 + 96r^2/9
  = 144r^2/9
  = 16r^2

Answer: (C) 4sqrt(3)*r/3
</script>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  font-size: 2.2rem;
  font-weight: 700;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
  line-height: 1.3;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 32px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 24px;
}

.card-title {
  font-size: 1.3rem;
  font-weight: 600;
  color: #60a5fa;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.card-title .icon {
  font-size: 1.4rem;
}

.problem-statement {
  border-left: 4px solid #a78bfa;
  font-size: 1.1rem;
}

.problem-statement .problem-text {
  margin-bottom: 20px;
}

.given-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 10px;
  margin-top: 16px;
}

.given-item {
  background: rgba(56, 189, 248, 0.08);
  border: 1px solid rgba(56, 189, 248, 0.15);
  border-radius: 10px;
  padding: 10px 16px;
  text-align: center;
  font-size: 1.05rem;
}

.answer-option {
  cursor: default;
  transition: transform 0.15s;
}

.math-box {
  background: rgba(56, 189, 248, 0.08);
  border: 1px solid rgba(56, 189, 248, 0.15);
  border-radius: 10px;
  padding: 16px 20px;
  margin: 14px 0;
  overflow-x: auto;
}

.step-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  border-radius: 50%;
  color: #fff;
  font-weight: 700;
  font-size: 0.95rem;
  margin-right: 10px;
  flex-shrink: 0;
}

.step-title {
  font-size: 1.15rem;
  font-weight: 600;
  color: #e2e8f0;
  display: flex;
  align-items: center;
  margin-bottom: 12px;
}

.step-explanation {
  color: #cbd5e1;
  margin-bottom: 12px;
}

details {
  background: rgba(167, 139, 250, 0.08);
  border: 1px solid rgba(167, 139, 250, 0.2);
  border-radius: 10px;
  padding: 12px 16px;
  margin: 12px 0;
}

details summary {
  cursor: pointer;
  color: #a78bfa;
  font-weight: 600;
  user-select: none;
}

details summary:hover {
  color: #c4b5fd;
}

details[open] summary {
  margin-bottom: 10px;
}

.insight-box {
  background: rgba(96, 165, 250, 0.1);
  border: 1px solid rgba(96, 165, 250, 0.3);
  border-left: 4px solid #60a5fa;
  border-radius: 12px;
  padding: 20px 24px;
  margin: 24px 0;
}

.insight-box .insight-title {
  color: #60a5fa;
  font-weight: 700;
  font-size: 1.15rem;
  margin-bottom: 8px;
}

.final-answer-card {
  background: rgba(52, 211, 153, 0.08);
  border: 2px solid rgba(52, 211, 153, 0.3);
  border-radius: 16px;
  padding: 28px;
  text-align: center;
  margin: 28px 0;
}

.final-answer-card .label {
  color: #34d399;
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 10px;
}

.final-answer-card .answer {
  font-size: 2.2rem;
  font-weight: 700;
  color: #4ade80;
  margin-bottom: 16px;
}

.final-options {
  display: flex;
  justify-content: center;
  gap: 12px;
  flex-wrap: wrap;
  margin-top: 16px;
}

.final-option {
  padding: 8px 20px;
  border-radius: 10px;
  font-size: 1.05rem;
  border: 1px solid #334155;
  background: #1e293b;
  color: #94a3b8;
}

.final-option.correct {
  background: rgba(52, 211, 153, 0.15);
  border-color: #34d399;
  color: #4ade80;
  font-weight: 700;
}

.verification-note {
  color: #94a3b8;
  font-size: 0.95rem;
  margin-top: 14px;
}

.pitfall-item {
  background: rgba(244, 114, 182, 0.08);
  border-left: 3px solid #f472b6;
  border-radius: 8px;
  padding: 12px 16px;
  margin: 10px 0;
  color: #fbb6ce;
}

.pitfall-title {
  color: #f472b6;
  font-weight: 600;
  margin-bottom: 4px;
}

canvas {
  width: 100%;
  border-radius: 12px;
  touch-action: none;
  display: block;
  margin: 0 auto;
}

.plan-text {
  color: #94a3b8;
  font-size: 1.05rem;
  line-height: 1.8;
}

.arrow {
  color: #60a5fa;
  margin: 0 4px;
}

.checkpoint {
  background: rgba(52, 211, 153, 0.1);
  border: 1px solid rgba(52, 211, 153, 0.25);
  border-radius: 10px;
  padding: 10px 16px;
  margin: 12px 0;
  color: #34d399;
  font-weight: 600;
  font-size: 0.95rem;
}

@media (max-width: 700px) {
  h1 { font-size: 1.5rem; }
  .card { padding: 16px; }
  .container { padding: 10px; }
  .given-grid { grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); }
  .final-answer-card .answer { font-size: 1.7rem; }
}
</style>
</head>
<body>
<div class="container">

  <h1>Polulopta upisana u piramidu &mdash; minimalna povrsina</h1>
  <p class="subtitle">Optimizacija povrsine pravilne cetvorostrane piramide sa upisanom poluloptom</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <div class="card-title"><span class="icon">&#128221;</span> Tekst zadatka</div>
    <div class="problem-text">
      Polulopta poluprecnika \(r\) upisana je u pravu pravilnu cetvorostranu piramidu tako da osnova polulopte pripada ravni osnove piramide i sve bocne strane piramide dodiruju poluloptu. Ako je povrsina takve piramide minimalna, onda njena osnovna ivica iznosi:
    </div>
    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">(A) \(\dfrac{2\sqrt{3}\,r}{3}\)</div>
      <div class="given-item answer-option" data-option="B">(B) \(\dfrac{48r}{9}\)</div>
      <div class="given-item answer-option" data-option="C">(C) \(\dfrac{4\sqrt{3}\,r}{3}\)</div>
      <div class="given-item answer-option" data-option="D">(D) \(\dfrac{\sqrt{3}\,r}{4}\)</div>
      <div class="given-item answer-option" data-option="E">(E) \(\dfrac{16\sqrt{3}\,r}{9}\)</div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card">
    <div class="card-title"><span class="icon">&#127919;</span> Plan resavanja</div>
    <p class="plan-text">
      Postavljamo koordinatni sistem u centar osnove piramide. Koristimo uslov tangentnosti bocnih strana na poluloptu da izrazimo zavisnost izmedju visine \(h\) i ivice \(a\). Zatim zapisujemo ukupnu povrsinu kao funkciju jedne promenljive \(a\) i trazimo njen minimum diferenciranjem.
    </p>
    <p class="plan-text" style="margin-top: 8px;">
      <span class="arrow">&#9654;</span> Postavka i oznake
      <span class="arrow">&#9654;</span> Uslov tangentnosti
      <span class="arrow">&#9654;</span> Povrsina kao \(S(a)\)
      <span class="arrow">&#9654;</span> \(S'(a) = 0\)
      <span class="arrow">&#9654;</span> Vrednost \(a\)
    </p>
  </div>

  <!-- Theory Refresher -->
  <div class="card">
    <div class="card-title"><span class="icon">&#128218;</span> Podsecanje na teoriju</div>
    <details>
      <summary>Pravilna cetvorostrana piramida &mdash; osnovni pojmovi</summary>
      <p style="margin-top: 8px;">Pravilna cetvorostrana piramida ima kvadratnu osnovu ivice \(a\) i vrh (apeks) iznad centra osnove na visini \(h\).</p>
      <div class="math-box">
        \[\text{Apotema osnove: } m = \frac{a}{2}\]
        \[\text{Bocna apotema (visina bocne strane): } l = \sqrt{h^2 + \frac{a^2}{4}}\]
        \[\text{Povrsina: } S = a^2 + 4 \cdot \frac{1}{2} \cdot a \cdot l = a^2 + 2al\]
      </div>
    </details>
    <details style="margin-top: 10px;">
      <summary>Rastojanje tacke od ravni / prave</summary>
      <p style="margin-top: 8px;">Rastojanje tacke \((x_0, y_0)\) od prave \(Ax + By + C = 0\) jednako je:</p>
      <div class="math-box">
        \[d = \frac{|Ax_0 + By_0 + C|}{\sqrt{A^2 + B^2}}\]
      </div>
      <p>Ovaj obrazac koristimo u preseku piramide da izrazimo uslov tangentnosti polulopte na bocnu stranu.</p>
    </details>
    <details style="margin-top: 10px;">
      <summary>Optimizacija &mdash; nalazenje minimuma funkcije</summary>
      <p style="margin-top: 8px;">Minimum funkcije \(S(a)\) nalazimo iz uslova \(S'(a) = 0\), uz proveru da je to zaista minimum (npr. drugom izvod ili analizom ponasanja).</p>
    </details>
  </div>

  <!-- Canvas Visualization -->
  <div class="card">
    <div class="card-title"><span class="icon">&#127912;</span> 3D vizualizacija</div>
    <canvas id="pyramidCanvas" width="900" height="550"></canvas>
    <p style="color: #94a3b8; font-size: 0.9rem; text-align: center; margin-top: 8px;">Prevucite misem da rotirate model piramide sa upisanom poluloptom</p>
  </div>

  <!-- Step-by-Step Solution -->
  <div class="card">
    <div class="card-title"><span class="icon">&#128736;</span> Resenje korak po korak</div>

    <!-- Step 1 -->
    <div style="margin-bottom: 28px;">
      <div class="step-title"><span class="step-badge">1</span> Postavka koordinatnog sistema</div>
      <p class="step-explanation">
        Neka je \(a\) osnovna ivica piramide, a \(h\) njena visina. Postavimo koordinatni sistem tako da je centar osnove u koordinatnom pocetku \(O\), a vrh piramide na visini \(h\) iznad njega.
      </p>
      <p class="step-explanation">
        Polulopta poluprecnika \(r\) ima centar u tacki \(O\) i lezi na ravni osnove. Njena sfernicna povrsina je iznad osnove.
      </p>
      <p class="step-explanation">
        Apotema osnove (rastojanje od centra do sredista ivice) iznosi \(\frac{a}{2}\). Bocna apotema (visina bocne strane, od sredista ivice osnove do vrha) iznosi:
      </p>
      <div class="math-box">
        \[l = \sqrt{h^2 + \frac{a^2}{4}}\]
      </div>
    </div>

    <!-- Step 2 -->
    <div style="margin-bottom: 28px;">
      <div class="step-title"><span class="step-badge">2</span> Uslov tangentnosti &mdash; presek kroz bocnu apotemu</div>
      <p class="step-explanation">
        Posmatrajmo presek piramide ravni koja prolazi kroz vrh i srediste jedne ivice osnove. U tom preseku vidimo jednakokraki trougao sa bazom \(a\) i visinom \(h\), a polulopta se vidi kao polukrug poluprecnika \(r\).
      </p>
      <p class="step-explanation">
        Bocna ivica u ovom preseku je duz od tacke \(\left(\frac{a}{2},\, 0\right)\) do tacke \(\left(0,\, h\right)\). Jednacina te prave glasi:
      </p>
      <div class="math-box">
        \[\frac{x}{\;\frac{a}{2}\;} + \frac{y}{h} = 1 \quad\Longrightarrow\quad h\,x + \frac{a}{2}\,y = \frac{ah}{2}\]
      </div>
      <p class="step-explanation">
        Polulopta dodiruje bocnu stranu, sto znaci da je rastojanje od centra \(O = (0,0)\) do ove prave jednako \(r\):
      </p>
      <div class="math-box">
        \[d = \frac{\left|\frac{ah}{2}\right|}{\sqrt{h^2 + \frac{a^2}{4}}} = \frac{ah}{2\,l} = r\]
      </div>
      <p class="step-explanation">
        Odavde dobijamo vezu:
      </p>
      <div class="math-box">
        \[\boxed{ah = 2rl}\]
      </div>
      <div class="checkpoint">&#10003; Kontrolna tacka: Uslov tangentnosti povezuje \(a\), \(h\) i \(l\) sa \(r\).</div>
    </div>

    <!-- Step 3 -->
    <div style="margin-bottom: 28px;">
      <div class="step-title"><span class="step-badge">3</span> Izrazi \(l\) samo preko \(a\)</div>
      <p class="step-explanation">
        Iz uslova tangentnosti: \(h = \frac{2rl}{a}\). Uvrstimo u \(l^2 = h^2 + \frac{a^2}{4}\):
      </p>
      <div class="math-box">
        \[l^2 = \frac{4r^2 l^2}{a^2} + \frac{a^2}{4}\]
      </div>
      <p class="step-explanation">
        Preuredimo:
      </p>
      <div class="math-box">
        \[l^2\left(1 - \frac{4r^2}{a^2}\right) = \frac{a^2}{4} \quad\Longrightarrow\quad l^2 \cdot \frac{a^2 - 4r^2}{a^2} = \frac{a^2}{4}\]
      </div>
      <div class="math-box">
        \[\boxed{l = \frac{a^2}{2\sqrt{a^2 - 4r^2}}}\]
      </div>
      <p class="step-explanation">
        Napomena: neophodno je \(a > 2r\) da bi piramida postojala (polulopta mora da stane u osnovu).
      </p>
    </div>

    <!-- Step 4 -->
    <div style="margin-bottom: 28px;">
      <div class="step-title"><span class="step-badge">4</span> Povrsina kao funkcija od \(a\)</div>
      <p class="step-explanation">
        Ukupna povrsina piramide (osnova + bocna povrsina):
      </p>
      <div class="math-box">
        \[S = a^2 + 2al\]
      </div>
      <p class="step-explanation">
        Uvrstimo izraz za \(l\):
      </p>
      <div class="math-box">
        \[S(a) = a^2 + 2a \cdot \frac{a^2}{2\sqrt{a^2 - 4r^2}} = a^2 + \frac{a^3}{\sqrt{a^2 - 4r^2}}\]
      </div>
      <div class="checkpoint">&#10003; Kontrolna tacka: Povrsina je funkcija samo od \(a\) (i parametra \(r\)).</div>
    </div>

    <!-- Step 5 -->
    <div style="margin-bottom: 28px;">
      <div class="step-title"><span class="step-badge">5</span> Diferenciranje &mdash; trazimo \(S'(a) = 0\)</div>
      <p class="step-explanation">
        Diferenciramo \(S(a) = a^2 + \frac{a^3}{\sqrt{a^2 - 4r^2}}\). Za drugi sabirak koristimo pravilo kolicnika:
      </p>
      <div class="math-box">
        \[\frac{d}{da}\left(\frac{a^3}{\sqrt{a^2-4r^2}}\right) = \frac{3a^2\sqrt{a^2-4r^2} - a^3 \cdot \frac{a}{\sqrt{a^2-4r^2}}}{a^2-4r^2}\]
      </div>
      <p class="step-explanation">
        Sredimo brojilac:
      </p>
      <div class="math-box">
        \[= \frac{3a^2(a^2-4r^2) - a^4}{(a^2-4r^2)^{3/2}} = \frac{a^2\bigl[3a^2 - 12r^2 - a^2\bigr]}{(a^2-4r^2)^{3/2}} = \frac{2a^2(a^2 - 6r^2)}{(a^2-4r^2)^{3/2}}\]
      </div>
      <p class="step-explanation">
        Dakle:
      </p>
      <div class="math-box">
        \[S'(a) = 2a + \frac{2a^2(a^2 - 6r^2)}{(a^2-4r^2)^{3/2}} = 0\]
      </div>
      <p class="step-explanation">
        Delimo sa \(2a > 0\):
      </p>
      <div class="math-box">
        \[1 + \frac{a(a^2 - 6r^2)}{(a^2-4r^2)^{3/2}} = 0\]
      </div>
    </div>

    <!-- Step 6 -->
    <div style="margin-bottom: 28px;">
      <div class="step-title"><span class="step-badge">6</span> Resavanje jednacine</div>
      <p class="step-explanation">
        Preuredimo:
      </p>
      <div class="math-box">
        \[a(a^2 - 6r^2) = -(a^2-4r^2)^{3/2}\]
      </div>
      <p class="step-explanation">
        Posto je desna strana negativna, mora biti \(a^2 < 6r^2\), tj. \(2r < a < r\sqrt{6}\). Obe strane su negativne, pa kvadriranjem dobijamo:
      </p>
      <div class="math-box">
        \[a^2(a^2 - 6r^2)^2 = (a^2-4r^2)^3\]
      </div>
      <p class="step-explanation">
        Uvedimo smenu \(u = a^2\) i razvijmo obe strane:
      </p>
      <div class="math-box">
        \[\text{Leva: } u(u-6r^2)^2 = u^3 - 12r^2 u^2 + 36r^4 u\]
        \[\text{Desna: } (u-4r^2)^3 = u^3 - 12r^2 u^2 + 48r^4 u - 64r^6\]
      </div>
      <p class="step-explanation">
        Izjednacavamo:
      </p>
      <div class="math-box">
        \[u^3 - 12r^2 u^2 + 36r^4 u = u^3 - 12r^2 u^2 + 48r^4 u - 64r^6\]
      </div>
      <p class="step-explanation">
        Skracujemo \(u^3 - 12r^2 u^2\) sa obe strane:
      </p>
      <div class="math-box">
        \[36r^4 u = 48r^4 u - 64r^6\]
        \[0 = 12r^4 u - 64r^6\]
        \[u = \frac{64r^6}{12r^4} = \frac{16r^2}{3}\]
      </div>
      <p class="step-explanation">
        Vracamo smenu \(a^2 = u\):
      </p>
      <div class="math-box">
        \[a^2 = \frac{16r^2}{3} \quad\Longrightarrow\quad \boxed{a = \frac{4r}{\sqrt{3}} = \frac{4\sqrt{3}\,r}{3}}\]
      </div>
      <div class="checkpoint">&#10003; Kontrolna tacka: \(a = \frac{4\sqrt{3}\,r}{3} \approx 2{,}31r\). Posto \(2r \approx 2r\), zaista vazi \(a > 2r\). &#10003;</div>
    </div>

    <!-- Step 7 -->
    <div style="margin-bottom: 28px;">
      <div class="step-title"><span class="step-badge">7</span> Verifikacija</div>
      <p class="step-explanation">
        Proverimo da su svi parametri konzistentni za \(a = \frac{4\sqrt{3}\,r}{3}\):
      </p>
      <div class="math-box">
        \[a^2 = \frac{16r^2}{3}, \qquad a^2 - 4r^2 = \frac{16r^2}{3} - 4r^2 = \frac{4r^2}{3}\]
      </div>
      <div class="math-box">
        \[l = \frac{a^2}{2\sqrt{a^2-4r^2}} = \frac{\frac{16r^2}{3}}{2 \cdot \frac{2r}{\sqrt{3}}} = \frac{\frac{16r^2}{3}}{\frac{4r}{\sqrt{3}}} = \frac{16r^2\sqrt{3}}{12r} = \frac{4\sqrt{3}\,r}{3} = a\]
      </div>
      <p class="step-explanation">
        Zanimljivo: pri minimalnoj povrsini vazi \(l = a\), tj. bocna apotema je jednaka osnovnoj ivici!
      </p>
      <div class="math-box">
        \[h = \frac{2rl}{a} = \frac{2r \cdot a}{a} = 2r\]
      </div>
      <p class="step-explanation">
        Proverimo i povrsinu:
      </p>
      <div class="math-box">
        \[S_{\min} = a^2 + 2a \cdot l = a^2 + 2a^2 = 3a^2 = 3 \cdot \frac{16r^2}{3} = 16r^2\]
      </div>
      <details>
        <summary>Proveri sebe: Da li uslov tangentnosti vazi?</summary>
        <p>Za \(a = \frac{4\sqrt{3}\,r}{3}\), \(h = 2r\) i \(l = \frac{4\sqrt{3}\,r}{3}\):</p>
        <div class="math-box">
          \[\frac{ah}{2l} = \frac{\frac{4\sqrt{3}\,r}{3} \cdot 2r}{2 \cdot \frac{4\sqrt{3}\,r}{3}} = \frac{\frac{8\sqrt{3}\,r^2}{3}}{\frac{8\sqrt{3}\,r}{3}} = r \quad &#10004;\]
        </div>
      </details>
    </div>
  </div>

  <!-- Key Insight -->
  <div class="insight-box">
    <div class="insight-title">Kljucni uvid</div>
    <p>
      Uslov tangentnosti polulopte na bocne strane piramide daje algebarsku vezu \(ah = 2rl\), koja omogucava eliminaciju jedne promenljive. Kada se povrsina izrazi samo preko \(a\) i optimizuje, dobija se elegantna jednacina cije je resenje \(a^2 = \frac{16r^2}{3}\). Posebno je lepo sto za optimalnu piramidu vazi \(l = a\) i \(h = 2r\), sto daje minimalnu povrsinu \(S = 16r^2\).
    </p>
  </div>

  <!-- Final Answer -->
  <div class="final-answer-card">
    <div class="label">Konacni odgovor</div>
    <div class="answer">\(\displaystyle a = \frac{4\sqrt{3}\,r}{3}\)</div>
    <div class="final-options">
      <div class="final-option" data-option="A">(A) \(\frac{2\sqrt{3}\,r}{3}\)</div>
      <div class="final-option" data-option="B">(B) \(\frac{48r}{9}\)</div>
      <div class="final-option correct" data-option="C">(C) \(\frac{4\sqrt{3}\,r}{3}\)</div>
      <div class="final-option" data-option="D">(D) \(\frac{\sqrt{3}\,r}{4}\)</div>
      <div class="final-option" data-option="E">(E) \(\frac{16\sqrt{3}\,r}{9}\)</div>
    </div>
    <p class="verification-note">
      Verifikacija: \(a^2 = \frac{16r^2}{3}\), \(l = a\), \(h = 2r\), \(S_{\min} = 16r^2\) &#10004;
    </p>
  </div>

  <!-- Common Pitfalls -->
  <div class="card">
    <div class="card-title"><span class="icon">&#9888;&#65039;</span> Ceste greske</div>
    <div class="pitfall-item">
      <div class="pitfall-title">Pogresan uslov tangentnosti</div>
      <p>Neki studenti koriste rastojanje od centra osnove do ivice (tj. \(\frac{a}{2}\)) umesto rastojanja do bocne strane piramide. Polulopta dodiruje bocne <em>strane</em> (ravni), ne ivice osnove.</p>
    </div>
    <div class="pitfall-item">
      <div class="pitfall-title">Zaboravljena osnova u povrsini</div>
      <p>Ukupna povrsina piramide ukljucuje i osnovu (\(a^2\)) i bocnu povrsinu (\(2al\)). Ako se optimizuje samo bocna povrsina, dobija se pogresna ivica.</p>
    </div>
    <div class="pitfall-item">
      <div class="pitfall-title">Greska pri kvadriranju</div>
      <p>Kod kvadriranja jednacine \(a(a^2-6r^2) = -(a^2-4r^2)^{3/2}\) treba proveriti da su obe strane istog znaka. Lazna resenja se mogu pojaviti ako se ovaj korak preskoci.</p>
    </div>
  </div>

  <!-- Challenge -->
  <div class="card">
    <div class="card-title"><span class="icon">&#127942;</span> Dodatni izazov</div>
    <p class="step-explanation">
      Kako se menja rezultat ako umesto polulopte imamo loptu poluprecnika \(r\) upisanu u piramidu (lopta dodiruje osnovu i sve bocne strane)? Nadjite osnovnu ivicu pri kojoj je ukupna povrsina piramide minimalna.
    </p>
    <details>
      <summary>Nagovestaj</summary>
      <p>Kod cele lopte, centar je na visini \(r\) iznad osnove, pa se menja formula za rastojanje od centra lopte do bocnih strana. Uslov tangentnosti na osnovu daje \(h \geq r\), a uslov tangentnosti na bocne strane ukljucuje i visinu centra.</p>
    </details>
  </div>

</div>

<script>
(() => {
  const canvas = document.getElementById('pyramidCanvas');
  const ctx = canvas.getContext('2d');
  let angleX = 0.35;
  let angleY = -0.6;
  let isDragging = false;
  let lastMouse = { x: 0, y: 0 };

  function project(x, y, z, cx, cy, scale) {
    const cosX = Math.cos(angleX), sinX = Math.sin(angleX);
    const cosY = Math.cos(angleY), sinY = Math.sin(angleY);
    const y1 = y * cosX - z * sinX;
    const z1 = y * sinX + z * cosX;
    const x1 = x * cosY + z1 * sinY;
    const z2 = -x * sinY + z1 * cosY;
    const fov = 600;
    const s = fov / (fov + z2 + 300);
    return { x: cx + x1 * scale * s, y: cy - y1 * scale * s, z: z2 };
  }

  function draw() {
    const dpr = window.devicePixelRatio || 1;
    const rect = canvas.getBoundingClientRect();
    canvas.width = rect.width * dpr;
    canvas.height = 550 * dpr;
    ctx.scale(dpr, dpr);
    const W = rect.width;
    const H = 550;

    ctx.fillStyle = '#0f172a';
    ctx.fillRect(0, 0, W, H);

    const cx = W / 2;
    const cy = H * 0.55;
    const scale = Math.min(W, H) * 0.22;

    const r = 1;
    const a = 4 * Math.sqrt(3) / 3;
    const h = 2;
    const halfA = a / 2;

    // Base vertices
    const base = [
      [-halfA, 0, -halfA],
      [ halfA, 0, -halfA],
      [ halfA, 0,  halfA],
      [-halfA, 0,  halfA]
    ];
    const apex = [0, h, 0];

    // Project all points
    const pBase = base.map(p => project(p[0], p[1], p[2], cx, cy, scale));
    const pApex = project(apex[0], apex[1], apex[2], cx, cy, scale);

    // Sort faces by average z for painter's algorithm
    const faces = [
      { verts: [0, 1], name: 'front-right' },
      { verts: [1, 2], name: 'right-back' },
      { verts: [2, 3], name: 'back-left' },
      { verts: [3, 0], name: 'left-front' }
    ];

    faces.forEach(f => {
      const v0 = pBase[f.verts[0]];
      const v1 = pBase[f.verts[1]];
      f.avgZ = (v0.z + v1.z + pApex.z) / 3;
    });
    faces.sort((a, b) => a.avgZ - b.avgZ);

    // Draw base (filled)
    ctx.beginPath();
    ctx.moveTo(pBase[0].x, pBase[0].y);
    for (let i = 1; i < 4; i++) ctx.lineTo(pBase[i].x, pBase[i].y);
    ctx.closePath();
    ctx.fillStyle = 'rgba(96, 165, 250, 0.08)';
    ctx.fill();
    ctx.strokeStyle = 'rgba(96, 165, 250, 0.4)';
    ctx.lineWidth = 1.5;
    ctx.stroke();

    // Draw hemisphere
    const hemiSegments = 40;
    const hemiRings = 20;

    // Collect hemisphere points
    const hemiPoints = [];
    for (let i = 0; i <= hemiRings; i++) {
      const phi = (Math.PI / 2) * (i / hemiRings);
      const ring = [];
      for (let j = 0; j <= hemiSegments; j++) {
        const theta = (2 * Math.PI * j) / hemiSegments;
        const px = r * Math.cos(phi) * Math.cos(theta);
        const py = r * Math.sin(phi);
        const pz = r * Math.cos(phi) * Math.sin(theta);
        ring.push(project(px, py, pz, cx, cy, scale));
      }
      hemiPoints.push(ring);
    }

    // Draw hemisphere wireframe
    ctx.strokeStyle = 'rgba(167, 139, 250, 0.35)';
    ctx.lineWidth = 0.8;
    for (let i = 0; i <= hemiRings; i++) {
      ctx.beginPath();
      for (let j = 0; j <= hemiSegments; j++) {
        const p = hemiPoints[i][j];
        if (j === 0) ctx.moveTo(p.x, p.y);
        else ctx.lineTo(p.x, p.y);
      }
      ctx.stroke();
    }
    for (let j = 0; j <= hemiSegments; j += 4) {
      ctx.beginPath();
      for (let i = 0; i <= hemiRings; i++) {
        const p = hemiPoints[i][j];
        if (i === 0) ctx.moveTo(p.x, p.y);
        else ctx.lineTo(p.x, p.y);
      }
      ctx.stroke();
    }

    // Draw hemisphere surface patches (shaded)
    for (let i = 0; i < hemiRings; i++) {
      for (let j = 0; j < hemiSegments; j++) {
        const p00 = hemiPoints[i][j];
        const p01 = hemiPoints[i][j+1];
        const p10 = hemiPoints[i+1][j];
        const p11 = hemiPoints[i+1][j+1];
        const avgZ = (p00.z + p01.z + p10.z + p11.z) / 4;
        const brightness = 0.08 + 0.07 * (1 - avgZ / 200);
        ctx.beginPath();
        ctx.moveTo(p00.x, p00.y);
        ctx.lineTo(p01.x, p01.y);
        ctx.lineTo(p11.x, p11.y);
        ctx.lineTo(p10.x, p10.y);
        ctx.closePath();
        ctx.fillStyle = `rgba(167, 139, 250, ${brightness})`;
        ctx.fill();
      }
    }

    // Draw lateral faces (sorted back to front)
    faces.forEach(f => {
      const i0 = f.verts[0];
      const i1 = f.verts[1];
      ctx.beginPath();
      ctx.moveTo(pBase[i0].x, pBase[i0].y);
      ctx.lineTo(pBase[i1].x, pBase[i1].y);
      ctx.lineTo(pApex.x, pApex.y);
      ctx.closePath();
      ctx.fillStyle = 'rgba(96, 165, 250, 0.06)';
      ctx.fill();
      ctx.strokeStyle = 'rgba(96, 165, 250, 0.6)';
      ctx.lineWidth = 1.5;
      ctx.stroke();
    });

    // Draw height line
    const pCenter = project(0, 0, 0, cx, cy, scale);
    ctx.beginPath();
    ctx.moveTo(pCenter.x, pCenter.y);
    ctx.lineTo(pApex.x, pApex.y);
    ctx.strokeStyle = '#34d399';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([5, 4]);
    ctx.stroke();
    ctx.setLineDash([]);

    // Draw apothem line (center to midpoint of front edge)
    const midEdge = [(base[0][0] + base[1][0]) / 2, 0, (base[0][2] + base[1][2]) / 2];
    const pMidEdge = project(midEdge[0], midEdge[1], midEdge[2], cx, cy, scale);
    ctx.beginPath();
    ctx.moveTo(pCenter.x, pCenter.y);
    ctx.lineTo(pMidEdge.x, pMidEdge.y);
    ctx.strokeStyle = '#f472b6';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([5, 4]);
    ctx.stroke();
    ctx.setLineDash([]);

    // Draw slant height line
    ctx.beginPath();
    ctx.moveTo(pMidEdge.x, pMidEdge.y);
    ctx.lineTo(pApex.x, pApex.y);
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2;
    ctx.setLineDash([5, 4]);
    ctx.stroke();
    ctx.setLineDash([]);

    // Labels
    ctx.font = 'bold 14px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';

    // Height label
    const hMid = project(0, h / 2, 0, cx, cy, scale);
    ctx.fillStyle = '#34d399';
    ctx.fillText('h = 2r', hMid.x - 28, hMid.y);

    // Apex label
    ctx.fillStyle = '#e2e8f0';
    ctx.fillText('Vrh', pApex.x + 5, pApex.y - 15);

    // a/2 label
    const apMid = project(midEdge[0] / 2, 0, midEdge[2] / 2, cx, cy, scale);
    ctx.fillStyle = '#f472b6';
    ctx.fillText('a/2', apMid.x, apMid.y + 20);

    // l label
    const lMid = project(midEdge[0] / 2, h / 2, midEdge[2] / 2, cx, cy, scale);
    ctx.fillStyle = '#60a5fa';
    ctx.fillText('l = a', lMid.x + 30, lMid.y);

    // r label (radius of hemisphere)
    const rPt = project(r * 0.7, r * 0.7, 0, cx, cy, scale);
    ctx.fillStyle = '#a78bfa';
    ctx.fillText('r', rPt.x + 15, rPt.y);

    // Center label
    ctx.fillStyle = '#94a3b8';
    ctx.fillText('O', pCenter.x - 15, pCenter.y + 5);

    // Title
    ctx.fillStyle = '#60a5fa';
    ctx.font = 'bold 16px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Polulopta upisana u pravilnu cetvorostranu piramidu', W / 2, 25);

    // Info box
    ctx.fillStyle = '#94a3b8';
    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('Optimalna piramida:', 20, H - 55);
    ctx.fillStyle = '#4ade80';
    ctx.fillText('a = 4\u221A3\u00B7r/3,  h = 2r,  l = a,  S = 16r\u00B2', 20, H - 35);
  }

  canvas.addEventListener('mousedown', (e) => {
    isDragging = true;
    lastMouse = { x: e.clientX, y: e.clientY };
  });

  canvas.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    const dx = e.clientX - lastMouse.x;
    const dy = e.clientY - lastMouse.y;
    angleY += dx * 0.008;
    angleX += dy * 0.008;
    angleX = Math.max(-1.2, Math.min(1.2, angleX));
    lastMouse = { x: e.clientX, y: e.clientY };
    draw();
  });

  canvas.addEventListener('mouseup', () => { isDragging = false; });
  canvas.addEventListener('mouseleave', () => { isDragging = false; });

  canvas.addEventListener('touchstart', (e) => {
    isDragging = true;
    lastMouse = { x: e.touches[0].clientX, y: e.touches[0].clientY };
  });

  canvas.addEventListener('touchmove', (e) => {
    if (!isDragging) return;
    e.preventDefault();
    const dx = e.touches[0].clientX - lastMouse.x;
    const dy = e.touches[0].clientY - lastMouse.y;
    angleY += dx * 0.008;
    angleX += dy * 0.008;
    angleX = Math.max(-1.2, Math.min(1.2, angleX));
    lastMouse = { x: e.touches[0].clientX, y: e.touches[0].clientY };
    draw();
  });

  canvas.addEventListener('touchend', () => { isDragging = false; });

  draw();
  window.addEventListener('resize', draw);
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Polulopta upisana u piramidu - minimalna povrsina",
  "subject": "math",
  "unit": "stereometrija",
  "topic_tags": ["stereometrija", "optimizacija", "piramida", "polulopta", "diferencijalni racun", "povrsina"]
}
BRAINSPARK_META-->