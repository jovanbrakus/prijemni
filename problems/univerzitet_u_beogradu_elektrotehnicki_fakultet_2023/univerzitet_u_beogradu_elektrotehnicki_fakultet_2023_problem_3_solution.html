<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Poluprecnik upisanog kruga u trapez</title>
<script type="text/info" id="logic-scratchpad">
PROBLEM:
Trapez je opisan oko kruga poluprecnika r.
Povrsina trapeza (u cm^2) je pet puta veca od obima tog trapeza (u cm).
Naci r.

Opcije: (A) 5  (B) 30  (C) 10  (D) 20  (E) 40

KLJUCNE CINJENICE:
1. Trapez opisan oko kruga = tangencijalni trapez (sve 4 stranice su tangente na krug).
2. Za svaki tangencijalni mnogougao vazi:
   Povrsina = r * s, gde je s = poluobim (O/2), a O = obim.
   Dakle: P = r * O/2

RESENJE:
Dato: P = 5 * O

Koristeci P = r * O/2:
  r * O/2 = 5 * O

Podelimo obe strane sa O (O != 0 jer je trapez):
  r/2 = 5
  r = 10

ODGOVOR: (C) 10

VERIFIKACIJA:
Za bilo koji tangencijalni trapez sa r = 10:
  P = r * O/2 = 10 * O/2 = 5 * O  ✓
Uslov je zadovoljen za svaki obim O.

NAPOMENA O TANGENCIJALNOM TRAPEZU:
Tangencijalni trapez (opisan oko kruga) ima osobinu:
  a + c = b + d  (zbirovi suprotnih strana su jednaki)
gde su a i c paralelne stranice (osnove), a b i d krakovi.
Ovo znaci: O = a + b + c + d = 2(a + c) = 2(b + d), tj. s = a + c = b + d.
Povrsina trapeza: P = (a + c)/2 * h, gde je h visina.
Za upisani krug: h = 2r (precnik kruga jednako visini trapeza).
Dakle: P = (a + c)/2 * 2r = r * (a + c) = r * s = r * O/2. ✓
</script>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 10px;
}

h1 {
  font-size: 2.2rem;
  font-weight: 800;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
  text-align: center;
}

.subtitle {
  color: #94a3b8;
  text-align: center;
  font-size: 1.05rem;
  margin-bottom: 30px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.35rem;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.card h3 {
  color: #e2e8f0;
  font-size: 1.1rem;
  margin-bottom: 10px;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.given-item {
  background: rgba(56,189,248,0.06);
  border: 1px solid rgba(56,189,248,0.12);
  border-radius: 10px;
  padding: 12px 18px;
  min-width: 100px;
  text-align: center;
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-bottom: 4px;
  font-weight: 600;
}

.given-item .value {
  color: #e2e8f0;
  font-size: 1.0rem;
  font-weight: 600;
}

.answer-option {
  transition: border-color 0.2s ease, background 0.2s ease;
  cursor: default;
}

.math-block {
  background: rgba(56,189,248,0.08);
  border: 1px solid rgba(56,189,248,0.15);
  border-radius: 10px;
  padding: 16px 20px;
  margin: 14px 0;
  font-family: 'Courier New', monospace;
  overflow-x: auto;
}

.plan-card {
  border-left: 4px solid #a78bfa;
}

.theory-card details {
  margin: 15px 0;
}

.theory-card summary {
  cursor: pointer;
  font-size: 1.05rem;
  font-weight: 600;
  color: #a78bfa;
  padding: 8px 0;
  user-select: none;
}

.theory-card ul {
  list-style: none;
  padding: 12px 0;
}

.theory-card li {
  padding: 8px 0;
  border-bottom: 1px solid rgba(51,65,85,0.5);
  color: #e2e8f0;
}

.theory-card li:last-child {
  border-bottom: none;
}

.step {
  display: flex;
  gap: 16px;
  padding: 16px;
  border-radius: 10px;
  margin-bottom: 12px;
  border-left: 3px solid transparent;
  transition: border-color 0.2s ease, background 0.2s ease;
  cursor: pointer;
}

.step:hover, .step.active {
  border-left-color: #4ade80;
  background: rgba(74,222,128,0.04);
}

.step-badge {
  width: 32px;
  height: 32px;
  min-width: 32px;
  border-radius: 50%;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.9rem;
  margin-top: 2px;
}

.step-content {
  flex: 1;
}

.step-content h3 {
  margin-bottom: 8px;
  color: #e2e8f0;
  font-size: 1.05rem;
}

.step-content p {
  color: #cbd5e1;
  margin-bottom: 8px;
}

.note {
  color: #94a3b8;
  font-size: 0.9rem;
  font-style: italic;
  margin-top: 6px;
}

.checkpoint {
  margin: 20px 0;
  background: rgba(167,139,250,0.06);
  border: 1px solid rgba(167,139,250,0.15);
  border-radius: 10px;
  padding: 14px 18px;
}

.checkpoint summary {
  cursor: pointer;
  color: #a78bfa;
  font-weight: 600;
  font-size: 0.95rem;
  user-select: none;
}

.checkpoint .answer {
  padding-top: 10px;
  color: #4ade80;
  font-weight: 600;
}

.insight-card {
  background: linear-gradient(135deg, rgba(96,165,250,0.1), rgba(167,139,250,0.1));
  border: 1px solid rgba(96,165,250,0.25);
  text-align: center;
  padding: 28px;
}

.insight-card .big-formula {
  font-size: 1.4rem;
  margin: 16px 0;
  color: #4ade80;
}

.final-answer-card {
  border: 2px solid #4ade80;
  background: linear-gradient(135deg, rgba(52,211,153,0.08), rgba(74,222,128,0.04));
  text-align: center;
  padding: 28px;
}

.final-answer-card h2 {
  color: #4ade80;
  justify-content: center;
}

.final-answer-value {
  font-size: 1.8rem;
  color: #4ade80;
  font-weight: 800;
  margin: 16px 0;
}

.options-row {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  margin: 20px 0;
}

.option-card {
  padding: 10px 22px;
  border-radius: 10px;
  border: 2px solid #334155;
  background: #1e293b;
  color: #94a3b8;
  font-size: 1rem;
  font-weight: 600;
  transition: all 0.2s ease;
}

.option-card.correct {
  border-color: #4ade80;
  background: rgba(74,222,128,0.1);
  color: #4ade80;
  box-shadow: 0 0 20px rgba(74,222,128,0.15);
}

.verification-note {
  color: #94a3b8;
  font-size: 0.92rem;
  margin-top: 14px;
  padding-top: 14px;
  border-top: 1px solid #334155;
  text-align: left;
}

.pitfall-list {
  list-style: none;
  padding: 0;
}

.pitfall-list li {
  padding: 10px 0;
  border-bottom: 1px solid rgba(51,65,85,0.5);
  color: #cbd5e1;
}

.pitfall-list li:last-child {
  border-bottom: none;
}

.pitfall-label {
  color: #e09468;
  font-weight: 700;
  margin-right: 6px;
}

.challenge-card {
  border-left: 4px solid #f472b6;
}

.challenge-card details {
  margin: 15px 0;
}

.challenge-card summary {
  cursor: pointer;
  color: #f472b6;
  font-weight: 600;
  user-select: none;
}

canvas {
  display: block;
  margin: 0 auto;
  border-radius: 12px;
  touch-action: none;
  max-width: 100%;
}

.canvas-hint {
  text-align: center;
  color: #64748b;
  font-size: 0.85rem;
  margin-top: 8px;
}

.highlight-pink {
  color: #f472b6;
  font-weight: 600;
}

.highlight-blue {
  color: #60a5fa;
  font-weight: 600;
}

.highlight-green {
  color: #4ade80;
  font-weight: 600;
}

@media (max-width: 700px) {
  h1 { font-size: 1.6rem; }
  .card { padding: 16px; }
  .step { padding: 12px; }
  .given-grid { gap: 8px; }
  .given-item { min-width: 70px; padding: 10px 12px; }
  .given-item .value { font-size: 0.9rem; }
  .final-answer-value { font-size: 1.4rem; }
  .options-row { gap: 8px; }
  .option-card { padding: 8px 14px; font-size: 0.9rem; }
}
</style>
</head>
<body>
<div class="container">

  <!-- Title -->
  <h1>Poluprecnik upisanog kruga u trapez</h1>
  <p class="subtitle">Tangencijalni trapez &mdash; povrsina, obim, upisani krug</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <h2>Postavka zadatka</h2>
    <p>
      Trapez je opisan oko kruga poluprecnika \(r\). Ako je poznato da je povrsina trapeza
      (u cm&sup2;) pet puta veca od obima tog trapeza (u cm), tada duzina poluprecnika
      \(r\) (u cm) iznosi:
    </p>

    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\(5\)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\(30\)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\(10\)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\(20\)</div>
      </div>
      <div class="given-item answer-option" data-option="E">
        <div class="label">(E)</div>
        <div class="value">\(40\)</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card plan-card">
    <h2>Plan resavanja</h2>
    <p>
      Kljuc ovog zadatka je <span class="highlight-blue">osobina tangencijalnog mnogougla</span>:
      povrsina bilo kog konveksnog mnogougla opisanog oko kruga jednaka je proizvodu
      poluprecnika upisanog kruga i poluobima. Koristeci ovu formulu i dati uslov
      \(P = 5O\), dobijamo jednostavnu jednacinu za \(r\).
    </p>
  </div>

  <!-- Theory Refresher -->
  <div class="card theory-card">
    <details>
      <summary>Kljucne formule i teoreme</summary>
      <ul>
        <li>
          <strong>Tangencijalni mnogougao:</strong>
          Mnogougao opisan oko kruga poluprecnika \(r\) ima povrsinu
          \(P = r \cdot s\), gde je \(s\) poluobim, tj. \(s = \dfrac{O}{2}\).
        </li>
        <li>
          <strong>Zasto vazi \(P = r \cdot s\)?</strong>
          Spojimo centar upisanog kruga sa svim temenima. Svaka stranica duzine \(a_i\) postaje
          osnova trougla cija je visina jednaka \(r\) (poluprecnik do tangentne stranice).
          Povrsina svakog trougla: \(\frac{1}{2} a_i \cdot r\).
          Ukupno: \(P = \sum \frac{1}{2} a_i \cdot r = r \cdot \frac{O}{2} = r \cdot s\).
        </li>
        <li>
          <strong>Tangencijalni trapez:</strong>
          Za trapez opisan oko kruga vazi \(a + c = b + d\) (zbirovi suprotnih strana jednaki),
          gde su \(a, c\) osnove a \(b, d\) krakovi. Visina trapeza jednaka je precniku kruga: \(h = 2r\).
        </li>
        <li>
          <strong>Povrsina trapeza (klasicna formula):</strong>
          \(P = \dfrac{a + c}{2} \cdot h\), gde su \(a, c\) paralelne stranice (osnove), a \(h\) visina.
        </li>
      </ul>
    </details>
  </div>

  <!-- Visual Canvas -->
  <div class="card">
    <h2>Vizuelni prikaz</h2>
    <p style="color:#94a3b8; margin-bottom: 14px;">
      Dijagram prikazuje trapez opisan oko kruga poluprecnika \(r\).
      Stranice trapeza su tangente na upisani krug. Centar kruga spojen je sa stranicama
      normalama duzine \(r\), formirajuci trouglove cija ukupna povrsina daje
      formulu \(P = r \cdot s\).
    </p>
    <canvas id="diagramCanvas" width="800" height="520"></canvas>
    <p class="canvas-hint">Trapez opisan oko kruga sa oznacenim poluprecnikom i stranicama</p>
  </div>

  <!-- Step-by-Step Solution -->
  <div class="card">
    <h2>Resenje korak po korak</h2>

    <!-- Step 1 -->
    <div class="step" tabindex="0">
      <div class="step-badge">1</div>
      <div class="step-content">
        <h3>Uvedimo oznake</h3>
        <p>
          Neka je trapez \(ABCD\) opisan oko kruga poluprecnika \(r\).
          Oznacimo stranice (osnove i krakove) sa \(a, b, c, d\).
        </p>
        <div class="math-block">
          \[ O = a + b + c + d \quad \text{(obim)} \]
        </div>
        <div class="math-block">
          \[ s = \frac{O}{2} \quad \text{(poluobim)} \]
        </div>
        <p class="note">
          Trapez je opisan oko kruga, sto znaci da su sve cetiri stranice tangente na krug.
        </p>
      </div>
    </div>

    <!-- Step 2 -->
    <div class="step" tabindex="0">
      <div class="step-badge">2</div>
      <div class="step-content">
        <h3>Primenimo formulu za povrsinu tangencijalnog mnogougla</h3>
        <p>
          Za svaki konveksni mnogougao opisan oko kruga poluprecnika \(r\) vazi
          fundamentalna veza:
        </p>
        <div class="math-block">
          \[ P = r \cdot s = r \cdot \frac{O}{2} \]
        </div>
        <p>
          Ovo se dokazuje razlaganjem mnogougla na trouglove: spojimo centar upisanog
          kruga \(I\) sa svim temenima. Svaka stranica duzine \(a_i\) je osnova trougla
          sa visinom \(r\) (rastojanje od centra do tangentne stranice). Zbir povrsina
          svih trouglova daje upravo \(r \cdot \frac{O}{2}\).
        </p>
      </div>
    </div>

    <!-- Checkpoint 1 -->
    <details class="checkpoint">
      <summary>Proveri se: Zasto je visina svakog trougla jednaka \(r\)?</summary>
      <div class="answer">
        Jer je centar upisanog kruga jednako udaljen od svih stranica mnogougla.
        To rastojanje je upravo poluprecnik \(r\). Normala iz centra kruga na
        tangentnu stranicu ima duzinu tacno \(r\).
      </div>
    </details>

    <!-- Step 3 -->
    <div class="step" tabindex="0">
      <div class="step-badge">3</div>
      <div class="step-content">
        <h3>Postavimo jednacinu iz uslova zadatka</h3>
        <p>Dato je da je povrsina pet puta veca od obima:</p>
        <div class="math-block">
          \[ P = 5 \cdot O \]
        </div>
        <p>Zamenimo \(P\) pomocu formule iz koraka 2:</p>
        <div class="math-block">
          \[ r \cdot \frac{O}{2} = 5 \cdot O \]
        </div>
      </div>
    </div>

    <!-- Step 4 -->
    <div class="step" tabindex="0">
      <div class="step-badge">4</div>
      <div class="step-content">
        <h3>Resimo jednacinu po \(r\)</h3>
        <p>
          Posto je \(O > 0\) (obim trapeza je pozitivan), mozemo obe strane
          podeliti sa \(O\):
        </p>
        <div class="math-block">
          \[ \frac{r}{2} = 5 \]
        </div>
        <p>Mnozimo obe strane sa 2:</p>
        <div class="math-block">
          \[ r = 10 \]
        </div>
        <p class="note">
          Primetimo da rezultat ne zavisi od konkretnih dimenzija trapeza &mdash;
          uslov \(P = 5O\) jednoznacno odredjuje \(r\), bez obzira na oblik trapeza.
        </p>
      </div>
    </div>

    <!-- Checkpoint 2 -->
    <details class="checkpoint">
      <summary>Proveri se: Moze li se ovo proveriti na konkretnom primeru?</summary>
      <div class="answer">
        Da! Uzmimo jednakokraki trapez sa osnovama \(a = 16\) i \(c = 4\),
        i krakovima \(b = d = 10\) (jer \(a + c = b + d = 20\)).
        Visina: \(h = 2r = 20\), tj. \(r = 10\).
        Provera: \(h = \sqrt{10^2 - 6^2} = \sqrt{64} = 8\)... To ne radi jer
        moramo birati stranice konzistentno. Uzmimo radije:
        \(a = 15\), \(c = 5\), \(b = d = 10\), pa \(a + c = 20 = b + d\). ✓
        Visina \(h = 2r = 20\). Obim: \(O = 40\). Povrsina: \(P = \frac{15 + 5}{2} \cdot 20 = 200\).
        Provera: \(5 \cdot O = 5 \cdot 40 = 200 = P\). ✓ Tacno!
      </div>
    </details>
  </div>

  <!-- Key Insight -->
  <div class="card insight-card">
    <h2 style="justify-content: center;">Kljucno zapazanje</h2>
    <p>
      Ceo zadatak se svodi na poznavanje jedne fundamentalne formule za
      tangencijalne mnogouglove. Za <em>bilo koji</em> konveksni mnogougao
      opisan oko kruga poluprecnika \(r\) vazi:
    </p>
    <div class="big-formula">
      \[ P = r \cdot \frac{O}{2} \quad \Longrightarrow \quad r = \frac{2P}{O} \]
    </div>
    <p>
      Iz uslova \(P = 5O\) odmah sledi <span class="highlight-green">\(r = \frac{2 \cdot 5O}{O} = 10\)</span>.
      Rezultat ne zavisi od oblika trapeza, vec samo od odnosa povrsine i obima.
    </p>
  </div>

  <!-- Final Answer -->
  <div class="card final-answer-card">
    <h2>Konacan odgovor</h2>
    <div class="final-answer-value">
      \(r = 10 \text{ cm}\)
    </div>
    <div class="options-row">
      <div class="option-card">(A) \(5\)</div>
      <div class="option-card">(B) \(30\)</div>
      <div class="option-card correct">(C) \(10\)</div>
      <div class="option-card">(D) \(20\)</div>
      <div class="option-card">(E) \(40\)</div>
    </div>
    <p class="verification-note">
      <strong>Verifikacija:</strong> Za \(r = 10\), iz formule \(P = r \cdot \frac{O}{2} = 10 \cdot \frac{O}{2} = 5O\).
      Uslov zadatka \(P = 5O\) je zadovoljen za proizvoljnu vrednost obima \(O\).
      Alternativno, za konkretan trapez sa osnovama 15 i 5, krakovima 10 i 10:
      \(O = 40\), \(P = \frac{15+5}{2} \cdot 20 = 200 = 5 \cdot 40\). Tacno!
    </p>
  </div>

  <!-- Common Pitfalls -->
  <div class="card">
    <h2>Ceste greske</h2>
    <ul class="pitfall-list">
      <li>
        <span class="pitfall-label">Greska 1:</span>
        Ne poznavati formulu \(P = r \cdot s\). Bez ove formule, zadatak postaje
        mnogo slozeniji jer bi trebalo uvoditi konkretne dimenzije trapeza,
        sto dovodi do sistema jednacina sa vise nepoznatih.
      </li>
      <li>
        <span class="pitfall-label">Greska 2:</span>
        Mesanje poluobima i obima. Formula glasi \(P = r \cdot s\), gde je
        \(s = \frac{O}{2}\) <em>poluobim</em>, ne ceo obim. Greska \(P = r \cdot O\)
        bi dala \(r = 5\), sto je opcija (A) &mdash; pogresan odgovor.
      </li>
      <li>
        <span class="pitfall-label">Greska 3:</span>
        Pokusaj da se postave konkretne dimenzije trapeza. Zadatak namerno
        ne daje konkretne duzine stranica &mdash; jer rezultat ne zavisi od njih.
        Formula \(P = r \cdot s\) vazi univerzalno za sve tangencijalne mnogouglove.
      </li>
      <li>
        <span class="pitfall-label">Greska 4:</span>
        Pogresno tumacenje "pet puta veca". U ovom kontekstu to znaci
        \(P = 5 \cdot O\), ne \(P = O + 5O = 6O\). U srpskom matematickom
        jeziku "pet puta veca" standardno znaci \(P = 5O\).
      </li>
    </ul>
  </div>

  <!-- Optional Challenge -->
  <div class="card challenge-card">
    <h2>Dodatni izazov</h2>
    <p>
      Pravilni sestougao je opisan oko kruga. Ako je povrsina sestougla (u cm&sup2;)
      trostruko veca od obima (u cm), koliki je poluprecnik upisanog kruga?
    </p>
    <p style="margin-top: 8px;">
      Savet: ista formula \(P = r \cdot \frac{O}{2}\) vazi i za sestougao, jer je
      on takodje tangencijalni mnogougao.
    </p>
    <details>
      <summary>Resenje</summary>
      <p style="padding-top: 10px; color: #cbd5e1;">
        Iz \(P = 3O\) i \(P = r \cdot \frac{O}{2}\) sledi
        \(r \cdot \frac{O}{2} = 3O\), tj. \(\frac{r}{2} = 3\), odakle je
        \(r = 6\) cm.
      </p>
    </details>
  </div>

</div>

<script>
(() => {
  const canvas = document.getElementById('diagramCanvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');

  const dpr = window.devicePixelRatio || 1;
  const W = 800;
  const H = 520;
  canvas.width = W * dpr;
  canvas.height = H * dpr;
  canvas.style.width = W + 'px';
  canvas.style.height = H + 'px';
  ctx.scale(dpr, dpr);

  // Colors
  var BG = '#0c1222';
  var BLUE = '#60a5fa';
  var PURPLE = '#a78bfa';
  var GREEN = '#4ade80';
  var PINK = '#f472b6';
  var TEXT = '#e2e8f0';
  var MUTED = '#94a3b8';
  var DIM = '#475569';

  // Background
  ctx.fillStyle = BG;
  ctx.fillRect(0, 0, W, H);

  // Trapezoid geometry
  // Center of circle
  var cx = 400, cy = 280;
  var r = 100; // visual radius

  // Trapezoid: top base shorter, bottom base longer
  // For a tangential trapezoid with inscribed circle radius r:
  // height = 2r
  // We'll draw with bases at y = cy - r and y = cy + r
  var topY = cy - r;
  var botY = cy + r;
  var topHalf = 70;  // half of top base
  var botHalf = 160; // half of bottom base

  // Vertices
  var A = { x: cx - botHalf, y: botY }; // bottom-left
  var B = { x: cx + botHalf, y: botY }; // bottom-right
  var C = { x: cx + topHalf, y: topY }; // top-right
  var D = { x: cx - topHalf, y: topY }; // top-left

  // Draw inscribed circle
  ctx.beginPath();
  ctx.arc(cx, cy, r, 0, 2 * Math.PI);
  ctx.strokeStyle = GREEN;
  ctx.lineWidth = 2.5;
  ctx.stroke();

  // Fill circle lightly
  ctx.beginPath();
  ctx.arc(cx, cy, r, 0, 2 * Math.PI);
  ctx.fillStyle = 'rgba(74, 222, 128, 0.06)';
  ctx.fill();

  // Draw trapezoid
  ctx.beginPath();
  ctx.moveTo(A.x, A.y);
  ctx.lineTo(B.x, B.y);
  ctx.lineTo(C.x, C.y);
  ctx.lineTo(D.x, D.y);
  ctx.closePath();
  ctx.strokeStyle = BLUE;
  ctx.lineWidth = 2.5;
  ctx.stroke();
  ctx.fillStyle = 'rgba(96, 165, 250, 0.04)';
  ctx.fill();

  // Label vertices
  function drawText(text, x, y, color, size, align, bold) {
    ctx.fillStyle = color;
    ctx.font = (bold ? 'bold ' : '') + size + 'px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = align || 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(text, x, y);
  }

  drawText('A', A.x - 16, A.y + 16, TEXT, 16, 'center', true);
  drawText('B', B.x + 16, B.y + 16, TEXT, 16, 'center', true);
  drawText('C', C.x + 16, C.y - 16, TEXT, 16, 'center', true);
  drawText('D', D.x - 16, D.y - 16, TEXT, 16, 'center', true);

  // Label sides
  // Bottom: AB = a
  drawText('a', cx, botY + 24, PINK, 15, 'center', true);
  // Top: DC = c
  drawText('c', cx, topY - 24, PINK, 15, 'center', true);
  // Left: AD = d
  var midLeft = { x: (A.x + D.x) / 2 - 20, y: (A.y + D.y) / 2 };
  drawText('d', midLeft.x, midLeft.y, PURPLE, 15, 'center', true);
  // Right: BC = b
  var midRight = { x: (B.x + C.x) / 2 + 20, y: (B.y + C.y) / 2 };
  drawText('b', midRight.x, midRight.y, PURPLE, 15, 'center', true);

  // Draw center point
  ctx.beginPath();
  ctx.arc(cx, cy, 4, 0, 2 * Math.PI);
  ctx.fillStyle = GREEN;
  ctx.fill();
  drawText('I', cx + 14, cy - 12, GREEN, 14, 'center', true);

  // Draw radius to bottom (perpendicular)
  ctx.setLineDash([5, 4]);
  ctx.strokeStyle = GREEN;
  ctx.lineWidth = 1.8;
  ctx.beginPath();
  ctx.moveTo(cx, cy);
  ctx.lineTo(cx, botY);
  ctx.stroke();
  drawText('r', cx + 14, cy + r / 2, GREEN, 15, 'center', true);

  // Draw radius to top (perpendicular)
  ctx.beginPath();
  ctx.moveTo(cx, cy);
  ctx.lineTo(cx, topY);
  ctx.stroke();
  drawText('r', cx - 14, cy - r / 2, GREEN, 15, 'center', true);

  // Draw radius to left side (perpendicular to AD)
  // Find foot of perpendicular from (cx,cy) to line AD
  function perpFoot(px, py, x1, y1, x2, y2) {
    var dx = x2 - x1, dy = y2 - y1;
    var t = ((px - x1) * dx + (py - y1) * dy) / (dx * dx + dy * dy);
    return { x: x1 + t * dx, y: y1 + t * dy };
  }

  var footLeft = perpFoot(cx, cy, A.x, A.y, D.x, D.y);
  ctx.beginPath();
  ctx.moveTo(cx, cy);
  ctx.lineTo(footLeft.x, footLeft.y);
  ctx.stroke();

  // Draw radius to right side
  var footRight = perpFoot(cx, cy, B.x, B.y, C.x, C.y);
  ctx.beginPath();
  ctx.moveTo(cx, cy);
  ctx.lineTo(footRight.x, footRight.y);
  ctx.stroke();

  // Reset line dash
  ctx.setLineDash([]);

  // Small perpendicular markers at tangent points
  function drawPerpMark(foot, lineStart, lineEnd, size) {
    var dx = lineEnd.x - lineStart.x;
    var dy = lineEnd.y - lineStart.y;
    var len = Math.sqrt(dx * dx + dy * dy);
    var ux = dx / len, uy = dy / len; // unit along the line
    var nx = -uy, ny = ux; // unit normal (toward center)

    // Determine which direction the normal should point (toward center)
    var toCx = cx - foot.x, toCy = cy - foot.y;
    if (nx * toCx + ny * toCy < 0) { nx = -nx; ny = -ny; }

    var s = size;
    ctx.strokeStyle = MUTED;
    ctx.lineWidth = 1.2;
    ctx.beginPath();
    ctx.moveTo(foot.x + ux * s, foot.y + uy * s);
    ctx.lineTo(foot.x + ux * s + nx * s, foot.y + uy * s + ny * s);
    ctx.lineTo(foot.x + nx * s, foot.y + ny * s);
    ctx.stroke();
  }

  // Bottom tangent point
  drawPerpMark({ x: cx, y: botY }, A, B, 8);
  // Top tangent point
  drawPerpMark({ x: cx, y: topY }, D, C, 8);
  // Left tangent point
  drawPerpMark(footLeft, A, D, 8);
  // Right tangent point
  drawPerpMark(footRight, B, C, 8);

  // Draw small circles at tangent points
  var tangentPoints = [
    { x: cx, y: botY },
    { x: cx, y: topY },
    footLeft,
    footRight
  ];
  tangentPoints.forEach(function(pt) {
    ctx.beginPath();
    ctx.arc(pt.x, pt.y, 3.5, 0, 2 * Math.PI);
    ctx.fillStyle = PINK;
    ctx.fill();
  });

  // Draw height marker on the right side
  var hx = cx + botHalf + 40;
  ctx.strokeStyle = DIM;
  ctx.lineWidth = 1.2;
  ctx.setLineDash([3, 3]);
  // dashes from top to marker
  ctx.beginPath();
  ctx.moveTo(cx + topHalf, topY);
  ctx.lineTo(hx + 10, topY);
  ctx.stroke();
  // dashes from bottom to marker
  ctx.beginPath();
  ctx.moveTo(cx + botHalf, botY);
  ctx.lineTo(hx + 10, botY);
  ctx.stroke();
  ctx.setLineDash([]);

  // Height arrow (double-headed)
  ctx.strokeStyle = MUTED;
  ctx.lineWidth = 1.5;
  ctx.beginPath();
  ctx.moveTo(hx, topY + 8);
  ctx.lineTo(hx, botY - 8);
  ctx.stroke();

  // Arrow heads
  ctx.fillStyle = MUTED;
  ctx.beginPath();
  ctx.moveTo(hx, topY + 4);
  ctx.lineTo(hx - 5, topY + 12);
  ctx.lineTo(hx + 5, topY + 12);
  ctx.closePath();
  ctx.fill();

  ctx.beginPath();
  ctx.moveTo(hx, botY - 4);
  ctx.lineTo(hx - 5, botY - 12);
  ctx.lineTo(hx + 5, botY - 12);
  ctx.closePath();
  ctx.fill();

  drawText('h = 2r', hx + 32, cy, MUTED, 13, 'center', true);

  // Title
  drawText('Trapez opisan oko kruga poluprecnika r', W / 2, 30, MUTED, 15, 'center', true);

  // Formula box at bottom
  var fboxY = 440;
  ctx.fillStyle = 'rgba(74, 222, 128, 0.08)';
  ctx.strokeStyle = 'rgba(74, 222, 128, 0.3)';
  ctx.lineWidth = 1.5;
  ctx.beginPath();
  ctx.roundRect(140, fboxY, 520, 60, 10);
  ctx.fill();
  ctx.stroke();

  drawText('P = r \u00B7 s = r \u00B7 O/2', W / 2, fboxY + 20, GREEN, 16, 'center', true);
  drawText('P = 5O  \u21D2  r \u00B7 O/2 = 5O  \u21D2  r = 10', W / 2, fboxY + 44, TEXT, 14, 'center', false);

  // Step interactivity
  document.querySelectorAll('.step').forEach(function(step) {
    step.addEventListener('click', function() {
      document.querySelectorAll('.step').forEach(function(s) { s.classList.remove('active'); });
      step.classList.toggle('active');
    });
  });
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Poluprecnik upisanog kruga u trapez",
  "subject": "math",
  "unit": "geometry",
  "topic_tags": ["tangencijalni mnogougao", "upisani krug", "trapez", "povrsina", "obim", "poluobim"]
}
BRAINSPARK_META-->