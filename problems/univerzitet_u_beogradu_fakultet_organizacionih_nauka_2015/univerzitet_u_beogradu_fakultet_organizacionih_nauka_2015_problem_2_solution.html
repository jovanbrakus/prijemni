<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stepen kompleksnog broja - Rešenje</title>

<script type="text/info" id="logic-scratchpad">
Problem: Ako kompleksan broj z zadovoljava jednačinu z + 2·conj(z) = 3 + i, i² = −1, onda je z^15 jednako:
A) 2^7·(i − 1); B) 2^7·(1 − i); C) 2^7·i; D) −2^7·(1 + i); E) 2^7·(1 + i)

Step 1: Let z = x + yi, where x, y are real numbers.
  Then conj(z) = x - yi.

Step 2: Substitute into the equation z + 2·conj(z) = 3 + i.
  (x + yi) + 2(x - yi) = 3 + i
  x + yi + 2x - 2yi = 3 + i
  3x - yi = 3 + i

Step 3: Equate real and imaginary parts.
  Real: 3x = 3  =>  x = 1
  Imaginary: -y = 1  =>  y = -1

Step 4: So z = 1 - i.

Step 5: Convert z to polar (trigonometric) form.
  |z| = sqrt(1^2 + (-1)^2) = sqrt(2)
  arg(z) = arctan(-1/1) = -pi/4  (fourth quadrant, since x>0, y<0)
  z = sqrt(2) · (cos(-pi/4) + i·sin(-pi/4))

Step 6: Apply De Moivre's theorem to compute z^15.
  z^15 = (sqrt(2))^15 · (cos(15·(-pi/4)) + i·sin(15·(-pi/4)))

  (sqrt(2))^15 = 2^(15/2) = 2^7 · 2^(1/2) = 128·sqrt(2)

  15·(-pi/4) = -15pi/4
  Reduce: -15pi/4 + 4pi = -15pi/4 + 16pi/4 = pi/4
  So the angle is pi/4.

Step 7: Compute z^15.
  z^15 = 128·sqrt(2) · (cos(pi/4) + i·sin(pi/4))
  cos(pi/4) = sqrt(2)/2, sin(pi/4) = sqrt(2)/2
  z^15 = 128·sqrt(2) · (sqrt(2)/2 + i·sqrt(2)/2)
  z^15 = 128·sqrt(2) · sqrt(2)/2 · (1 + i)
  z^15 = 128 · (2/2) · (1 + i)
  z^15 = 128 · (1 + i)
  z^15 = 2^7 · (1 + i)

Answer: E) 2^7·(1 + i)

Verification:
  z = 1 - i
  z^2 = (1-i)^2 = 1 - 2i + i^2 = 1 - 2i - 1 = -2i
  z^4 = (z^2)^2 = (-2i)^2 = 4i^2 = -4
  z^8 = (z^4)^2 = (-4)^2 = 16
  z^15 = z^8 · z^4 · z^2 · z^1 = 16 · (-4) · (-2i) · (1-i)
       = 16 · (-4) · (-2i) · (1-i)
       = 16 · 8i · (1-i)
       = 128i · (1-i)
       = 128i - 128i^2
       = 128i + 128
       = 128(1 + i)
       = 2^7(1 + i) ✓
</script>

<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
  min-height: 100vh;
}

.container {
  max-width: 900px;
  margin: 0 auto;
}

h1 {
  font-size: 2rem;
  font-weight: 800;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 6px;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.05rem;
  margin-bottom: 28px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 22px 26px;
  margin-bottom: 22px;
}

.card-title {
  font-size: 1.15rem;
  font-weight: 700;
  color: #60a5fa;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.card-title .badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  font-size: 0.85rem;
  font-weight: 700;
  flex-shrink: 0;
}

.badge-blue { background: rgba(96,165,250,0.18); color: #60a5fa; }
.badge-purple { background: rgba(167,139,250,0.18); color: #a78bfa; }
.badge-green { background: rgba(52,211,153,0.18); color: #34d399; }
.badge-pink { background: rgba(244,114,182,0.18); color: #f472b6; }

.problem-statement {
  border-left: 4px solid #a78bfa;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 16px;
}

.given-item {
  background: #0f172a;
  border: 1px solid #334155;
  border-radius: 10px;
  padding: 10px 16px;
  min-width: 90px;
  text-align: center;
}

.given-item .label {
  font-size: 0.8rem;
  color: #94a3b8;
  font-weight: 600;
  margin-bottom: 4px;
}

.given-item .value {
  font-size: 1rem;
  color: #e2e8f0;
  font-weight: 600;
}

.answer-option {
  transition: none;
}

.plan-card {
  border-left: 4px solid #60a5fa;
}

details {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 18px 24px;
  margin-bottom: 22px;
}

details summary {
  cursor: pointer;
  font-weight: 700;
  color: #a78bfa;
  font-size: 1.05rem;
  list-style: none;
  display: flex;
  align-items: center;
  gap: 8px;
}

details summary::-webkit-details-marker { display: none; }

details summary::before {
  content: '\25B6';
  font-size: 0.75rem;
  transition: transform 0.2s;
}

details[open] summary::before {
  transform: rotate(90deg);
}

details .theory-content {
  margin-top: 14px;
  color: #cbd5e1;
  line-height: 1.8;
}

.step-card {
  position: relative;
  padding-left: 18px;
}

.step-card::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  border-radius: 2px;
}

.step-card.step-blue::before { background: #60a5fa; }
.step-card.step-purple::before { background: #a78bfa; }
.step-card.step-green::before { background: #34d399; }
.step-card.step-pink::before { background: #f472b6; }

.checkpoint {
  background: rgba(96,165,250,0.08);
  border: 1px dashed #60a5fa;
  border-radius: 10px;
  padding: 14px 18px;
  margin: 15px 0;
  color: #94a3b8;
  font-size: 0.95rem;
}

.checkpoint strong {
  color: #60a5fa;
}

.insight-box {
  background: linear-gradient(135deg, rgba(96,165,250,0.1), rgba(167,139,250,0.1));
  border: 1px solid rgba(167,139,250,0.3);
  border-radius: 14px;
  padding: 22px 26px;
  margin-bottom: 22px;
}

.insight-box .card-title {
  color: #a78bfa;
}

.final-answer-card {
  background: linear-gradient(135deg, rgba(52,211,153,0.08), rgba(74,222,128,0.08));
  border: 2px solid #34d399;
  border-radius: 16px;
  padding: 28px 30px;
  margin-bottom: 22px;
  text-align: center;
}

.final-answer-card .label {
  color: #34d399;
  font-weight: 700;
  font-size: 1.1rem;
  margin-bottom: 10px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.final-answer-card .answer {
  color: #4ade80;
  font-size: 1.45rem;
  font-weight: 700;
  line-height: 1.6;
}

.final-answer-options {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
  margin-top: 18px;
}

.final-option {
  background: #0f172a;
  border: 1px solid #334155;
  border-radius: 8px;
  padding: 8px 16px;
  font-size: 0.95rem;
  color: #94a3b8;
}

.final-option.correct {
  border-color: #34d399;
  color: #34d399;
  background: rgba(52,211,153,0.08);
  font-weight: 700;
}

.pitfalls-card {
  border-left: 4px solid #f472b6;
}

.pitfalls-card ul {
  margin-left: 18px;
  color: #cbd5e1;
}

.pitfalls-card li {
  margin-bottom: 8px;
}

.challenge-card {
  border: 1px dashed #a78bfa;
  background: rgba(167,139,250,0.05);
}

.highlight {
  color: #60a5fa;
  font-weight: 600;
}

.highlight-green {
  color: #34d399;
  font-weight: 600;
}

.highlight-pink {
  color: #f472b6;
  font-weight: 600;
}

.highlight-purple {
  color: #a78bfa;
  font-weight: 600;
}

.math-block {
  margin: 14px 0;
  overflow-x: auto;
}

.visual-container {
  display: flex;
  justify-content: center;
  margin: 10px 0;
}

.drag-hint {
  color: #64748b;
  font-size: 0.85rem;
  text-align: center;
  margin-top: 8px;
}

canvas {
  border-radius: 12px;
  max-width: 100%;
  touch-action: none;
}

.verification-note {
  color: #94a3b8;
  margin-top: 12px;
  font-size: 0.95rem;
}

@media (max-width: 700px) {
  h1 { font-size: 1.5rem; }
  .card, .problem-statement, details, .insight-box, .final-answer-card {
    padding: 16px 18px;
  }
  .given-grid {
    flex-direction: column;
  }
  .final-answer-options {
    flex-direction: column;
    align-items: center;
  }
  body { padding: 12px; }
  .container { max-width: 100%; }
}
</style>
</head>
<body>
<div class="container">

  <!-- Title -->
  <h1>Stepen kompleksnog broja</h1>
  <p class="subtitle">Kompleksni brojevi, trigonometrijski oblik i De Moavrov teorem</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <div class="card-title"><span class="badge badge-purple">?</span> Zadatak</div>
    <p>Ako kompleksan broj \(z\) zadovoljava jednačinu \(z + 2\bar{z} = 3 + i\), \(i^2 = -1\), onda je \(z^{15}\) jednako:</p>
    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\(2^7(i - 1)\)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\(2^7(1 - i)\)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\(2^7 i\)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\(-2^7(1 + i)\)</div>
      </div>
      <div class="given-item answer-option" data-option="E">
        <div class="label">(E)</div>
        <div class="value">\(2^7(1 + i)\)</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card plan-card">
    <div class="card-title"><span class="badge badge-blue">&#9881;</span> Plan rešavanja</div>
    <p>
      Najpre ćemo iz date jednačine odrediti kompleksan broj \(z\) razdvajanjem na realni i imaginarni deo.
      Zatim ćemo \(z\) prevesti u trigonometrijski oblik i primeniti <span class="highlight">De Moavrov teorem</span> za izračunavanje \(z^{15}\).
    </p>
  </div>

  <!-- Theory Refresher -->
  <details>
    <summary>Ključne formule i teoreme</summary>
    <div class="theory-content">
      <p><strong>Kompleksni konjugat:</strong> Ako je \(z = x + yi\), tada je \(\bar{z} = x - yi\).</p>
      <p style="margin-top:10px;"><strong>Trigonometrijski oblik:</strong>
        \(z = r(\cos\varphi + i\sin\varphi)\), gde je \(r = |z| = \sqrt{x^2 + y^2}\) modul, a \(\varphi = \arg(z)\) argument.</p>
      <p style="margin-top:10px;"><strong>De Moavrov teorem:</strong>
        \[z^n = r^n \big(\cos(n\varphi) + i\sin(n\varphi)\big)\]
        Ovo je ključna formula za stepenovanje kompleksnih brojeva u trigonometrijskom obliku.</p>
      <p style="margin-top:10px;"><strong>Jednakost kompleksnih brojeva:</strong> Dva kompleksna broja su jednaka akko su im jednaki i realni i imaginarni delovi.</p>
    </div>
  </details>

  <!-- Visual Aid -->
  <div class="card">
    <div class="card-title"><span class="badge badge-blue">&#128202;</span> Kompleksna ravan</div>
    <p style="color:#94a3b8; margin-bottom: 12px;">
      Broj \(z = 1 - i\) u kompleksnoj ravni i njegovo stepenovanje. Prevucite mišem da vidite putanju stepena.
    </p>
    <div class="visual-container">
      <canvas id="complexCanvas" width="600" height="500"></canvas>
    </div>
    <p class="drag-hint">Prevucite mišem po platnu da istražite stepene broja \(z\)</p>
  </div>

  <!-- Step 1 -->
  <div class="card step-card step-blue">
    <div class="card-title"><span class="badge badge-blue">1</span> Zapišimo \(z\) u algebarskom obliku</div>
    <p>Neka je \(z = x + yi\), gde su \(x, y \in \mathbb{R}\). Tada je konjugat:</p>
    <div class="math-block">
      \[\bar{z} = x - yi\]
    </div>
    <p>Uvrstimo u jednačinu \(z + 2\bar{z} = 3 + i\):</p>
    <div class="math-block">
      \[(x + yi) + 2(x - yi) = 3 + i\]
    </div>
    <div class="math-block">
      \[x + yi + 2x - 2yi = 3 + i\]
    </div>
    <div class="math-block">
      \[3x - yi = 3 + i\]
    </div>
  </div>

  <!-- Step 2 -->
  <div class="card step-card step-purple">
    <div class="card-title"><span class="badge badge-purple">2</span> Izjednačimo realne i imaginarne delove</div>
    <p>Na levoj strani imamo realni deo \(3x\) i imaginarni deo \(-y\). Na desnoj strani realni deo je \(3\) a imaginarni je \(1\):</p>
    <div class="math-block">
      \[\begin{cases} 3x = 3 \\ -y = 1 \end{cases}\]
    </div>
    <p>Odatle:</p>
    <div class="math-block">
      \[x = 1, \quad y = -1\]
    </div>
    <p>Dakle, <span class="highlight-green">\(z = 1 - i\)</span>.</p>

    <details class="checkpoint" style="background: rgba(96,165,250,0.08); border: 1px dashed #60a5fa; border-radius: 10px; padding: 14px 18px; margin: 15px 0;">
      <summary style="color: #60a5fa; font-size: 0.95rem; font-weight: 700;">Proveri sebe: Da li \(z = 1 - i\) zaista zadovoljava jednačinu?</summary>
      <p style="margin-top: 10px; color: #94a3b8;">
        \(z + 2\bar{z} = (1-i) + 2(1+i) = 1-i+2+2i = 3+i\) &check; Tačno!
      </p>
    </details>
  </div>

  <!-- Step 3 -->
  <div class="card step-card step-blue">
    <div class="card-title"><span class="badge badge-blue">3</span> Odredimo modul i argument broja \(z\)</div>
    <p>Za \(z = 1 - i\) računamo modul:</p>
    <div class="math-block">
      \[|z| = \sqrt{1^2 + (-1)^2} = \sqrt{2}\]
    </div>
    <p>Argument (ugao) &mdash; tačka \((1, -1)\) je u <span class="highlight">IV kvadrantu</span>:</p>
    <div class="math-block">
      \[\varphi = \arg(z) = -\frac{\pi}{4}\]
    </div>
    <p>Trigonometrijski oblik:</p>
    <div class="math-block">
      \[z = \sqrt{2}\left(\cos\left(-\frac{\pi}{4}\right) + i\sin\left(-\frac{\pi}{4}\right)\right)\]
    </div>
  </div>

  <!-- Step 4 -->
  <div class="card step-card step-purple">
    <div class="card-title"><span class="badge badge-purple">4</span> Primenimo De Moavrov teorem za \(z^{15}\)</div>
    <p>Po De Moavrovom teoremu:</p>
    <div class="math-block">
      \[z^{15} = (\sqrt{2})^{15}\left(\cos\left(15 \cdot \left(-\frac{\pi}{4}\right)\right) + i\sin\left(15 \cdot \left(-\frac{\pi}{4}\right)\right)\right)\]
    </div>
    <p>Izračunajmo modul stepena:</p>
    <div class="math-block">
      \[(\sqrt{2})^{15} = 2^{15/2} = 2^7 \cdot 2^{1/2} = 128\sqrt{2}\]
    </div>
    <p>Izračunajmo ugao:</p>
    <div class="math-block">
      \[15 \cdot \left(-\frac{\pi}{4}\right) = -\frac{15\pi}{4}\]
    </div>
  </div>

  <!-- Step 5 -->
  <div class="card step-card step-pink">
    <div class="card-title"><span class="badge badge-pink">5</span> Svedimo ugao na interval \([0, 2\pi)\)</div>
    <p>Ugao \(-\frac{15\pi}{4}\) svedemo dodavanjem celih umnožaka od \(2\pi\):</p>
    <div class="math-block">
      \[-\frac{15\pi}{4} + 2 \cdot 2\pi = -\frac{15\pi}{4} + \frac{16\pi}{4} = \frac{\pi}{4}\]
    </div>
    <p>Dakle, <span class="highlight">efektivni ugao je \(\frac{\pi}{4}\)</span>, što odgovara tačno \(45°\) u I kvadrantu.</p>

    <details class="checkpoint" style="background: rgba(96,165,250,0.08); border: 1px dashed #60a5fa; border-radius: 10px; padding: 14px 18px; margin: 15px 0;">
      <summary style="color: #60a5fa; font-size: 0.95rem; font-weight: 700;">Proveri sebe: Zašto dodajemo \(4\pi\)?</summary>
      <p style="margin-top: 10px; color: #94a3b8;">
        Jer je \(\cos\) i \(\sin\) periodične sa periodom \(2\pi\). Dodajemo \(2 \times 2\pi = 4\pi\)
        da bismo dobili pozitivan ugao. Možemo dodati ili oduzeti \(2\pi\) koliko god puta želimo
        &mdash; vrednosti trigonometrijskih funkcija se ne menjaju.
      </p>
    </details>
  </div>

  <!-- Step 6 -->
  <div class="card step-card step-green">
    <div class="card-title"><span class="badge badge-green">6</span> Izračunajmo konačnu vrednost</div>
    <p>Sada imamo:</p>
    <div class="math-block">
      \[z^{15} = 128\sqrt{2}\left(\cos\frac{\pi}{4} + i\sin\frac{\pi}{4}\right)\]
    </div>
    <p>Znamo da je \(\cos\frac{\pi}{4} = \frac{\sqrt{2}}{2}\) i \(\sin\frac{\pi}{4} = \frac{\sqrt{2}}{2}\), pa:</p>
    <div class="math-block">
      \[z^{15} = 128\sqrt{2} \cdot \frac{\sqrt{2}}{2}(1 + i) = 128 \cdot \frac{2}{2} \cdot (1+i) = 128(1+i)\]
    </div>
    <p>Pošto je \(128 = 2^7\):</p>
    <div class="math-block">
      \[\boxed{z^{15} = 2^7(1 + i)}\]
    </div>
  </div>

  <!-- Key Insight -->
  <div class="insight-box">
    <div class="card-title"><span class="badge badge-purple">&#128161;</span> Ključni uvid</div>
    <p>
      Umesto da množimo \(z = 1 - i\) petnaest puta, koristimo <span class="highlight-purple">trigonometrijski oblik</span>
      i <span class="highlight">De Moavrov teorem</span> &mdash; dovoljno je stepenovanje modula i množenje ugla.
      Ceo problem se svodi na pravilno svođenje ugla \(-\frac{15\pi}{4}\) na ekvivalentan ugao \(\frac{\pi}{4}\).
    </p>
    <p style="margin-top: 10px;">
      Alternativno, možemo koristiti sukcesivno stepenovanje:
      \(z^2 = -2i\), \(z^4 = -4\), \(z^8 = 16\), pa \(z^{15} = z^8 \cdot z^4 \cdot z^2 \cdot z = 128(1+i)\).
    </p>
  </div>

  <!-- Final Answer -->
  <div class="final-answer-card">
    <div class="label">Konačan odgovor</div>
    <div class="answer">\(z^{15} = 2^7(1 + i) = 128(1 + i)\)</div>
    <div class="final-answer-options">
      <span class="final-option">(A) \(2^7(i-1)\)</span>
      <span class="final-option">(B) \(2^7(1-i)\)</span>
      <span class="final-option">(C) \(2^7 i\)</span>
      <span class="final-option">(D) \(-2^7(1+i)\)</span>
      <span class="final-option correct">(E) \(2^7(1+i)\)</span>
    </div>
    <p class="verification-note">
      <strong>Verifikacija:</strong> \(z^2 = (1-i)^2 = -2i\), \(z^4 = -4\), \(z^8 = 16\),
      \(z^{15} = 16 \cdot (-4) \cdot (-2i) \cdot (1-i) = 128i(1-i) = 128(i - i^2) = 128(1+i)\) &check;
    </p>
  </div>

  <!-- Common Pitfalls -->
  <div class="card pitfalls-card">
    <div class="card-title"><span class="badge badge-pink">&#9888;</span> Česte greške</div>
    <ul>
      <li><strong>Pogrešan znak kod konjugata:</strong> Lako je zaboraviti da konjugat \(\bar{z}\) menja znak imaginarnog dela. Ako je \(z = x + yi\), onda je \(\bar{z} = x - yi\), a ne \(-x + yi\).</li>
      <li><strong>Greška pri svođenju ugla:</strong> Ugao \(-\frac{15\pi}{4}\) se mora svesti na ekvivalentan ugao u intervalu \([0, 2\pi)\). Pogrešno svođenje daje potpuno drugačiji rezultat.</li>
      <li><strong>Zaboravljanje faktora \(\sqrt{2}\):</strong> Modul \((\sqrt{2})^{15} = 128\sqrt{2}\), ne \(128\). Taj \(\sqrt{2}\) se „poništi" sa \(\cos\frac{\pi}{4} = \frac{\sqrt{2}}{2}\), ali ga ne smemo izostaviti pre toga.</li>
    </ul>
  </div>

  <!-- Optional Challenge -->
  <div class="card challenge-card">
    <div class="card-title"><span class="badge badge-purple">&#127942;</span> Dodatni izazov</div>
    <p>Ako je \(z + 2\bar{z} = 3 + i\), koliko iznosi \(z^{30}\)?</p>
    <details style="margin: 15px 0; background: transparent; border: none; padding: 0;">
      <summary style="color: #a78bfa; font-size: 0.9rem;">Savet</summary>
      <p style="margin-top: 8px; color: #94a3b8;">
        Primetite da je \(z^{30} = (z^{15})^2\). Već znamo da je \(z^{15} = 128(1+i)\), pa treba samo izračunati \((128(1+i))^2 = 128^2 \cdot (1+i)^2 = 16384 \cdot 2i = 32768i = 2^{15}i\).
      </p>
    </details>
  </div>

</div>

<script>
(() => {
  const canvas = document.getElementById('complexCanvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const W = canvas.width;
  const H = canvas.height;

  const centerX = W / 2;
  const centerY = H / 2;
  const scale = 38;

  let hoverPower = -1;

  // z = 1 - i
  const zRe = 1, zIm = -1;
  const zMod = Math.sqrt(2);
  const zArg = -Math.PI / 4;

  // Precompute powers z^1 through z^15
  const powers = [];
  let re = 1, im = 0;
  for (let n = 1; n <= 15; n++) {
    const newRe = re * zRe - im * zIm;
    const newIm = re * zIm + im * zRe;
    re = newRe;
    im = newIm;
    powers.push({ n: n, re: re, im: im });
  }

  function toCanvasX(x) { return centerX + x * scale; }
  function toCanvasY(y) { return centerY - y * scale; }
  function fromCanvasX(cx) { return (cx - centerX) / scale; }
  function fromCanvasY(cy) { return (centerY - cy) / scale; }

  function draw() {
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    // Grid
    ctx.strokeStyle = '#1e293b';
    ctx.lineWidth = 0.5;
    const range = 7;
    for (let x = -range; x <= range; x++) {
      ctx.beginPath();
      ctx.moveTo(toCanvasX(x), 0);
      ctx.lineTo(toCanvasX(x), H);
      ctx.stroke();
    }
    for (let y = -range; y <= range; y++) {
      ctx.beginPath();
      ctx.moveTo(0, toCanvasY(y));
      ctx.lineTo(W, toCanvasY(y));
      ctx.stroke();
    }

    // Axes
    ctx.strokeStyle = '#475569';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(0, centerY);
    ctx.lineTo(W, centerY);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(centerX, 0);
    ctx.lineTo(centerX, H);
    ctx.stroke();

    // Axis labels
    ctx.fillStyle = '#64748b';
    ctx.font = '11px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    for (let x = -range; x <= range; x++) {
      if (x === 0) continue;
      ctx.fillText(x.toString(), toCanvasX(x), centerY + 16);
    }
    ctx.textAlign = 'right';
    for (let y = -range; y <= range; y++) {
      if (y === 0) continue;
      ctx.fillText(y + 'i', centerX - 6, toCanvasY(y) + 4);
    }
    ctx.textAlign = 'left';
    ctx.fillStyle = '#94a3b8';
    ctx.font = 'bold 13px Segoe UI, system-ui, sans-serif';
    ctx.fillText('Re', W - 24, centerY - 8);
    ctx.fillText('Im', centerX + 8, 16);

    // Unit circle (dashed)
    ctx.setLineDash([4, 4]);
    ctx.strokeStyle = '#334155';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.arc(centerX, centerY, scale, 0, 2 * Math.PI);
    ctx.stroke();
    ctx.setLineDash([]);

    // Draw spiral path through powers
    ctx.strokeStyle = 'rgba(96, 165, 250, 0.25)';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(toCanvasX(0), toCanvasY(0));
    for (let i = 0; i < powers.length; i++) {
      const p = powers[i];
      // Scale down for visibility
      const displayScale = getDisplayScale(p);
      const dx = p.re * displayScale;
      const dy = p.im * displayScale;
      ctx.lineTo(toCanvasX(dx), toCanvasY(dy));
    }
    ctx.stroke();

    // Draw power points
    for (let i = 0; i < powers.length; i++) {
      const p = powers[i];
      const displayScale = getDisplayScale(p);
      const dx = p.re * displayScale;
      const dy = p.im * displayScale;
      const cx = toCanvasX(dx);
      const cy = toCanvasY(dy);

      const isHighlighted = (hoverPower === p.n);
      const isTarget = (p.n === 15);

      let radius = 5;
      let color = '#60a5fa';
      let alpha = 0.7;

      if (isTarget) {
        color = '#4ade80';
        radius = 8;
        alpha = 1.0;
      } else if (isHighlighted) {
        color = '#f472b6';
        radius = 7;
        alpha = 1.0;
      } else if (p.n <= 4) {
        color = '#a78bfa';
        alpha = 0.9;
      }

      // Glow for target
      if (isTarget) {
        const grad = ctx.createRadialGradient(cx, cy, 0, cx, cy, 20);
        grad.addColorStop(0, 'rgba(74, 222, 128, 0.3)');
        grad.addColorStop(1, 'rgba(74, 222, 128, 0)');
        ctx.fillStyle = grad;
        ctx.beginPath();
        ctx.arc(cx, cy, 20, 0, 2 * Math.PI);
        ctx.fill();
      }

      ctx.globalAlpha = alpha;
      ctx.fillStyle = color;
      ctx.beginPath();
      ctx.arc(cx, cy, radius, 0, 2 * Math.PI);
      ctx.fill();
      ctx.globalAlpha = 1.0;

      // Label
      ctx.fillStyle = color;
      ctx.font = (isTarget || isHighlighted) ? 'bold 12px Segoe UI, system-ui, sans-serif' : '10px Segoe UI, system-ui, sans-serif';
      const labelText = 'z' + superscript(p.n);
      const offsetX = 10;
      const offsetY = -10;
      ctx.fillText(labelText, cx + offsetX, cy + offsetY);

      // Show value on hover or for z^15
      if (isHighlighted || isTarget) {
        ctx.font = '11px Segoe UI, system-ui, sans-serif';
        ctx.fillStyle = '#94a3b8';
        const valStr = formatComplex(p.re, p.im);
        ctx.fillText(valStr, cx + offsetX, cy + offsetY + 14);
      }
    }

    // Draw z = 1 - i point
    const zCx = toCanvasX(zRe);
    const zCy = toCanvasY(zIm);
    ctx.fillStyle = '#a78bfa';
    ctx.beginPath();
    ctx.arc(zCx, zCy, 6, 0, 2 * Math.PI);
    ctx.fill();
    ctx.fillStyle = '#a78bfa';
    ctx.font = 'bold 13px Segoe UI, system-ui, sans-serif';
    ctx.fillText('z = 1 - i', zCx + 10, zCy - 8);

    // Draw angle arc for z
    ctx.strokeStyle = '#a78bfa';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([3, 3]);
    ctx.beginPath();
    ctx.moveTo(centerX, centerY);
    ctx.lineTo(zCx, zCy);
    ctx.stroke();
    ctx.setLineDash([]);

    ctx.strokeStyle = 'rgba(167, 139, 250, 0.5)';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.arc(centerX, centerY, 25, 0, Math.PI / 4, true);
    ctx.stroke();
    ctx.fillStyle = '#a78bfa';
    ctx.font = '10px Segoe UI, system-ui, sans-serif';
    ctx.fillText('-45\u00B0', centerX + 28, centerY + 14);

    // Legend
    ctx.fillStyle = '#a78bfa';
    ctx.font = 'bold 12px Segoe UI, system-ui, sans-serif';
    ctx.fillText('\u25CF z = 1 - i', 14, 22);
    ctx.fillStyle = '#60a5fa';
    ctx.fillText('\u25CF Stepeni z\u00B2 do z\u00B9\u2074', 14, 40);
    ctx.fillStyle = '#4ade80';
    ctx.fillText('\u25CF z\u00B9\u2075 = 128(1+i)', 14, 58);
    ctx.fillStyle = '#64748b';
    ctx.font = '11px Segoe UI, system-ui, sans-serif';
    ctx.fillText('(skaliran prikaz za veliku razliku modula)', 14, 76);
  }

  function getDisplayScale(p) {
    // Use logarithmic scaling so all points fit on canvas
    const mod = Math.sqrt(p.re * p.re + p.im * p.im);
    if (mod < 0.001) return 1;
    const logMod = Math.log2(mod + 1);
    const maxLogMod = Math.log2(Math.pow(zMod, 15) + 1);
    const targetRadius = 5.5;
    return targetRadius * logMod / (maxLogMod * mod) * mod / mod;
  }

  function getDisplayScale(p) {
    const mod = Math.sqrt(p.re * p.re + p.im * p.im);
    if (mod < 0.001) return 1;
    // Logarithmic scaling: display radius proportional to log(mod)
    const displayR = 1.2 + Math.log2(mod) * 0.7;
    return displayR / mod;
  }

  function superscript(n) {
    const sup = ['\u2070', '\u00B9', '\u00B2', '\u00B3', '\u2074', '\u2075', '\u2076', '\u2077', '\u2078', '\u2079'];
    if (n < 10) return sup[n];
    return sup[Math.floor(n / 10)] + sup[n % 10];
  }

  function formatComplex(re, im) {
    re = Math.round(re);
    im = Math.round(im);
    if (im === 0) return re.toString();
    if (re === 0) {
      if (im === 1) return 'i';
      if (im === -1) return '-i';
      return im + 'i';
    }
    const imStr = im === 1 ? 'i' : im === -1 ? '-i' : (im > 0 ? '+' + im + 'i' : im + 'i');
    return re + (im > 0 ? '+' : '') + (Math.abs(im) === 1 ? (im > 0 ? 'i' : '-i') : im + 'i');
  }

  // Mouse hover for interactivity
  function getClosestPower(mx, my) {
    let closest = -1;
    let minDist = 25;
    for (let i = 0; i < powers.length; i++) {
      const p = powers[i];
      const ds = getDisplayScale(p);
      const cx = toCanvasX(p.re * ds);
      const cy = toCanvasY(p.im * ds);
      const d = Math.sqrt((mx - cx) * (mx - cx) + (my - cy) * (my - cy));
      if (d < minDist) {
        minDist = d;
        closest = p.n;
      }
    }
    return closest;
  }

  function handleMove(clientX, clientY) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = W / rect.width;
    const scaleY = H / rect.height;
    const mx = (clientX - rect.left) * scaleX;
    const my = (clientY - rect.top) * scaleY;
    const newHover = getClosestPower(mx, my);
    if (newHover !== hoverPower) {
      hoverPower = newHover;
      draw();
    }
  }

  canvas.addEventListener('mousemove', function(e) {
    handleMove(e.clientX, e.clientY);
  });

  canvas.addEventListener('touchmove', function(e) {
    e.preventDefault();
    if (e.touches.length > 0) {
      handleMove(e.touches[0].clientX, e.touches[0].clientY);
    }
  });

  canvas.addEventListener('mouseleave', function() {
    hoverPower = -1;
    draw();
  });

  draw();
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Stepen kompleksnog broja primenom De Moavrovog teorema",
  "subject": "math",
  "unit": "algebra",
  "topic_tags": ["kompleksni brojevi", "De Moavrov teorem", "trigonometrijski oblik", "stepenovanje", "konjugat kompleksnog broja"]
}
BRAINSPARK_META-->