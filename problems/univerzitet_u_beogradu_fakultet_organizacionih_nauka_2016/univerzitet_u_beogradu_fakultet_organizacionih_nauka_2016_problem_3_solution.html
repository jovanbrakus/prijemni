<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kompozicija racionalnih funkcija</title>
<script type="text/info" id="logic-scratchpad">
Problem: f(x) = (x+2)/(x-2) for x ≠ 2, g(x) = f(f(x)) + f(x-4) for x ≠ 6. Find g(x).

Step 1: Compute f(f(x))
f(x) = (x+2)/(x-2)
f(f(x)) = f((x+2)/(x-2))
         = ( (x+2)/(x-2) + 2 ) / ( (x+2)/(x-2) - 2 )

Numerator: (x+2)/(x-2) + 2 = (x+2 + 2(x-2))/(x-2) = (x+2+2x-4)/(x-2) = (3x-2)/(x-2)
Denominator: (x+2)/(x-2) - 2 = (x+2 - 2(x-2))/(x-2) = (x+2-2x+4)/(x-2) = (6-x)/(x-2)

f(f(x)) = (3x-2)/(x-2) * (x-2)/(6-x) = (3x-2)/(6-x)

Step 2: Compute f(x-4)
f(x-4) = ((x-4)+2)/((x-4)-2) = (x-2)/(x-6)

Step 3: Compute g(x) = f(f(x)) + f(x-4)
g(x) = (3x-2)/(6-x) + (x-2)/(x-6)

Note: 6-x = -(x-6), so (3x-2)/(6-x) = -(3x-2)/(x-6)

g(x) = -(3x-2)/(x-6) + (x-2)/(x-6)
      = (-(3x-2) + (x-2))/(x-6)
      = (-3x+2+x-2)/(x-6)
      = -2x/(x-6)
      = 2x/(6-x)

Answer: B) g(x) = 2x/(6-x)

Verification with x=0:
f(0) = 2/(-2) = -1
f(f(0)) = f(-1) = 1/(-3) = -1/3
f(0-4) = f(-4) = (-2)/(-6) = 1/3
g(0) = -1/3 + 1/3 = 0
Check B: 2*0/(6-0) = 0 ✓

Verification with x=4:
f(4) = 6/2 = 3
f(f(4)) = f(3) = 5/1 = 5
f(4-4) = f(0) = -1
g(4) = 5 + (-1) = 4
Check B: 2*4/(6-4) = 8/2 = 4 ✓
</script>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 10px;
}

h1 {
  font-size: 2.2rem;
  font-weight: 700;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 30px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.4rem;
  margin-bottom: 16px;
}

.card h3 {
  color: #e2e8f0;
  font-size: 1.15rem;
  margin-bottom: 10px;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.given-item {
  background: rgba(56,189,248,0.06);
  border: 1px solid rgba(56,189,248,0.12);
  border-radius: 10px;
  padding: 12px 16px;
  min-width: 120px;
  flex: 1;
  text-align: center;
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-bottom: 4px;
  font-weight: 600;
}

.given-item .value {
  color: #e2e8f0;
  font-size: 1rem;
}

.math-block {
  background: rgba(56,189,248,0.08);
  border: 1px solid rgba(56,189,248,0.15);
  border-radius: 8px;
  padding: 14px 18px;
  margin: 12px 0;
  overflow-x: auto;
}

.step-container {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
  padding: 16px;
  border-radius: 10px;
  border-left: 3px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
}

.step-container:hover {
  background: rgba(96,165,250,0.04);
  border-left-color: #4ade80;
}

.step-container.active {
  border-left-color: #4ade80;
  background: rgba(74,222,128,0.04);
}

.step-badge {
  width: 32px;
  height: 32px;
  min-width: 32px;
  border-radius: 50%;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.9rem;
  margin-top: 2px;
}

.step-content {
  flex: 1;
}

.step-content h3 {
  margin-bottom: 8px;
}

.step-content p {
  color: #c4cede;
  margin-bottom: 8px;
}

.note {
  color: #94a3b8;
  font-size: 0.9rem;
  font-style: italic;
  margin-top: 6px;
}

details {
  margin: 15px 0;
}

details summary {
  cursor: pointer;
  color: #60a5fa;
  font-weight: 600;
  font-size: 1rem;
  padding: 8px 0;
}

details summary:hover {
  color: #93bbfc;
}

.checkpoint {
  background: rgba(74,222,128,0.06);
  border: 1px solid rgba(74,222,128,0.15);
  border-radius: 10px;
  padding: 14px 18px;
  margin: 15px 0;
}

.checkpoint summary {
  color: #4ade80;
}

.insight-box {
  background: linear-gradient(135deg, rgba(96,165,250,0.12), rgba(167,139,250,0.12));
  border: 1px solid rgba(96,165,250,0.25);
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  text-align: center;
}

.insight-box .insight-label {
  color: #a78bfa;
  font-size: 0.9rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 10px;
}

.final-answer {
  background: rgba(74,222,128,0.08);
  border: 1px solid rgba(74,222,128,0.2);
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  text-align: center;
}

.final-answer h2 {
  color: #4ade80;
  margin-bottom: 14px;
}

.final-answer .answer-text {
  font-size: 1.6rem;
  color: #4ade80;
  font-weight: 700;
  margin-bottom: 14px;
}

.options-review {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
  margin: 16px 0;
}

.option-card {
  padding: 10px 18px;
  border-radius: 8px;
  border: 1px solid #334155;
  background: #1e293b;
  color: #94a3b8;
  font-size: 0.95rem;
}

.option-card.correct {
  border-color: #4ade80;
  background: rgba(74,222,128,0.1);
  color: #4ade80;
  font-weight: 700;
}

.verification {
  color: #94a3b8;
  font-size: 0.9rem;
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid rgba(74,222,128,0.15);
}

.pitfall {
  color: #e09468;
  padding-left: 12px;
  border-left: 3px solid #e09468;
  margin-bottom: 10px;
}

.highlight {
  color: #f472b6;
  font-weight: 600;
}

canvas {
  touch-action: none;
  width: 100%;
  border-radius: 10px;
}

.canvas-hint {
  color: #64748b;
  font-size: 0.8rem;
  text-align: center;
  margin-top: 6px;
}

.theory-card {
  background: rgba(167,139,250,0.06);
  border: 1px solid rgba(167,139,250,0.15);
  border-radius: 12px;
  padding: 18px;
}

.theory-card ul {
  list-style: none;
  padding-left: 0;
}

.theory-card li {
  padding: 6px 0;
  border-bottom: 1px solid rgba(167,139,250,0.08);
  color: #c4cede;
}

.theory-card li:last-child {
  border-bottom: none;
}

@media (max-width: 700px) {
  h1 { font-size: 1.6rem; }
  .card { padding: 16px; }
  .given-item { min-width: 80px; padding: 8px 10px; }
  .step-container { padding: 10px; }
  .options-review { flex-direction: column; align-items: center; }
}
</style>
</head>
<body>
<div class="container">

  <!-- Title & Subtitle -->
  <h1>Kompozicija racionalnih funkcija</h1>
  <p class="subtitle">Racionalne funkcije, kompozicija funkcija i sabiranje razlomaka</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <h2>Tekst zadatka</h2>
    <p>Neka je \( f(x) = \dfrac{x+2}{x-2} \) za \( x \neq 2 \) i \( g(x) = f(f(x)) + f(x-4) \) za \( x \neq 6 \). Tada je:</p>

    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\( g(x) = \dfrac{x-2}{x-6} \)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\( g(x) = \dfrac{2x}{6-x} \)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\( g(x) = \dfrac{2x}{x-6} \)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\( g(x) = \dfrac{x-2}{6-x} \)</div>
      </div>
      <div class="given-item answer-option" data-option="E">
        <div class="label">(E)</div>
        <div class="value">\( g(x) = \dfrac{3x-2}{6-x} \)</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card">
    <h2>Plan resavanja</h2>
    <p>Izracunacemo \( f(f(x)) \) uvrstanjem funkcije \( f \) u samu sebe, zatim \( f(x-4) \) prostom zamenom argumenta, i na kraju saberemo oba izraza svodecu na zajednicki imenilac.</p>
  </div>

  <!-- Theory Refresher -->
  <div class="card">
    <details>
      <summary>Kljucne formule i pojmovi</summary>
      <div class="theory-card">
        <ul>
          <li><strong>Kompozicija funkcija:</strong> \( f(f(x)) = f \circ f(x) \) znaci da rezultat funkcije \( f(x) \) uvrstimo kao argument u istu funkciju \( f \).</li>
          <li><strong>Sabiranje razlomaka:</strong> \( \dfrac{a}{b} + \dfrac{c}{d} = \dfrac{ad + bc}{bd} \). Kad imenilac prvog razlomka bude suprotan drugom (\( b = -d \)), treba pazljivo svesti na zajednicki imenilac.</li>
          <li><strong>Svodjenje na zajednicki imenilac:</strong> Ako je \( 6-x = -(x-6) \), tada \( \dfrac{a}{6-x} = \dfrac{-a}{x-6} \).</li>
          <li><strong>Domen racionalne funkcije:</strong> Razlomak \( \dfrac{P(x)}{Q(x)} \) je definisan za sve \( x \) gde \( Q(x) \neq 0 \).</li>
        </ul>
      </div>
    </details>
  </div>

  <!-- Visual Aid -->
  <div class="card">
    <h2>Graficki prikaz</h2>
    <p style="color:#94a3b8; margin-bottom:12px;">Grafik funkcije \( g(x) = \dfrac{2x}{6-x} \) sa vertikalnom asimptotom \( x = 6 \) i horizontalnom asimptotom \( y = -2 \).</p>
    <canvas id="graphCanvas" width="800" height="500"></canvas>
    <p class="canvas-hint">Prevucite misem ili prstom za pomicanje pogleda</p>
  </div>

  <!-- Step-by-Step Solution -->
  <div class="card">
    <h2>Resenje korak po korak</h2>

    <!-- Step 1 -->
    <div class="step-container" id="step1">
      <div class="step-badge">1</div>
      <div class="step-content">
        <h3>Zapisujemo funkciju \( f(x) \)</h3>
        <p>Data nam je racionalna funkcija:</p>
        <div class="math-block">
          \[ f(x) = \frac{x+2}{x-2}, \quad x \neq 2 \]
        </div>
        <p class="note">Ova funkcija nije definisana za \( x = 2 \) jer bi imenilac bio nula.</p>
      </div>
    </div>

    <!-- Step 2 -->
    <div class="step-container" id="step2">
      <div class="step-badge">2</div>
      <div class="step-content">
        <h3>Racunamo \( f(f(x)) \) &mdash; uvrstavanje u kompoziciju</h3>
        <p>Uvrstimo \( f(x) = \dfrac{x+2}{x-2} \) umesto \( x \) u formulu za \( f \):</p>
        <div class="math-block">
          \[ f(f(x)) = f\!\left(\frac{x+2}{x-2}\right) = \frac{\dfrac{x+2}{x-2} + 2}{\dfrac{x+2}{x-2} - 2} \]
        </div>
      </div>
    </div>

    <!-- Step 3 -->
    <div class="step-container" id="step3">
      <div class="step-badge">3</div>
      <div class="step-content">
        <h3>Sredjujemo brojilac kompozicije</h3>
        <p>Sabiramo razlomak i ceo broj u brojiocu:</p>
        <div class="math-block">
          \[ \frac{x+2}{x-2} + 2 = \frac{x+2 + 2(x-2)}{x-2} = \frac{x+2+2x-4}{x-2} = \frac{3x-2}{x-2} \]
        </div>
      </div>
    </div>

    <!-- Step 4 -->
    <div class="step-container" id="step4">
      <div class="step-badge">4</div>
      <div class="step-content">
        <h3>Sredjujemo imenilac kompozicije</h3>
        <p>Isto radimo i sa imeniocem:</p>
        <div class="math-block">
          \[ \frac{x+2}{x-2} - 2 = \frac{x+2 - 2(x-2)}{x-2} = \frac{x+2-2x+4}{x-2} = \frac{6-x}{x-2} \]
        </div>
      </div>
    </div>

    <!-- Step 5 -->
    <div class="step-container" id="step5">
      <div class="step-badge">5</div>
      <div class="step-content">
        <h3>Dobijamo \( f(f(x)) \)</h3>
        <p>Delimo brojilac imeniocem (mnozimo brojiocevim reciprocnim imeniocem):</p>
        <div class="math-block">
          \[ f(f(x)) = \frac{\dfrac{3x-2}{x-2}}{\dfrac{6-x}{x-2}} = \frac{3x-2}{x-2} \cdot \frac{x-2}{6-x} = \frac{3x-2}{6-x} \]
        </div>
        <p class="note">Faktor \( (x-2) \) se skratio. Primetimo da mora biti \( x \neq 6 \).</p>
      </div>
    </div>

    <!-- Checkpoint 1 -->
    <details class="checkpoint">
      <summary>Proveri sebe: Koliko iznosi \( f(f(4)) \)?</summary>
      <p style="margin-top:8px;">
        \( f(4) = \dfrac{4+2}{4-2} = \dfrac{6}{2} = 3 \), pa \( f(f(4)) = f(3) = \dfrac{3+2}{3-2} = \dfrac{5}{1} = 5 \).
        <br>Proveravamo formulom: \( \dfrac{3 \cdot 4 - 2}{6 - 4} = \dfrac{10}{2} = 5 \). Tacno!
      </p>
    </details>

    <!-- Step 6 -->
    <div class="step-container" id="step6">
      <div class="step-badge">6</div>
      <div class="step-content">
        <h3>Racunamo \( f(x-4) \)</h3>
        <p>Zamenjujemo \( x \) sa \( x-4 \) u formuli za \( f \):</p>
        <div class="math-block">
          \[ f(x-4) = \frac{(x-4)+2}{(x-4)-2} = \frac{x-2}{x-6} \]
        </div>
        <p class="note">I ovde mora biti \( x \neq 6 \) da imenilac ne bi bio nula.</p>
      </div>
    </div>

    <!-- Step 7 -->
    <div class="step-container" id="step7">
      <div class="step-badge">7</div>
      <div class="step-content">
        <h3>Sabiramo \( f(f(x)) + f(x-4) \)</h3>
        <p>Zapisujemo oba razlomka:</p>
        <div class="math-block">
          \[ g(x) = \frac{3x-2}{6-x} + \frac{x-2}{x-6} \]
        </div>
        <p>Primetimo da je \( 6-x = -(x-6) \), pa mozemo zapisati:</p>
        <div class="math-block">
          \[ \frac{3x-2}{6-x} = \frac{-(3x-2)}{x-6} = \frac{-3x+2}{x-6} \]
        </div>
      </div>
    </div>

    <!-- Step 8 -->
    <div class="step-container" id="step8">
      <div class="step-badge">8</div>
      <div class="step-content">
        <h3>Sredjujemo zbir na zajednicki imenilac</h3>
        <p>Sada oba razlomka imaju isti imenilac \( (x-6) \):</p>
        <div class="math-block">
          \[ g(x) = \frac{-3x+2}{x-6} + \frac{x-2}{x-6} = \frac{-3x+2+x-2}{x-6} \]
        </div>
      </div>
    </div>

    <!-- Step 9 -->
    <div class="step-container" id="step9">
      <div class="step-badge">9</div>
      <div class="step-content">
        <h3>Pojednostavljujemo brojilac</h3>
        <p>Saberemo clanove u brojiocu:</p>
        <div class="math-block">
          \[ g(x) = \frac{-3x + x + 2 - 2}{x-6} = \frac{-2x}{x-6} \]
        </div>
        <p>Mnozimo brojilac i imenilac sa \( -1 \):</p>
        <div class="math-block">
          \[ g(x) = \frac{-2x}{x-6} = \frac{2x}{-(x-6)} = \frac{2x}{6-x} \]
        </div>
      </div>
    </div>

    <!-- Checkpoint 2 -->
    <details class="checkpoint">
      <summary>Proveri sebe: Koliko iznosi \( g(4) \)?</summary>
      <p style="margin-top:8px;">
        Iz prethodnog smo izracunali: \( f(f(4)) = 5 \) i \( f(0) = -1 \), dakle \( g(4) = 5 + (-1) = 4 \).
        <br>Proveravamo: \( \dfrac{2 \cdot 4}{6 - 4} = \dfrac{8}{2} = 4 \). Tacno!
      </p>
    </details>

    <!-- Checkpoint 3 -->
    <details class="checkpoint">
      <summary>Proveri sebe: Da li je \( g(0) = 0 \)?</summary>
      <p style="margin-top:8px;">
        \( f(0) = \dfrac{2}{-2} = -1 \), \( f(f(0)) = f(-1) = \dfrac{1}{-3} = -\dfrac{1}{3} \).
        <br>\( f(-4) = \dfrac{-2}{-6} = \dfrac{1}{3} \).
        <br>\( g(0) = -\dfrac{1}{3} + \dfrac{1}{3} = 0 \).
        <br>Formula: \( \dfrac{2 \cdot 0}{6 - 0} = 0 \). Tacno!
      </p>
    </details>
  </div>

  <!-- Key Insight -->
  <div class="insight-box">
    <div class="insight-label">Kljucni uvid</div>
    <p style="color:#e2e8f0; margin-bottom:12px;">Kompozicija \( f(f(x)) \) i zamena argumenta \( f(x-4) \) daju razlomke sa <span class="highlight">suprotnim imeniocima</span> \((6-x)\) i \((x-6)\), sto nakon svodjenja na zajednicki imenilac dovodi do velikog pojednostavljenja:</p>
    <div class="math-block" style="font-size:1.3rem; text-align:center;">
      \[ g(x) = \frac{3x-2}{6-x} + \frac{x-2}{x-6} = \frac{2x}{6-x} \]
    </div>
  </div>

  <!-- Final Answer -->
  <div class="final-answer">
    <h2>Konacan odgovor</h2>
    <div class="answer-text">\( g(x) = \dfrac{2x}{6-x} \)</div>

    <div class="options-review">
      <div class="option-card">(A) \( \dfrac{x-2}{x-6} \)</div>
      <div class="option-card correct">(B) \( \dfrac{2x}{6-x} \)</div>
      <div class="option-card">(C) \( \dfrac{2x}{x-6} \)</div>
      <div class="option-card">(D) \( \dfrac{x-2}{6-x} \)</div>
      <div class="option-card">(E) \( \dfrac{3x-2}{6-x} \)</div>
    </div>

    <p style="color:#4ade80; font-weight:600; font-size:1.1rem; margin-top:10px;">Tacan odgovor je (B).</p>

    <div class="verification">
      <strong>Verifikacija:</strong> Proverili smo za \( x = 0 \): \( g(0) = 0 \) i formula daje \( \frac{0}{6} = 0 \). Za \( x = 4 \): \( g(4) = 4 \) i formula daje \( \frac{8}{2} = 4 \). Odgovor (E) \( \frac{3x-2}{6-x} \) bi za \( x = 0 \) davao \( \frac{-2}{6} = -\frac{1}{3} \neq 0 \), pa se odbacuje. Odgovor (C) \( \frac{2x}{x-6} \) bi za \( x = 4 \) davao \( \frac{8}{-2} = -4 \neq 4 \), pa se takodje odbacuje.
    </div>
  </div>

  <!-- Common Pitfalls -->
  <div class="card">
    <h2>Ceste greske</h2>
    <div class="pitfall">
      <strong>Zamena znaka u imeniocu:</strong> Mnogi ucenici zaborave da je \( 6-x = -(x-6) \) i pogresno saberu razlomke kao da imaju isti imenilac. To vodi do odgovora (E) \( \frac{3x-2}{6-x} \) umesto tacnog (B).
    </div>
    <div class="pitfall">
      <strong>Greska pri komponovanju:</strong> Pri racunanju \( f(f(x)) \), cesta greska je da se zaboravi pomnoziti \( 2 \) sa celim imeniocem \( (x-2) \), sto dovodi do pogresnog brojioca ili imenioca.
    </div>
  </div>

  <!-- Optional Challenge -->
  <div class="card">
    <h2>Dodatni izazov</h2>
    <p>Ako je \( h(x) = f(f(f(x))) \), odredi \( h(x) \) i prouci da li se funkcija \( f \) ponasa periodicno pri uzastopnom komponovanju.</p>
    <details>
      <summary>Hint</summary>
      <p style="margin-top:8px; color:#94a3b8;">
        Vec znamo da je \( f(f(x)) = \dfrac{3x-2}{6-x} \). Pokusaj da uvrstis ovaj izraz u \( f \), tj. izracunaj \( f\!\left(\dfrac{3x-2}{6-x}\right) \). Primetices da se nakon tri kompozicije javlja interesantan obrazac!
      </p>
    </details>
  </div>

</div>

<script>
(() => {
  // Step click interaction
  const steps = document.querySelectorAll('.step-container');
  steps.forEach(step => {
    step.addEventListener('click', () => {
      steps.forEach(s => s.classList.remove('active'));
      step.classList.add('active');
    });
  });

  // Canvas graph of g(x) = 2x/(6-x)
  const canvas = document.getElementById('graphCanvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const W = canvas.width;
  const H = canvas.height;

  let offsetX = 0;
  let offsetY = 0;
  let dragging = false;
  let dragStartX = 0;
  let dragStartY = 0;
  let startOffsetX = 0;
  let startOffsetY = 0;

  const scale = 30; // pixels per unit

  function toCanvas(x, y) {
    return {
      x: W / 2 + (x * scale) + offsetX,
      y: H / 2 - (y * scale) + offsetY
    };
  }

  function fromCanvas(cx, cy) {
    return {
      x: (cx - W / 2 - offsetX) / scale,
      y: (H / 2 + offsetY - cy) / scale
    };
  }

  function g(x) {
    if (Math.abs(6 - x) < 0.001) return NaN;
    return (2 * x) / (6 - x);
  }

  function draw() {
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    // Grid
    ctx.strokeStyle = '#1e293b';
    ctx.lineWidth = 1;

    const topLeft = fromCanvas(0, 0);
    const bottomRight = fromCanvas(W, H);

    const minX = Math.floor(topLeft.x) - 1;
    const maxX = Math.ceil(bottomRight.x) + 1;
    const minY = Math.floor(bottomRight.y) - 1;
    const maxY = Math.ceil(topLeft.y) + 1;

    for (let i = minX; i <= maxX; i++) {
      const p = toCanvas(i, 0);
      ctx.beginPath();
      ctx.moveTo(p.x, 0);
      ctx.lineTo(p.x, H);
      ctx.stroke();
    }
    for (let i = minY; i <= maxY; i++) {
      const p = toCanvas(0, i);
      ctx.beginPath();
      ctx.moveTo(0, p.y);
      ctx.lineTo(W, p.y);
      ctx.stroke();
    }

    // Axes
    const origin = toCanvas(0, 0);
    ctx.strokeStyle = '#475569';
    ctx.lineWidth = 2;

    ctx.beginPath();
    ctx.moveTo(0, origin.y);
    ctx.lineTo(W, origin.y);
    ctx.stroke();

    ctx.beginPath();
    ctx.moveTo(origin.x, 0);
    ctx.lineTo(origin.x, H);
    ctx.stroke();

    // Axis labels
    ctx.fillStyle = '#64748b';
    ctx.font = '12px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    for (let i = minX; i <= maxX; i++) {
      if (i === 0) continue;
      const p = toCanvas(i, 0);
      if (p.x > 10 && p.x < W - 10) {
        ctx.fillText(i.toString(), p.x, origin.y + 16);
      }
    }
    ctx.textAlign = 'right';
    for (let i = minY; i <= maxY; i++) {
      if (i === 0) continue;
      const p = toCanvas(0, i);
      if (p.y > 10 && p.y < H - 10) {
        ctx.fillText(i.toString(), origin.x - 8, p.y + 4);
      }
    }

    // Vertical asymptote x = 6
    const asym = toCanvas(6, 0);
    ctx.strokeStyle = '#f472b6';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([6, 4]);
    ctx.beginPath();
    ctx.moveTo(asym.x, 0);
    ctx.lineTo(asym.x, H);
    ctx.stroke();
    ctx.setLineDash([]);

    // Label for vertical asymptote
    ctx.fillStyle = '#f472b6';
    ctx.font = 'bold 13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('x = 6', asym.x + 6, 20);

    // Horizontal asymptote y = -2
    const hAsym = toCanvas(0, -2);
    ctx.strokeStyle = '#a78bfa';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([6, 4]);
    ctx.beginPath();
    ctx.moveTo(0, hAsym.y);
    ctx.lineTo(W, hAsym.y);
    ctx.stroke();
    ctx.setLineDash([]);

    // Label for horizontal asymptote
    ctx.fillStyle = '#a78bfa';
    ctx.font = 'bold 13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('y = -2', 8, hAsym.y - 8);

    // Plot g(x) = 2x/(6-x)
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2.5;

    const step = 0.05;
    let prevP = null;
    let prevValid = false;

    for (let xVal = minX - 2; xVal <= maxX + 2; xVal += step) {
      const yVal = g(xVal);
      if (isNaN(yVal) || !isFinite(yVal) || Math.abs(yVal) > 200) {
        prevValid = false;
        continue;
      }

      const p = toCanvas(xVal, yVal);

      if (prevValid && prevP) {
        // Don't draw lines across the asymptote
        if (Math.abs(p.x - prevP.x) < 100) {
          ctx.beginPath();
          ctx.moveTo(prevP.x, prevP.y);
          ctx.lineTo(p.x, p.y);
          ctx.stroke();
        }
      }

      prevP = p;
      prevValid = true;
    }

    // Origin point
    const o = toCanvas(0, 0);
    ctx.fillStyle = '#4ade80';
    ctx.beginPath();
    ctx.arc(o.x, o.y, 5, 0, Math.PI * 2);
    ctx.fill();

    ctx.fillStyle = '#4ade80';
    ctx.font = 'bold 12px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('(0, 0)', o.x + 8, o.y - 8);

    // Legend
    ctx.fillStyle = '#1e293b';
    ctx.fillRect(W - 200, H - 55, 190, 45);
    ctx.strokeStyle = '#334155';
    ctx.lineWidth = 1;
    ctx.strokeRect(W - 200, H - 55, 190, 45);

    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2.5;
    ctx.beginPath();
    ctx.moveTo(W - 188, H - 32);
    ctx.lineTo(W - 162, H - 32);
    ctx.stroke();

    ctx.fillStyle = '#e2e8f0';
    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('g(x) = 2x / (6 - x)', W - 155, H - 28);
  }

  draw();

  // Pan interaction
  function getPos(e) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = W / rect.width;
    const scaleY = H / rect.height;
    if (e.touches) {
      return {
        x: (e.touches[0].clientX - rect.left) * scaleX,
        y: (e.touches[0].clientY - rect.top) * scaleY
      };
    }
    return {
      x: (e.clientX - rect.left) * scaleX,
      y: (e.clientY - rect.top) * scaleY
    };
  }

  function onStart(e) {
    e.preventDefault();
    dragging = true;
    const pos = getPos(e);
    dragStartX = pos.x;
    dragStartY = pos.y;
    startOffsetX = offsetX;
    startOffsetY = offsetY;
  }

  function onMove(e) {
    if (!dragging) return;
    e.preventDefault();
    const pos = getPos(e);
    offsetX = startOffsetX + (pos.x - dragStartX);
    offsetY = startOffsetY + (pos.y - dragStartY);
    draw();
  }

  function onEnd() {
    dragging = false;
  }

  canvas.addEventListener('mousedown', onStart);
  canvas.addEventListener('mousemove', onMove);
  canvas.addEventListener('mouseup', onEnd);
  canvas.addEventListener('mouseleave', onEnd);

  canvas.addEventListener('touchstart', onStart, { passive: false });
  canvas.addEventListener('touchmove', onMove, { passive: false });
  canvas.addEventListener('touchend', onEnd);
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Kompozicija racionalnih funkcija i sabiranje",
  "subject": "math",
  "unit": "algebra",
  "topic_tags": ["racionalne funkcije", "kompozicija funkcija", "sabiranje razlomaka", "domen funkcije"]
}
BRAINSPARK_META-->