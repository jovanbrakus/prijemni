<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ortogonalna projekcija i elipsa</title>

<script type="text/info" id="logic-scratchpad">
PROBLEM: Find the orthogonal projection A of point B(16, -1) onto the line y - 5x + 3 = 0.
Then find the product of distances from A to the foci of the ellipse 9x² + 25y² = 225.

STEP 1: Rewrite the line in standard form.
y - 5x + 3 = 0  =>  5x - y - 3 = 0
So a = 5, b = -1, c = -3.

STEP 2: Find orthogonal projection of B(16, -1) onto line 5x - y - 3 = 0.
The direction vector of the line 5x - y - 3 = 0 is d = (1, 5) (perpendicular to normal (5, -1)).
The normal vector is n = (5, -1).

Parametric line through B perpendicular to the given line:
  x = 16 + 5t,  but wait — we go along the normal direction.

Actually, let's use the projection formula properly.
The line is 5x - y - 3 = 0. Normal vector: n = (5, -1).
Direction vector of the line: d = (1, 5).

The perpendicular from B(16, -1) to the line:
Parametric: P = B + t * n = (16 + 5t, -1 - t)

Substitute into line equation:
5(16 + 5t) - (-1 - t) - 3 = 0
80 + 25t + 1 + t - 3 = 0
78 + 26t = 0
t = -78/26 = -3

So A = (16 + 5(-3), -1 - (-3)) = (16 - 15, -1 + 3) = (1, 2).

VERIFY: Does A(1, 2) lie on 5x - y - 3 = 0?
5(1) - 2 - 3 = 5 - 2 - 3 = 0. Yes!

VERIFY: Is BA perpendicular to the line?
BA = A - B = (1 - 16, 2 - (-1)) = (-15, 3).
Line direction = (1, 5).
Dot product: (-15)(1) + (3)(5) = -15 + 15 = 0. Perpendicular confirmed!

STEP 3: Rewrite ellipse equation in standard form.
9x² + 25y² = 225
x²/25 + y²/9 = 1
So a² = 25, b² = 9, a = 5, b = 3.
c² = a² - b² = 25 - 9 = 16, c = 4.
Foci: F1(-4, 0) and F2(4, 0).

STEP 4: Distances from A(1, 2) to foci.
d(A, F1) = sqrt((1-(-4))² + (2-0)²) = sqrt(25 + 4) = sqrt(29)
d(A, F2) = sqrt((1-4)² + (2-0)²) = sqrt(9 + 4) = sqrt(13)

STEP 5: Product of distances.
d(A, F1) * d(A, F2) = sqrt(29) * sqrt(13) = sqrt(29 * 13) = sqrt(377)

ANSWER: sqrt(377), which is option D.

Verification: 377 = 13 * 29. Correct.
Cross-check with answer key: D) sqrt(377). CONFIRMED.
</script>

<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 10px;
}

h1 {
  font-size: 2.2rem;
  font-weight: 800;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.05rem;
  margin-bottom: 30px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.35rem;
  margin-bottom: 16px;
}

.card h3 {
  color: #e2e8f0;
  font-size: 1.1rem;
  margin-bottom: 10px;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.given-item {
  background: rgba(56,189,248,0.08);
  border: 1px solid rgba(56,189,248,0.15);
  border-radius: 10px;
  padding: 12px 18px;
  min-width: 100px;
  text-align: center;
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.82rem;
  margin-bottom: 4px;
  font-weight: 600;
}

.given-item .value {
  color: #e2e8f0;
  font-size: 1.05rem;
  font-weight: 600;
}

.answer-option {
  cursor: default;
}

.plan-card {
  background: linear-gradient(135deg, rgba(96,165,250,0.1), rgba(167,139,250,0.1));
  border: 1px solid rgba(96,165,250,0.25);
}

.theory-card details {
  margin: 15px 0;
}

.theory-card summary {
  cursor: pointer;
  font-size: 1.1rem;
  font-weight: 600;
  color: #a78bfa;
  padding: 8px 0;
}

.theory-card ul {
  list-style: none;
  padding-left: 0;
  margin-top: 12px;
}

.theory-card li {
  padding: 10px 14px;
  margin-bottom: 8px;
  background: rgba(167,139,250,0.08);
  border-left: 3px solid #a78bfa;
  border-radius: 6px;
  line-height: 1.8;
}

.theory-card li strong {
  color: #a78bfa;
}

.canvas-card {
  text-align: center;
}

.canvas-card canvas {
  border-radius: 10px;
  border: 1px solid #334155;
  max-width: 100%;
  touch-action: none;
}

.drag-hint {
  color: #94a3b8;
  font-size: 0.82rem;
  margin-top: 8px;
}

.step {
  display: flex;
  gap: 16px;
  padding: 18px;
  border-radius: 10px;
  margin-bottom: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
  border-left: 3px solid transparent;
  background: rgba(30,41,59,0.5);
}

.step:hover, .step.active {
  border-left: 3px solid #4ade80;
  background: rgba(30,41,59,0.9);
}

.step-badge {
  width: 32px;
  height: 32px;
  min-width: 32px;
  border-radius: 50%;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.9rem;
}

.step-content {
  flex: 1;
}

.step-content h3 {
  margin-bottom: 8px;
}

.step-note {
  color: #94a3b8;
  font-size: 0.9rem;
  margin-top: 6px;
  font-style: italic;
}

.math-block {
  background: rgba(56,189,248,0.08);
  border: 1px solid rgba(56,189,248,0.15);
  border-radius: 8px;
  padding: 14px 18px;
  margin: 10px 0;
  font-family: 'Courier New', monospace;
  overflow-x: auto;
}

details.checkpoint {
  margin: 18px 0;
  background: rgba(167,139,250,0.06);
  border: 1px solid rgba(167,139,250,0.2);
  border-radius: 8px;
  padding: 14px 18px;
}

details.checkpoint summary {
  cursor: pointer;
  color: #a78bfa;
  font-weight: 600;
  font-size: 0.95rem;
}

details.checkpoint .answer {
  margin-top: 10px;
  color: #4ade80;
  font-weight: 600;
}

.insight-box {
  background: linear-gradient(135deg, rgba(52,211,153,0.12), rgba(96,165,250,0.12));
  border: 1px solid rgba(52,211,153,0.3);
  border-radius: 14px;
  padding: 24px;
  text-align: center;
  margin-bottom: 24px;
}

.insight-box h2 {
  color: #34d399;
}

.insight-formula {
  font-size: 1.3rem;
  margin: 16px 0;
}

.final-answer-card {
  background: linear-gradient(135deg, rgba(52,211,153,0.1), rgba(74,222,128,0.08));
  border: 1px solid rgba(52,211,153,0.35);
}

.final-answer-card h2 {
  color: #4ade80;
}

.final-answer-value {
  font-size: 1.6rem;
  color: #4ade80;
  font-weight: 800;
  text-align: center;
  margin: 18px 0;
}

.final-options {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
  margin: 18px 0;
}

.final-option {
  padding: 10px 20px;
  border-radius: 8px;
  background: rgba(30,41,59,0.7);
  border: 1px solid #334155;
  color: #94a3b8;
  font-size: 1rem;
}

.final-option.correct {
  background: rgba(52,211,153,0.15);
  border: 2px solid #4ade80;
  color: #4ade80;
  font-weight: 700;
}

.verification {
  margin-top: 14px;
  padding: 14px;
  background: rgba(96,165,250,0.08);
  border-radius: 8px;
  border-left: 3px solid #60a5fa;
  color: #94a3b8;
  font-size: 0.92rem;
}

.pitfall-card {
  border-left: 3px solid #e09468;
}

.pitfall-card h2 {
  color: #e09468;
}

.pitfall-card ul {
  list-style: none;
  padding: 0;
}

.pitfall-card li {
  padding: 8px 14px;
  margin-bottom: 8px;
  background: rgba(224,148,104,0.08);
  border-radius: 6px;
  line-height: 1.6;
}

.challenge-card details {
  margin: 15px 0;
}

.challenge-card summary {
  cursor: pointer;
  color: #f472b6;
  font-weight: 600;
}

.challenge-card h2 {
  color: #f472b6;
}

@media (max-width: 700px) {
  h1 { font-size: 1.5rem; }
  .card { padding: 16px; }
  .step { flex-direction: column; gap: 10px; }
  .given-grid { flex-direction: column; }
  .final-options { flex-direction: column; align-items: center; }
}
</style>
</head>
<body>
<div class="container">

  <!-- TITLE -->
  <h1>Ortogonalna projekcija i elipsa</h1>
  <p class="subtitle">Analitička geometrija u ravni -- projekcija tačke na pravu i rastojanje od žiža elipse</p>

  <!-- PROBLEM STATEMENT -->
  <div class="card problem-statement">
    <h2>Postavka zadatka</h2>
    <p>
      Neka je \(A\) ortogonalna projekcija tačke \(B(16,\, -1)\) na pravu \(y - 5x + 3 = 0\). Proizvod rastojanja tačke \(A\) od žiža elipse \(9x^2 + 25y^2 = 225\) iznosi:
    </p>

    <div class="given-grid" style="margin-bottom: 18px;">
      <div class="given-item">
        <div class="label">Tačka B</div>
        <div class="value">\((16,\, -1)\)</div>
      </div>
      <div class="given-item">
        <div class="label">Prava</div>
        <div class="value">\(y - 5x + 3 = 0\)</div>
      </div>
      <div class="given-item">
        <div class="label">Elipsa</div>
        <div class="value">\(9x^2 + 25y^2 = 225\)</div>
      </div>
    </div>

    <h3>Ponuđeni odgovori</h3>
    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\(4\sqrt{2}\)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\(\sqrt{29}\)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\(10\)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\(\sqrt{377}\)</div>
      </div>
      <div class="given-item answer-option" data-option="E">
        <div class="label">(E)</div>
        <div class="value">\(13\)</div>
      </div>
    </div>
  </div>

  <!-- PLAN -->
  <div class="card plan-card">
    <h2>Plan rešavanja</h2>
    <p>
      Najpre nalazimo ortogonalnu projekciju \(A\) tačke \(B(16,\,-1)\) na datu pravu. Zatim elipsu svodimo na kanonski oblik da odredimo žiže, pa računamo rastojanja od \(A\) do svake žiže i na kraju njihov proizvod.
    </p>
  </div>

  <!-- THEORY -->
  <div class="card theory-card">
    <details>
      <summary>Ključne formule i teoreme</summary>
      <ul>
        <li>
          <strong>Ortogonalna projekcija tačke na pravu:</strong> Za pravu \(ax + by + c = 0\) i tačku \(M(x_0,\, y_0)\), projekcija se nalazi tako što se od \(M\) ide duž vektora normale \(\vec{n} = (a,\, b)\). Parametarski: \(P = M + t \cdot \vec{n}\), gde se \(t\) dobija uvrštavanjem u jednačinu prave.
        </li>
        <li>
          <strong>Kanonski oblik elipse:</strong> \(\dfrac{x^2}{a^2} + \dfrac{y^2}{b^2} = 1\), gde je \(a > b > 0\). Žiže su u tačkama \((\pm c,\, 0)\) gde je \(c = \sqrt{a^2 - b^2}\).
        </li>
        <li>
          <strong>Rastojanje između dve tačke:</strong> \(d = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}\)
        </li>
      </ul>
    </details>
  </div>

  <!-- CANVAS DIAGRAM -->
  <div class="card canvas-card">
    <h2>Vizuelni prikaz</h2>
    <canvas id="diagram" width="800" height="600"></canvas>
    <p class="drag-hint">Prikaz tačaka B, A, elipse i njenih žiža</p>
  </div>

  <!-- STEP-BY-STEP SOLUTION -->
  <div class="card">
    <h2>Rešenje korak po korak</h2>

    <!-- Step 1 -->
    <div class="step" id="step1">
      <div class="step-badge">1</div>
      <div class="step-content">
        <h3>Zapišimo pravu u standardnom obliku</h3>
        <p>Datu jednačinu prave preuredimo:</p>
        <div class="math-block">
          \[y - 5x + 3 = 0 \quad \Longrightarrow \quad 5x - y - 3 = 0\]
        </div>
        <p>Vektor normale prave je \(\vec{n} = (5,\, -1)\), a vektor pravca prave je \(\vec{d} = (1,\, 5)\).</p>
      </div>
    </div>

    <!-- Step 2 -->
    <div class="step" id="step2">
      <div class="step-badge">2</div>
      <div class="step-content">
        <h3>Postavimo jednačinu normale iz tačke B</h3>
        <p>Tačka \(A\) je podnožje normale iz \(B(16,\,-1)\) na pravu. Parametarska jednačina normale:</p>
        <div class="math-block">
          \[\begin{align}
          x &= 16 + 5t \\
          y &= -1 - t
          \end{align}\]
        </div>
        <p class="step-note">Idemo od tačke B u pravcu vektora normale \(\vec{n} = (5,\, -1)\).</p>
      </div>
    </div>

    <!-- Step 3 -->
    <div class="step" id="step3">
      <div class="step-badge">3</div>
      <div class="step-content">
        <h3>Odredimo parametar \(t\)</h3>
        <p>Uvrštavamo parametarske koordinate u jednačinu prave \(5x - y - 3 = 0\):</p>
        <div class="math-block">
          \[5(16 + 5t) - (-1 - t) - 3 = 0\]
        </div>
        <p>Raspisujemo:</p>
        <div class="math-block">
          \[80 + 25t + 1 + t - 3 = 0\]
        </div>
        <div class="math-block">
          \[78 + 26t = 0\]
        </div>
        <div class="math-block">
          \[t = -\frac{78}{26} = -3\]
        </div>
      </div>
    </div>

    <!-- Step 4 -->
    <div class="step" id="step4">
      <div class="step-badge">4</div>
      <div class="step-content">
        <h3>Izračunajmo koordinate tačke \(A\)</h3>
        <p>Uvrstimo \(t = -3\) u parametarske jednačine:</p>
        <div class="math-block">
          \[\begin{align}
          x_A &= 16 + 5 \cdot (-3) = 16 - 15 = 1 \\
          y_A &= -1 - (-3) = -1 + 3 = 2
          \end{align}\]
        </div>
        <p>Dakle, <strong style="color:#4ade80;">\(A = (1,\, 2)\)</strong>.</p>
      </div>
    </div>

    <!-- Checkpoint 1 -->
    <details class="checkpoint">
      <summary>Proveri se: Da li tačka A zaista leži na pravoj?</summary>
      <div class="answer">
        Proverimo: \(5 \cdot 1 - 2 - 3 = 5 - 2 - 3 = 0\). Da, \(A(1,\, 2)\) zadovoljava jednačinu \(5x - y - 3 = 0\).
      </div>
    </details>

    <!-- Step 5 -->
    <div class="step" id="step5">
      <div class="step-badge">5</div>
      <div class="step-content">
        <h3>Svedimo elipsu na kanonski oblik</h3>
        <p>Podelimo jednačinu \(9x^2 + 25y^2 = 225\) sa 225:</p>
        <div class="math-block">
          \[\frac{x^2}{25} + \frac{y^2}{9} = 1\]
        </div>
        <p>Odavde čitamo: \(a^2 = 25\), \(b^2 = 9\), pa je \(a = 5\) i \(b = 3\).</p>
      </div>
    </div>

    <!-- Step 6 -->
    <div class="step" id="step6">
      <div class="step-badge">6</div>
      <div class="step-content">
        <h3>Odredimo žiže elipse</h3>
        <p>Polurastojanje između žiža:</p>
        <div class="math-block">
          \[c = \sqrt{a^2 - b^2} = \sqrt{25 - 9} = \sqrt{16} = 4\]
        </div>
        <p>Žiže su: <strong style="color:#60a5fa;">\(F_1(-4,\, 0)\)</strong> i <strong style="color:#60a5fa;">\(F_2(4,\, 0)\)</strong>.</p>
      </div>
    </div>

    <!-- Checkpoint 2 -->
    <details class="checkpoint">
      <summary>Proveri se: Koliko je \(c^2\) za ovu elipsu?</summary>
      <div class="answer">
        \(c^2 = a^2 - b^2 = 25 - 9 = 16\), dakle \(c = 4\).
      </div>
    </details>

    <!-- Step 7 -->
    <div class="step" id="step7">
      <div class="step-badge">7</div>
      <div class="step-content">
        <h3>Izračunajmo rastojanja od \(A\) do žiža</h3>
        <p>Rastojanje od \(A(1,\, 2)\) do \(F_1(-4,\, 0)\):</p>
        <div class="math-block">
          \[d(A,\, F_1) = \sqrt{(1 - (-4))^2 + (2 - 0)^2} = \sqrt{25 + 4} = \sqrt{29}\]
        </div>
        <p>Rastojanje od \(A(1,\, 2)\) do \(F_2(4,\, 0)\):</p>
        <div class="math-block">
          \[d(A,\, F_2) = \sqrt{(1 - 4)^2 + (2 - 0)^2} = \sqrt{9 + 4} = \sqrt{13}\]
        </div>
      </div>
    </div>

    <!-- Step 8 -->
    <div class="step" id="step8">
      <div class="step-badge">8</div>
      <div class="step-content">
        <h3>Proizvod rastojanja</h3>
        <p>Množimo dobijena rastojanja:</p>
        <div class="math-block">
          \[d(A,\, F_1) \cdot d(A,\, F_2) = \sqrt{29} \cdot \sqrt{13} = \sqrt{29 \cdot 13} = \sqrt{377}\]
        </div>
      </div>
    </div>

    <!-- Checkpoint 3 -->
    <details class="checkpoint">
      <summary>Proveri se: Koliko je \(29 \cdot 13\)?</summary>
      <div class="answer">
        \(29 \cdot 13 = 29 \cdot 10 + 29 \cdot 3 = 290 + 87 = 377\). Dakle, proizvod je \(\sqrt{377}\).
      </div>
    </details>
  </div>

  <!-- KEY INSIGHT -->
  <div class="insight-box">
    <h2>Ključni uvid</h2>
    <p>Projekcija daje tačku \(A(1,\, 2)\), a množenje rastojanja od žiža koristi pravilo \(\sqrt{m} \cdot \sqrt{n} = \sqrt{m \cdot n}\).</p>
    <div class="insight-formula">
      \[\sqrt{29} \cdot \sqrt{13} = \sqrt{377}\]
    </div>
  </div>

  <!-- FINAL ANSWER -->
  <div class="card final-answer-card">
    <h2>Konačan odgovor</h2>
    <div class="final-answer-value">
      \(\sqrt{377}\)
    </div>
    <div class="final-options">
      <div class="final-option">
        (A) \(4\sqrt{2}\)
      </div>
      <div class="final-option">
        (B) \(\sqrt{29}\)
      </div>
      <div class="final-option">
        (C) \(10\)
      </div>
      <div class="final-option correct">
        (D) \(\sqrt{377}\)
      </div>
      <div class="final-option">
        (E) \(13\)
      </div>
    </div>
    <div class="verification">
      <strong>Provera:</strong> Tačka \(A(1,\, 2)\) zaista leži na pravoj: \(5 \cdot 1 - 2 - 3 = 0\). Vektor \(\overrightarrow{BA} = (-15,\, 3)\) je kolinearan sa normalom \((5,\, -1)\) (jer je \((-15,\, 3) = -3 \cdot (5,\, -1)\)), pa je projekcija tačna. Elipsa ima žiže u \((\pm 4,\, 0)\), rastojanja su \(\sqrt{29}\) i \(\sqrt{13}\), a njihov proizvod je zaista \(\sqrt{377}\).
    </div>
  </div>

  <!-- COMMON PITFALLS -->
  <div class="card pitfall-card">
    <h2>Česte greške</h2>
    <ul>
      <li>
        <strong>Pogrešan predznak u jednačini prave:</strong> Jednačina \(y - 5x + 3 = 0\) se mora pažljivo prepisati kao \(5x - y - 3 = 0\). Greška u predznaku dovodi do pogrešne projekcije.
      </li>
      <li>
        <strong>Zamena \(a^2\) i \(b^2\) kod elipse:</strong> U jednačini \(\frac{x^2}{25} + \frac{y^2}{9} = 1\), veća vrednost (25) je pod \(x^2\), pa je \(a^2 = 25\) i žiže su na \(x\)-osi. Da je bilo obrnuto, žiže bi bile na \(y\)-osi.
      </li>
    </ul>
  </div>

  <!-- OPTIONAL CHALLENGE -->
  <div class="card challenge-card">
    <h2>Dodatni izazov</h2>
    <p>Da li tačka \(A(1,\, 2)\) leži unutar, na, ili van elipse \(\frac{x^2}{25} + \frac{y^2}{9} = 1\)?</p>
    <details>
      <summary>Otkrij nagoveštaj</summary>
      <p style="margin-top: 10px; color: #94a3b8;">
        Izračunaj \(\frac{1^2}{25} + \frac{2^2}{9}\) i uporedi sa 1. Ako je vrednost manja od 1, tačka je unutar elipse; jednaka 1, na elipsi; veća od 1, van elipse.
      </p>
    </details>
  </div>

</div>

<script>
(() => {
  // --- Step click highlight ---
  const steps = document.querySelectorAll('.step');
  steps.forEach(step => {
    step.addEventListener('click', () => {
      steps.forEach(s => s.classList.remove('active'));
      step.classList.toggle('active');
    });
  });

  // --- Canvas Diagram ---
  const canvas = document.getElementById('diagram');
  const ctx = canvas.getContext('2d');
  const W = canvas.width;
  const H = canvas.height;

  // Coordinate system setup
  // We need to show: ellipse centered at origin (a=5, b=3), foci at (+-4,0),
  // point A(1,2), point B(16,-1), and the line 5x - y - 3 = 0.
  // X range: about -7 to 18, Y range: about -4 to 6
  // Let's use a scale and origin that fits well.
  const originX = 200;
  const originY = 370;
  const scale = 30;

  function toCanvas(x, y) {
    return { x: originX + x * scale, y: originY - y * scale };
  }

  function drawGrid() {
    ctx.strokeStyle = '#1e293b';
    ctx.lineWidth = 0.5;

    for (let x = -7; x <= 19; x++) {
      const p1 = toCanvas(x, -5);
      const p2 = toCanvas(x, 8);
      ctx.beginPath();
      ctx.moveTo(p1.x, p1.y);
      ctx.lineTo(p2.x, p2.y);
      ctx.stroke();
    }
    for (let y = -5; y <= 8; y++) {
      const p1 = toCanvas(-7, y);
      const p2 = toCanvas(19, y);
      ctx.beginPath();
      ctx.moveTo(p1.x, p1.y);
      ctx.lineTo(p2.x, p2.y);
      ctx.stroke();
    }
  }

  function drawAxes() {
    ctx.strokeStyle = '#475569';
    ctx.lineWidth = 1.5;

    // X-axis
    const xStart = toCanvas(-7, 0);
    const xEnd = toCanvas(19, 0);
    ctx.beginPath();
    ctx.moveTo(xStart.x, xStart.y);
    ctx.lineTo(xEnd.x, xEnd.y);
    ctx.stroke();

    // Y-axis
    const yStart = toCanvas(0, -5);
    const yEnd = toCanvas(0, 8);
    ctx.beginPath();
    ctx.moveTo(yStart.x, yStart.y);
    ctx.lineTo(yEnd.x, yEnd.y);
    ctx.stroke();

    // Axis labels
    ctx.fillStyle = '#94a3b8';
    ctx.font = 'bold 13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('x', xEnd.x - 10, xEnd.y - 10);
    ctx.fillText('y', yEnd.x + 14, yEnd.y + 10);

    // Tick marks
    ctx.font = '10px Segoe UI, system-ui, sans-serif';
    for (let x = -6; x <= 18; x++) {
      if (x === 0) continue;
      const p = toCanvas(x, 0);
      ctx.beginPath();
      ctx.moveTo(p.x, p.y - 3);
      ctx.lineTo(p.x, p.y + 3);
      ctx.stroke();
      if (x % 2 === 0) {
        ctx.fillText(String(x), p.x, p.y + 15);
      }
    }
    for (let y = -4; y <= 7; y++) {
      if (y === 0) continue;
      const p = toCanvas(0, y);
      ctx.beginPath();
      ctx.moveTo(p.x - 3, p.y);
      ctx.lineTo(p.x + 3, p.y);
      ctx.stroke();
      if (y % 2 === 0) {
        ctx.fillText(String(y), p.x - 14, p.y + 4);
      }
    }
  }

  function drawEllipse() {
    const a = 5, b = 3;
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2;
    ctx.beginPath();
    for (let i = 0; i <= 360; i++) {
      const rad = (i * Math.PI) / 180;
      const ex = a * Math.cos(rad);
      const ey = b * Math.sin(rad);
      const p = toCanvas(ex, ey);
      if (i === 0) ctx.moveTo(p.x, p.y);
      else ctx.lineTo(p.x, p.y);
    }
    ctx.closePath();
    ctx.stroke();

    // Fill ellipse with subtle color
    ctx.fillStyle = 'rgba(96, 165, 250, 0.05)';
    ctx.fill();

    // Label
    ctx.fillStyle = '#60a5fa';
    ctx.font = 'italic 12px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    const labelPos = toCanvas(3.8, 2.8);
    ctx.fillText('9x\u00B2 + 25y\u00B2 = 225', labelPos.x, labelPos.y);
  }

  function drawLine() {
    // Line: 5x - y - 3 = 0  =>  y = 5x - 3
    ctx.strokeStyle = '#a78bfa';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([6, 4]);

    const x1 = -1, y1 = 5 * (-1) - 3;
    const x2 = 4, y2 = 5 * 4 - 3;
    const p1 = toCanvas(x1, y1);
    const p2 = toCanvas(x2, y2);
    ctx.beginPath();
    ctx.moveTo(p1.x, p1.y);
    ctx.lineTo(p2.x, p2.y);
    ctx.stroke();
    ctx.setLineDash([]);

    // Label
    ctx.fillStyle = '#a78bfa';
    ctx.font = 'italic 12px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    const lp = toCanvas(2.5, 5.5);
    ctx.fillText('y \u2212 5x + 3 = 0', lp.x, lp.y);
  }

  function drawPoint(x, y, label, color, offsetX, offsetY) {
    const p = toCanvas(x, y);

    // Glow
    const grad = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, 14);
    grad.addColorStop(0, color.replace(')', ', 0.4)').replace('rgb', 'rgba'));
    grad.addColorStop(1, 'transparent');
    ctx.fillStyle = grad;
    ctx.beginPath();
    ctx.arc(p.x, p.y, 14, 0, Math.PI * 2);
    ctx.fill();

    // Point
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.arc(p.x, p.y, 5, 0, Math.PI * 2);
    ctx.fill();

    // Outline
    ctx.strokeStyle = '#0f172a';
    ctx.lineWidth = 1.5;
    ctx.stroke();

    // Label
    ctx.fillStyle = color;
    ctx.font = 'bold 13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText(label, p.x + (offsetX || 0), p.y + (offsetY || -14));
  }

  function drawDistanceLines() {
    const pA = toCanvas(1, 2);
    const pF1 = toCanvas(-4, 0);
    const pF2 = toCanvas(4, 0);

    // A to F1
    ctx.strokeStyle = 'rgba(52, 211, 153, 0.6)';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([4, 4]);
    ctx.beginPath();
    ctx.moveTo(pA.x, pA.y);
    ctx.lineTo(pF1.x, pF1.y);
    ctx.stroke();

    // A to F2
    ctx.beginPath();
    ctx.moveTo(pA.x, pA.y);
    ctx.lineTo(pF2.x, pF2.y);
    ctx.stroke();
    ctx.setLineDash([]);

    // Distance labels
    ctx.fillStyle = '#34d399';
    ctx.font = '11px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    const midF1 = { x: (pA.x + pF1.x) / 2, y: (pA.y + pF1.y) / 2 };
    const midF2 = { x: (pA.x + pF2.x) / 2, y: (pA.y + pF2.y) / 2 };
    ctx.fillText('\u221A29', midF1.x - 15, midF1.y - 8);
    ctx.fillText('\u221A13', midF2.x + 15, midF2.y - 8);
  }

  function drawProjectionLine() {
    const pB = toCanvas(16, -1);
    const pA = toCanvas(1, 2);

    ctx.strokeStyle = 'rgba(244, 114, 182, 0.5)';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([5, 5]);
    ctx.beginPath();
    ctx.moveTo(pB.x, pB.y);
    ctx.lineTo(pA.x, pA.y);
    ctx.stroke();
    ctx.setLineDash([]);

    // Right angle marker at A
    const size = 8;
    // Direction from A to B: (15, -3), normalize => unit ~ (0.98, -0.196)
    // Direction along the line at A: (1, 5), normalize => unit ~ (0.196, 0.98)
    const uAB = { x: 15 / Math.sqrt(234), y: -3 / Math.sqrt(234) };
    const uLine = { x: 1 / Math.sqrt(26), y: 5 / Math.sqrt(26) };

    const pACanvas = toCanvas(1, 2);
    // In canvas coords, we need to be careful with y direction
    const corner1 = { x: pACanvas.x + uAB.x * size * scale / 5, y: pACanvas.y + uAB.y * scale / 5 * size };
    // Just draw a small square
    ctx.strokeStyle = '#4ade80';
    ctx.lineWidth = 1.5;
    const sq = 10;
    // Normal direction in canvas: from A towards B
    const dx = (pB.x - pA.x);
    const dy = (pB.y - pA.y);
    const lenBA = Math.sqrt(dx * dx + dy * dy);
    const nx = dx / lenBA * sq;
    const ny = dy / lenBA * sq;
    // Line direction in canvas
    const lx = -ny;
    const ly = nx;

    ctx.beginPath();
    ctx.moveTo(pA.x + nx, pA.y + ny);
    ctx.lineTo(pA.x + nx + lx, pA.y + ny + ly);
    ctx.lineTo(pA.x + lx, pA.y + ly);
    ctx.stroke();
  }

  function draw() {
    ctx.clearRect(0, 0, W, H);

    // Background
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    drawGrid();
    drawAxes();
    drawEllipse();
    drawLine();
    drawProjectionLine();
    drawDistanceLines();

    // Points
    drawPoint(-4, 0, 'F\u2081(\u22124, 0)', '#60a5fa', 0, 18);
    drawPoint(4, 0, 'F\u2082(4, 0)', '#60a5fa', 0, 18);
    drawPoint(1, 2, 'A(1, 2)', '#4ade80', 20, -10);
    drawPoint(16, -1, 'B(16, \u22121)', '#f472b6', 0, -14);
    drawPoint(0, 0, 'O', '#94a3b8', -12, -8);
  }

  draw();
})();
</script>

</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Ortogonalna projekcija i proizvod rastojanja od žiža elipse",
  "subject": "math",
  "unit": "geometry",
  "topic_tags": ["ortogonalna projekcija", "elipsa", "žiže elipse", "analitička geometrija", "rastojanje"]
}
BRAINSPARK_META-->