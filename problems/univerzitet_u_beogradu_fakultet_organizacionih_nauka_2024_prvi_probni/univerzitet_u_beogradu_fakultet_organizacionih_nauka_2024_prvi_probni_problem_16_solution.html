<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zadatak 16 — Kolicnik ekstrema funkcije</title>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<script type="text/info" id="logic-scratchpad">
=== LOGICKA PRIPREMA ===

Funkcija: f(x) = x(ln^2(x) - 3) na [1, e^2]

KORAK 1: Vrednosti na krajnim tackama
  f(1) = 1*(0 - 3) = -3
  f(e^2) = e^2*(4 - 3) = e^2 ≈ 7,389

KORAK 2: Nalazenje kriticnih tacaka
  f'(x) = (ln^2(x) - 3) + x * (2 ln(x) / x)
        = ln^2(x) - 3 + 2 ln(x)
        = ln^2(x) + 2 ln(x) - 3

  Smena: t = ln(x)
  t^2 + 2t - 3 = 0
  (t + 3)(t - 1) = 0
  t = -3  ->  x = e^(-3) ∉ [1, e^2]  (odbacujemo)
  t = 1   ->  x = e ∈ [1, e^2]  (prihvatamo)

KORAK 3: Vrednost u kriticnoj tacki
  f(e) = e*(1 - 3) = -2e ≈ -5,436

KORAK 4: Odredjivanje max i min
  Vrednosti: f(1) = -3,  f(e) = -2e ≈ -5,436,  f(e^2) = e^2 ≈ 7,389

  Maksimum M = f(e^2) = e^2
  Minimum m = f(e) = -2e

KORAK 5: Racunanje kolicnika
  M/m = e^2 / (-2e) = -e/2 ≈ -1,359

KORAK 6: Provera kojoj skupini pripada
  -e/2 ≈ -1,359
  Interval [-2, -1): -2 <= -1,359 < -1  DA

ODGOVOR: E) [-2, -1)
</script>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  font-size: 2.2rem;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
  line-height: 1.3;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 32px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 16px;
  padding: 28px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card-title {
  font-size: 1.3rem;
  color: #60a5fa;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.card-title .icon {
  font-size: 1.4rem;
}

.problem-text {
  font-size: 1.15rem;
  line-height: 1.8;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 18px;
}

.given-item {
  background: rgba(51, 65, 85, 0.6);
  border: 1px solid #334155;
  border-radius: 10px;
  padding: 10px 18px;
  text-align: center;
  min-width: 80px;
}

.given-item .label {
  font-size: 0.85rem;
  color: #94a3b8;
  margin-bottom: 4px;
}

.given-item .value {
  font-size: 1.1rem;
  color: #e2e8f0;
  font-weight: 600;
}

.highlight-box {
  background: rgba(96, 165, 250, 0.1);
  border: 1px solid rgba(96, 165, 250, 0.3);
  border-radius: 10px;
  padding: 16px 20px;
  margin: 16px 0;
  font-size: 1.1rem;
  text-align: center;
}

.plan-card {
  border-left: 4px solid #a78bfa;
}

.theory-card details {
  margin: 15px 0;
}

.theory-card summary {
  cursor: pointer;
  font-size: 1.15rem;
  color: #a78bfa;
  padding: 8px 0;
  user-select: none;
}

.theory-card summary:hover {
  color: #c4b5fd;
}

.theory-content {
  padding: 16px 0 8px 0;
  line-height: 1.9;
}

.theory-content ul {
  list-style: none;
  padding-left: 0;
}

.theory-content li {
  padding: 8px 0;
  border-bottom: 1px solid rgba(51, 65, 85, 0.5);
}

.theory-content li:last-child {
  border-bottom: none;
}

.step-container {
  margin-bottom: 20px;
  padding: 16px 20px;
  border-radius: 12px;
  border-left: 4px solid transparent;
}

.step-header {
  display: flex;
  align-items: center;
  gap: 14px;
  margin-bottom: 10px;
}

.step-badge {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.85rem;
  font-weight: 700;
  flex-shrink: 0;
}

.step-title {
  font-size: 1.15rem;
  color: #e2e8f0;
  font-weight: 600;
}

.step-body {
  padding-left: 42px;
}

.step-body p {
  margin-bottom: 10px;
  color: #cbd5e1;
}

.math-block {
  background: rgba(56, 189, 248, 0.08);
  border: 1px solid rgba(56, 189, 248, 0.15);
  border-radius: 10px;
  padding: 14px 20px;
  margin: 12px 0;
  text-align: center;
  font-size: 1.1rem;
}

.note {
  color: #94a3b8;
  font-size: 0.95rem;
  font-style: italic;
  margin-top: 8px;
}

.checkpoint {
  margin: 15px 0;
}

.checkpoint details {
  background: rgba(167, 139, 250, 0.08);
  border: 1px solid rgba(167, 139, 250, 0.2);
  border-radius: 10px;
  padding: 12px 16px;
}

.checkpoint summary {
  cursor: pointer;
  color: #a78bfa;
  font-weight: 600;
  user-select: none;
}

.checkpoint .answer {
  padding-top: 10px;
  color: #4ade80;
}

.insight-card {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.15), rgba(167, 139, 250, 0.15));
  border: 1px solid rgba(167, 139, 250, 0.3);
  text-align: center;
}

.insight-card .big-formula {
  font-size: 1.3rem;
  margin: 16px 0;
  color: #4ade80;
}

.final-answer-card {
  border: 2px solid #4ade80;
  text-align: center;
}

.final-answer-text {
  font-size: 1.8rem;
  color: #4ade80;
  font-weight: 700;
  margin: 16px 0;
}

.final-options {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  margin: 20px 0;
}

.final-option {
  background: rgba(51, 65, 85, 0.6);
  border: 1px solid #334155;
  border-radius: 10px;
  padding: 10px 24px;
  font-size: 1rem;
}

.final-option.correct {
  background: rgba(52, 211, 153, 0.15);
  border-color: #4ade80;
  color: #4ade80;
  font-weight: 700;
}

.verification {
  background: rgba(52, 211, 153, 0.08);
  border: 1px solid rgba(52, 211, 153, 0.2);
  border-radius: 10px;
  padding: 14px 20px;
  margin-top: 16px;
  text-align: left;
}

.verification-title {
  color: #34d399;
  font-weight: 700;
  margin-bottom: 6px;
}

.pitfall-card {
  border-left: 4px solid #e09468;
}

.pitfall-card .pitfall-title {
  color: #e09468;
}

.pitfall-card ul {
  list-style: disc;
  padding-left: 24px;
  color: #cbd5e1;
}

.pitfall-card li {
  margin-bottom: 8px;
}

.challenge-card details {
  margin: 15px 0;
}

.challenge-card summary {
  cursor: pointer;
  color: #f472b6;
  font-size: 1.05rem;
  user-select: none;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin: 12px 0;
  font-size: 0.95rem;
}

th {
  background: #0f172a;
  color: #94a3b8;
  font-weight: 600;
  padding: 10px 14px;
  border: 1px solid #334155;
  text-align: center;
}

td {
  padding: 10px 14px;
  border: 1px solid #334155;
  text-align: center;
  color: #cbd5e1;
}

td.highlight-max {
  color: #4ade80;
  font-weight: 700;
}

td.highlight-min {
  color: #f472b6;
  font-weight: 700;
}

canvas {
  touch-action: none;
  display: block;
  margin: 0 auto;
  max-width: 100%;
  border-radius: 12px;
}

.canvas-hint {
  text-align: center;
  color: #94a3b8;
  font-size: 0.9rem;
  margin-top: 8px;
}

.case-box {
  background: rgba(51, 65, 85, 0.4);
  border: 1px solid #334155;
  border-radius: 10px;
  padding: 14px 20px;
  margin: 10px 0;
}

.case-title {
  color: #60a5fa;
  font-weight: 600;
  margin-bottom: 6px;
}

@media (max-width: 700px) {
  h1 {
    font-size: 1.6rem;
  }
  .card {
    padding: 18px;
  }
  .given-grid {
    gap: 8px;
  }
  .given-item {
    padding: 8px 12px;
    min-width: 60px;
  }
  .step-body {
    padding-left: 0;
  }
  .final-answer-text {
    font-size: 1.4rem;
  }
}
</style>
</head>
<body>
<div class="container">

  <h1>Kolicnik ekstrema funkcije na segmentu</h1>
  <p class="subtitle">Matematicka analiza &mdash; ekstremi neprekidne funkcije na zatvorenom intervalu</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <h2 class="card-title">Postavka zadatka</h2>
    <div class="problem-text">
      <p>Kolicnik najvece i najmanje vrednosti funkcije
      \[f(x) = x(\ln^2 x - 3)\]
      na segmentu \([1,\, e^2]\) pripada skupu:</p>
    </div>
    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\((-\infty,\,-3)\)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\([-1,\,1)\)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\([1,\,+\infty)\)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\([-3,\,-2)\)</div>
      </div>
      <div class="given-item answer-option" data-option="E">
        <div class="label">(E)</div>
        <div class="value">\([-2,\,-1)\)</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card plan-card">
    <h2 class="card-title">Plan resavanja</h2>
    <p>Potrebno je naci najvecu i najmanju vrednost neprekidne funkcije na zatvorenom segmentu. Prema Vajerstrasovoj teoremi, te vrednosti se dostizu ili na krajnjim tackama ili u kriticnim tackama unutar segmenta. Izracunacemo izvod, odrediti kriticne tacke, uporediti sve vrednosti, a zatim izracunati trazeni kolicnik.</p>
  </div>

  <!-- Theory -->
  <div class="card theory-card">
    <details>
      <summary>Podsetnik iz teorije &mdash; ekstremi na zatvorenom segmentu</summary>
      <div class="theory-content">
        <ul>
          <li><strong>Vajerstrasova teorema:</strong> Ako je \(f\) neprekidna na \([a,b]\), tada \(f\) dostize svoju najvecu vrednost \(M\) i najmanju vrednost \(m\) na tom segmentu.</li>
          <li><strong>Gde traziti:</strong> Ekstremne vrednosti se mogu naci u krajnjim tackama \(x = a\) i \(x = b\), ili u kriticnim tackama gde je \(f'(x) = 0\) ili \(f'(x)\) ne postoji.</li>
          <li><strong>Deriviranje proizvoda:</strong> \((uv)' = u'v + uv'\)</li>
          <li><strong>Deriviranje logaritma:</strong> \(\dfrac{d}{dx}(\ln^2 x) = \dfrac{2\ln x}{x}\)</li>
        </ul>
      </div>
    </details>
  </div>

  <!-- Canvas: Graph of the function -->
  <div class="card">
    <h2 class="card-title">Graf funkcije \(f(x) = x(\ln^2 x - 3)\) na \([1,\, e^2]\)</h2>
    <canvas id="mainCanvas" width="700" height="380"></canvas>
    <p class="canvas-hint">Karakteristicne tacke: krajevi segmenta i kriticna tacka</p>
  </div>

  <!-- Step-by-step solution -->
  <div class="card">
    <h2 class="card-title">Resenje korak po korak</h2>

    <!-- Step 1 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">1</div>
        <h3 class="step-title">Vrednosti na krajnjim tackama segmenta</h3>
      </div>
      <div class="step-body">
        <p>Za \(x = 1\): posto je \(\ln 1 = 0\), imamo:</p>
        <div class="math-block">
          \[f(1) = 1 \cdot (0^2 - 3) = -3\]
        </div>
        <p>Za \(x = e^2\): posto je \(\ln e^2 = 2\), imamo:</p>
        <div class="math-block">
          \[f(e^2) = e^2 \cdot (2^2 - 3) = e^2 \cdot 1 = e^2 \approx 7{,}389\]
        </div>
      </div>
    </div>

    <!-- Checkpoint 1 -->
    <div class="checkpoint">
      <details>
        <summary>Provera: Zasto je \(\ln e^2 = 2\)?</summary>
        <div class="answer">Po definiciji prirodnog logaritma, \(\ln e^k = k\) za svako realno \(k\). Posto je ovde \(k = 2\), odmah sledi \(\ln e^2 = 2\).</div>
      </details>
    </div>

    <!-- Step 2 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">2</div>
        <h3 class="step-title">Nalazenje izvoda funkcije</h3>
      </div>
      <div class="step-body">
        <p>Koristimo pravilo za deriviranje proizvoda \((uv)' = u'v + uv'\), gde je \(u = x\) i \(v = \ln^2 x - 3\):</p>
        <div class="math-block">
          \[f'(x) = 1 \cdot (\ln^2 x - 3) + x \cdot \frac{2\ln x}{x}\]
        </div>
        <p>Drugi sabirak se pojednostavljuje jer se \(x\) skracuje:</p>
        <div class="math-block">
          \[f'(x) = \ln^2 x + 2\ln x - 3\]
        </div>
      </div>
    </div>

    <!-- Step 3 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">3</div>
        <h3 class="step-title">Resavanje jednacine \(f'(x) = 0\) &mdash; smena</h3>
      </div>
      <div class="step-body">
        <p>Uvodimo smenu \(t = \ln x\) da bismo jednacinu sveli na kvadratnu:</p>
        <div class="math-block">
          \[t^2 + 2t - 3 = 0\]
        </div>
        <p>Faktorizacija:</p>
        <div class="math-block">
          \[(t + 3)(t - 1) = 0 \quad \Longrightarrow \quad t = -3 \;\;\text{ili}\;\; t = 1\]
        </div>
        <p>Vracamo se na promenljivu \(x\):</p>
        <div class="case-box">
          <div class="case-title">Slucaj 1: \(t = -3\)</div>
          <p>\(\ln x = -3 \;\Rightarrow\; x = e^{-3} \approx 0{,}050\)</p>
          <p style="color: #f472b6;">Ova vrednost je van segmenta \([1, e^2]\) &mdash; odbacujemo.</p>
        </div>
        <div class="case-box">
          <div class="case-title">Slucaj 2: \(t = 1\)</div>
          <p>\(\ln x = 1 \;\Rightarrow\; x = e \approx 2{,}718\)</p>
          <p style="color: #4ade80;">Ova vrednost pripada segmentu \([1, e^2]\) &mdash; prihvatamo.</p>
        </div>
      </div>
    </div>

    <!-- Checkpoint 2 -->
    <div class="checkpoint">
      <details>
        <summary>Provera: Da li je \(e \in [1, e^2]\)?</summary>
        <div class="answer">Da, jer je \(1 < e \approx 2{,}718 < e^2 \approx 7{,}389\). Tacka \(x = e\) lezi strogo unutar segmenta.</div>
      </details>
    </div>

    <!-- Step 4 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">4</div>
        <h3 class="step-title">Vrednost u kriticnoj tacki</h3>
      </div>
      <div class="step-body">
        <p>Racunamo \(f(e)\):</p>
        <div class="math-block">
          \[f(e) = e \cdot (\ln^2 e - 3) = e \cdot (1^2 - 3) = e \cdot (-2) = -2e \approx -5{,}436\]
        </div>
      </div>
    </div>

    <!-- Step 5 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">5</div>
        <h3 class="step-title">Poredjenje svih vrednosti &mdash; odredjivanje ekstrema</h3>
      </div>
      <div class="step-body">
        <p>Uporedimo vrednosti funkcije u sve tri relevantne tacke:</p>
        <table>
          <thead>
            <tr><th>Tacka</th><th>Vrednost</th><th>Aproksimacija</th></tr>
          </thead>
          <tbody>
            <tr><td>\(x = 1\)</td><td>\(f(1) = -3\)</td><td>\(-3{,}000\)</td></tr>
            <tr><td>\(x = e\)</td><td class="highlight-min">\(f(e) = -2e\)</td><td class="highlight-min">\(\approx -5{,}436\) &mdash; minimum</td></tr>
            <tr><td>\(x = e^2\)</td><td class="highlight-max">\(f(e^2) = e^2\)</td><td class="highlight-max">\(\approx +7{,}389\) &mdash; maksimum</td></tr>
          </tbody>
        </table>
        <div class="math-block">
          \[m = f(e) = -2e \qquad M = f(e^2) = e^2\]
        </div>
        <p class="note">Najmanja vrednost se dostize u unutrasnjoj kriticnoj tacki, a najveca na desnom kraju segmenta.</p>
      </div>
    </div>

    <!-- Step 6 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">6</div>
        <h3 class="step-title">Racunanje kolicnika i odredjivanje skupa</h3>
      </div>
      <div class="step-body">
        <p>Kolicnik najvece i najmanje vrednosti:</p>
        <div class="math-block">
          \[\frac{M}{m} = \frac{e^2}{-2e} = -\frac{e}{2}\]
        </div>
        <p>Posto je \(e \approx 2{,}718\):</p>
        <div class="math-block">
          \[-\frac{e}{2} \approx -\frac{2{,}718}{2} \approx -1{,}359\]
        </div>
        <p>Proveravamo pripadnost ponudjenim skupovima:</p>
        <ul style="list-style: disc; padding-left: 24px; color: #cbd5e1; margin: 10px 0;">
          <li>A) \((-\infty, -3)\): ne, jer \(-1{,}359 > -3\)</li>
          <li>B) \([-1, 1)\): ne, jer \(-1{,}359 < -1\)</li>
          <li>C) \([1, +\infty)\): ne, jer je vrednost negativna</li>
          <li>D) \([-3, -2)\): ne, jer \(-1{,}359 > -2\)</li>
          <li style="color: #4ade80;"><strong>E) \([-2, -1)\): da, jer \(-2 \leq -1{,}359 < -1\)</strong></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Key Insight -->
  <div class="card insight-card">
    <h2 class="card-title">Kljucni uvid</h2>
    <p>Smena \(t = \ln x\) pretvara transcendentnu jednacinu \(f'(x) = 0\) u obicnu kvadratnu jednacinu. Kriticno je zatim proveriti koje od resenja pripada zadatom segmentu. U ovom zadatku, jedno resenje (\(x = e^{-3}\)) otpada, a drugo (\(x = e\)) daje globalni minimum na celom segmentu, dok se globalni maksimum dostize na desnom krajnjem.</p>
    <div class="big-formula">
      \[\frac{M}{m} = \frac{e^2}{-2e} = -\frac{e}{2} \approx -1{,}359 \;\in\; [-2,\,-1)\]
    </div>
  </div>

  <!-- Final Answer -->
  <div class="card final-answer-card">
    <h2 class="card-title" style="justify-content: center;">Konacan odgovor</h2>
    <div class="final-answer-text">\(\displaystyle -\frac{e}{2} \in [-2,\,-1)\)</div>
    <div class="final-options">
      <div class="final-option">(A) \((-\infty,-3)\)</div>
      <div class="final-option">(B) \([-1,1)\)</div>
      <div class="final-option">(C) \([1,+\infty)\)</div>
      <div class="final-option">(D) \([-3,-2)\)</div>
      <div class="final-option correct">(E) \([-2,-1)\)</div>
    </div>
    <div class="verification">
      <div class="verification-title">Verifikacija</div>
      <p>Proverimo numericku vrednost: \(e \approx 2{,}71828\), pa je \(-e/2 \approx -1{,}35914\). Zaista, \(-2 \leq -1{,}35914 < -1\), te kolicnik pripada skupu \([-2, -1)\).</p>
    </div>
  </div>

  <!-- Common Pitfalls -->
  <div class="card pitfall-card">
    <h2 class="card-title"><span class="pitfall-title">Ceste greske</span></h2>
    <ul>
      <li><strong>Zaboraviti krajnje tacke segmenta:</strong> Minimum ili maksimum neprekidne funkcije na zatvorenom intervalu moze biti i na krajnjim tackama &mdash; uvek treba proveriti \(f(a)\) i \(f(b)\), ne samo kriticne tacke.</li>
      <li><strong>Ne proveriti pripadnost kriticne tacke segmentu:</strong> Resenje \(x = e^{-3}\) jednacine \(f'(x) = 0\) mora se odbaciti jer je van \([1, e^2]\). Ukljucivanje ove tacke bi dovelo do pogresnog rezultata.</li>
      <li><strong>Pomesati redosled u kolicniku:</strong> Zadatak trazi kolicnik <em>najvece</em> podeljeno sa <em>najmanjom</em> vrednoscu, tj. \(M/m = e^2/(-2e)\), a ne obrnuto. Pogresan redosled daje \(-2/e\) umesto \(-e/2\).</li>
      <li><strong>Znak kolicnika:</strong> Posto je \(M > 0\) a \(m < 0\), kolicnik je obavezno negativan. Odgovori (B) i (C) koji ukljucuju nenegativne vrednosti odmah se mogu eliminisati.</li>
    </ul>
  </div>

  <!-- Challenge -->
  <div class="card challenge-card">
    <h2 class="card-title">Dodatni izazov</h2>
    <p>Za koje vrednosti parametra \(a > 0\) funkcija \(g(x) = x(\ln^2 x - a)\) na segmentu \([1, e^2]\) ima tacno jednu kriticnu tacku unutar tog segmenta?</p>
    <details>
      <summary>Pogledaj nagovestaj</summary>
      <div style="padding-top: 10px; color: #cbd5e1;">
        Izvod je \(g'(x) = \ln^2 x + 2\ln x - a\). Smena \(t = \ln x\) daje \(t^2 + 2t - a = 0\), odakle je \(t = -1 \pm \sqrt{1 + a}\). Za \(x \in [1, e^2]\) je \(t \in [0, 2]\). Uslov da tacno jedno resenje bude u \([0, 2]\) daje ogranicenje na \(a\).
      </div>
    </details>
  </div>

</div>

<script>
(function() {
  var canvas = document.getElementById('mainCanvas');
  if (!canvas) return;
  var ctx = canvas.getContext('2d');

  function f(x) {
    var l = Math.log(x);
    return x * (l * l - 3);
  }

  function setup() {
    var dpr = window.devicePixelRatio || 1;
    var W = Math.min(canvas.parentElement.clientWidth - 56, 700);
    var H = 380;
    canvas.width = W * dpr;
    canvas.height = H * dpr;
    canvas.style.width = W + 'px';
    canvas.style.height = H + 'px';
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    draw(W, H);
  }

  function draw(W, H) {
    ctx.clearRect(0, 0, W, H);

    // Background
    ctx.fillStyle = '#0f172a';
    ctx.fillRect(0, 0, W, H);

    // Plot area
    var PAD_L = 60, PAD_R = 30, PAD_T = 30, PAD_B = 50;
    var plotW = W - PAD_L - PAD_R;
    var plotH = H - PAD_T - PAD_B;

    var E = Math.E;
    var xMin = 0.8, xMax = E * E + 0.3;
    var fMin = -2 * E - 1.2, fMax = E * E + 1.5;

    function toX(x) { return PAD_L + (x - xMin) / (xMax - xMin) * plotW; }
    function toY(y) { return PAD_T + plotH - (y - fMin) / (fMax - fMin) * plotH; }

    // Grid lines
    ctx.strokeStyle = '#1e293b';
    ctx.lineWidth = 1;
    var yTicks = [-6, -4, -2, 0, 2, 4, 6, 8];
    for (var i = 0; i < yTicks.length; i++) {
      var yv = yTicks[i];
      if (yv < fMin || yv > fMax) continue;
      var cy = toY(yv);
      ctx.beginPath(); ctx.moveTo(PAD_L, cy); ctx.lineTo(PAD_L + plotW, cy); ctx.stroke();
    }

    // Axes
    ctx.strokeStyle = '#475569';
    ctx.lineWidth = 1.5;
    var yZero = toY(0);
    ctx.beginPath(); ctx.moveTo(PAD_L, yZero); ctx.lineTo(PAD_L + plotW, yZero); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(PAD_L, PAD_T); ctx.lineTo(PAD_L, PAD_T + plotH); ctx.stroke();

    // Draw function curve
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2.5;
    ctx.beginPath();
    var N = 500;
    var started = false;
    for (var i = 0; i <= N; i++) {
      var x = 1 + (E * E - 1) * i / N;
      var y = f(x);
      var px = toX(x);
      var py = toY(y);
      if (!started) { ctx.moveTo(px, py); started = true; }
      else ctx.lineTo(px, py);
    }
    ctx.stroke();

    // Special points
    var pts = [
      { x: 1,     y: f(1),     label: 'f(1) = -3',   color: '#94a3b8', yLabel: '-3',   tag: '' },
      { x: E,     y: f(E),     label: 'f(e) = -2e',   color: '#f472b6', yLabel: '-2e',  tag: 'MIN' },
      { x: E * E, y: f(E * E), label: 'f(e\u00B2) = e\u00B2', color: '#4ade80', yLabel: 'e\u00B2', tag: 'MAX' }
    ];

    for (var i = 0; i < pts.length; i++) {
      var pt = pts[i];
      var px = toX(pt.x);
      var py = toY(pt.y);

      // Dashed drop lines to axes
      ctx.setLineDash([4, 4]);
      ctx.strokeStyle = pt.color + '88';
      ctx.lineWidth = 1;
      ctx.beginPath(); ctx.moveTo(px, py); ctx.lineTo(px, yZero); ctx.stroke();
      ctx.beginPath(); ctx.moveTo(px, py); ctx.lineTo(PAD_L, py); ctx.stroke();
      ctx.setLineDash([]);

      // Point circle
      ctx.fillStyle = pt.color;
      ctx.beginPath(); ctx.arc(px, py, 6, 0, Math.PI * 2); ctx.fill();
      ctx.strokeStyle = '#0f172a';
      ctx.lineWidth = 2;
      ctx.beginPath(); ctx.arc(px, py, 6, 0, Math.PI * 2); ctx.stroke();

      // y-axis label
      ctx.fillStyle = pt.color;
      ctx.font = 'bold 11px "Segoe UI", sans-serif';
      ctx.textAlign = 'right';
      ctx.fillText(pt.yLabel, PAD_L - 6, py + 4);

      // Tag (MAX/MIN)
      if (pt.tag) {
        ctx.fillStyle = pt.color;
        ctx.font = 'bold 12px "Segoe UI", sans-serif';
        ctx.textAlign = 'left';
        ctx.fillText(pt.tag, px + 10, py - 6);
      }
    }

    // x-axis labels
    ctx.fillStyle = '#94a3b8';
    ctx.font = '12px "Segoe UI", sans-serif';
    ctx.textAlign = 'center';
    var xLabels = [{ x: 1, lbl: '1' }, { x: E, lbl: 'e' }, { x: E * E, lbl: 'e\u00B2' }];
    for (var i = 0; i < xLabels.length; i++) {
      ctx.fillText(xLabels[i].lbl, toX(xLabels[i].x), PAD_T + plotH + 20);
    }

    // y-axis zero label
    ctx.textAlign = 'right';
    ctx.fillText('0', PAD_L - 6, yZero + 4);

    // Axis titles
    ctx.fillStyle = '#60a5fa';
    ctx.font = 'italic 13px "Segoe UI", sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('f(x)', PAD_L + 4, PAD_T + 14);
    ctx.textAlign = 'right';
    ctx.fillText('x', PAD_L + plotW - 2, yZero - 8);

    // Quotient annotation
    ctx.fillStyle = '#a78bfa';
    ctx.font = 'bold 13px "Segoe UI", sans-serif';
    ctx.textAlign = 'right';
    ctx.fillText('M/m = e\u00B2/(-2e) = -e/2 \u2248 -1,359', W - PAD_R - 4, PAD_T + 20);
  }

  setup();
  window.addEventListener('resize', setup);

  // Touch support for canvas
  canvas.addEventListener('touchstart', function(e) { e.preventDefault(); }, { passive: false });
  canvas.addEventListener('touchmove', function(e) { e.preventDefault(); }, { passive: false });
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{"title":"Kolicnik ekstrema funkcije x(ln\u00B2x - 3) na segmentu [1, e\u00B2]","subject":"math","unit":"calculus","topic_tags":["ekstremi_funkcije","izvod","logaritamska_funkcija","segment","kvadratna_jednacina"]}
BRAINSPARK_META-->