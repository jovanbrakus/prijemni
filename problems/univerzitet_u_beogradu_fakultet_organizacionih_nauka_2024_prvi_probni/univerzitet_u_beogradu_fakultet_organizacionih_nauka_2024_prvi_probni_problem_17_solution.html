<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zadatak 17 — Pravilna trostrana prizma</title>

<script type="text/info" id="logic-scratchpad">
=== LOGICKA PRIPREMA ===

Zadato: Pravilna trostrana prizma ABCA1B1C1 visine h, osnove povrsine S.
Tacke P na AA1, Q na BB1, R na CC1.
  |PA1| = 2|AP|  =>  AP + PA1 = h,  AP + 2*AP = h  =>  AP = h/3
  |QB1| = 2|BQ|  =>  BQ + QB1 = h,  BQ + 2*BQ = h  =>  BQ = h/3
  CR = x  (nepoznata),  RC1 = h - x

Ravan PQR deli prizmu na dva dela jednakih zapremina.

DONJI DEO (od osnove ABC do ravni PQR) je zasecena trostrana prizma.
Visine iznad temena A, B, C su redom: h1 = AP = h/3, h2 = BQ = h/3, h3 = CR = x.

Formula za zapreminu zasecene trostrane prizme:
  V = S/3 * (h1 + h2 + h3)

Uslov: V_donji = V_prizma / 2 = Sh/2

  S/3 * (h/3 + h/3 + x) = Sh/2
  (2h/3 + x) / 3 = h/2
  2h/3 + x = 3h/2
  x = 3h/2 - 2h/3 = 9h/6 - 4h/6 = 5h/6

Dakle:  CR = 5h/6,  RC1 = h/6
Odnos:  CR : RC1 = 5 : 1

PROVERA:
  V_donji = S/3 * (h/3 + h/3 + 5h/6)
          = S/3 * (2h/6 + 2h/6 + 5h/6)
          = S/3 * 9h/6
          = S/3 * 3h/2
          = Sh/2  ✓

ODGOVOR: B) 5:1
</script>

<script>
MathJax = { tex: { inlineMath: [['\\(','\\)'],['$','$']], displayMath: [['\\[','\\]']] }, svg: { fontCache: 'global' } };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}

body{
  background:#0f172a;color:#e2e8f0;
  font-family:'Segoe UI',system-ui,sans-serif;
  font-size:16px;line-height:1.7;
  padding:24px 16px 60px;
}

.container{max-width:860px;margin:0 auto}

h1{
  font-size:1.6rem;font-weight:800;margin-bottom:6px;
  background:linear-gradient(135deg,#60a5fa,#a78bfa);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  background-clip:text;
}
h2{font-size:1.15rem;font-weight:700;color:#60a5fa;margin:28px 0 12px}
h3{font-size:1rem;font-weight:600;color:#94a3b8;margin-bottom:8px}

.card{
  background:#1e293b;border:1px solid #334155;
  border-radius:12px;padding:20px 24px;margin-bottom:20px;
}

.problem-statement{border-left:4px solid #a78bfa}
.problem-statement p{font-size:1.05rem;margin-bottom:12px}

/* Answer options - static, no interactivity */
.given-grid{display:flex;flex-wrap:wrap;gap:10px;margin-top:14px}
.given-item.answer-option{
  background:#0f172a;border:1px solid #475569;border-radius:8px;
  padding:8px 16px;display:flex;align-items:center;gap:6px;
  color:#cbd5e1;font-size:0.95rem;
}
.given-item.answer-option .label{font-weight:700;color:#94a3b8}
.given-item.answer-option .value{color:#e2e8f0}

/* Plan */
.plan-list{list-style:none;counter-reset:plan}
.plan-list li{
  counter-increment:plan;display:flex;align-items:flex-start;gap:12px;margin-bottom:10px;
}
.plan-list li::before{
  content:counter(plan);min-width:28px;height:28px;
  background:#a78bfa22;border:1px solid #a78bfa;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:0.8rem;font-weight:700;color:#a78bfa;flex-shrink:0;
}

/* Theory details */
details{
  background:#1e293b;border:1px solid #334155;border-radius:10px;margin-bottom:20px;
}
details summary{
  padding:14px 20px;cursor:pointer;font-weight:600;color:#60a5fa;
  list-style:none;display:flex;align-items:center;gap:8px;
}
details summary::before{content:'\25B6';font-size:0.7rem;transition:transform 0.2s}
details[open] summary::before{transform:rotate(90deg)}
details summary::-webkit-details-marker{display:none}
details .details-body{padding:0 20px 16px}
details .details-body p,details .details-body li{margin-bottom:8px;font-size:0.95rem;color:#cbd5e1}
details ul{padding-left:20px}

.formula-grid{
  display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;margin-top:8px;
}
.formula-box{
  background:#0f172a;border-left:3px solid #60a5fa;border-radius:8px;
  padding:12px 16px;color:#93c5fd;font-size:0.95rem;
}
.formula-box .formula-label{color:#94a3b8;font-size:0.82rem;margin-bottom:4px}

/* Canvas */
.canvas-wrapper{
  background:#1e293b;border:1px solid #334155;border-radius:12px;
  padding:16px;margin-bottom:20px;overflow:hidden;
}
canvas{display:block;width:100%;border-radius:8px;touch-action:none}
.slider-row{display:flex;align-items:center;gap:12px;margin-top:10px}
.slider-row label{color:#94a3b8;font-size:0.9rem;white-space:nowrap}
input[type=range]{flex:1;accent-color:#60a5fa}
.slider-val{color:#60a5fa;font-weight:700;font-size:0.9rem;width:48px;text-align:right}
.canvas-hint{color:#64748b;font-size:0.82rem;margin-top:8px}

/* Steps */
.step{
  background:#1e293b;border:1px solid #334155;border-radius:10px;
  padding:16px 20px;margin-bottom:14px;
}
.step-badge{
  display:inline-block;background:#1e3a5f;border:1px solid #60a5fa;color:#60a5fa;
  font-size:0.72rem;font-weight:700;padding:2px 10px;border-radius:20px;
  margin-bottom:8px;text-transform:uppercase;letter-spacing:0.05em;
}
.step-badge.purple{background:#2d1b69;border-color:#a78bfa;color:#a78bfa}
.step-badge.green{background:#0d3b2b;border-color:#34d399;color:#34d399}
.step-badge.pink{background:#3d1030;border-color:#f472b6;color:#f472b6}

.checkpoint{
  display:flex;align-items:center;gap:8px;
  background:#0d3b2b;border:1px solid #34d399;border-radius:8px;
  padding:10px 14px;margin-top:12px;
  font-size:0.9rem;color:#4ade80;font-weight:600;
}
.checkpoint::before{content:'\2713';font-size:1rem}

/* Key insight */
.insight{
  background:#1e1b4b;border:1px solid #a78bfa;border-radius:10px;
  padding:16px 20px;margin-bottom:20px;
}
.insight-title{color:#a78bfa;font-weight:700;margin-bottom:6px;font-size:0.9rem;text-transform:uppercase;letter-spacing:0.05em}

/* Final answer */
.final-answer{
  background:#0d3b2b;border:2px solid #34d399;border-radius:12px;
  padding:20px 24px;margin-bottom:20px;text-align:center;
}
.final-answer .label{font-size:0.85rem;color:#34d399;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;margin-bottom:8px}
.final-answer .value{font-size:1.6rem;color:#4ade80;font-weight:700}

.options-row{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;margin-top:14px}
.opt-pill{
  padding:8px 18px;border-radius:9px;font-size:0.95rem;font-weight:600;
  border:1.5px solid #475569;color:#94a3b8;background:#0f172a;
}
.opt-pill.correct{border-color:#34d399;color:#34d399;background:rgba(52,211,153,0.08)}

/* Pitfalls */
.pitfall{
  display:flex;gap:12px;align-items:flex-start;
  background:#2d1010;border:1px solid #f472b6;border-radius:8px;
  padding:12px 16px;margin-bottom:10px;font-size:0.9rem;
}
.pitfall::before{
  content:'!';min-width:22px;height:22px;background:#f472b6;color:#0f172a;
  border-radius:50%;display:flex;align-items:center;justify-content:center;
  font-weight:900;flex-shrink:0;font-size:0.8rem;
}

/* Challenge */
.challenge{
  background:#1e293b;border:1px dashed #60a5fa;border-radius:10px;
  padding:16px 20px;font-size:0.95rem;
}
.challenge-title{color:#60a5fa;font-weight:700;margin-bottom:8px}

@media(max-width:700px){
  h1{font-size:1.25rem}
  .given-grid{flex-direction:column}
  body{padding:16px 12px 40px}
}
</style>
</head>
<body>
<div class="container">

<h1>Zadatak 17 — Pravilna trostrana prizma i raspodela zapremine</h1>

<!-- Problem Statement -->
<div class="card problem-statement">
  <p>
    Data je pravilna trostrana prizma sa osnovama \(ABC\) i \(A_1B_1C_1\).
    Na ivicama \(AA_1\), \(BB_1\) i \(CC_1\) se, redom, nalaze tacke \(P\), \(Q\) i \(R\) takve
    da je \(|PA_1| = 2|AP|\), \(|QB_1| = 2|BQ|\) i trougao \(PQR\) deli datu prizmu na dva dela
    jednakih zapremina. Odnos \(|CR| : |RC_1|\) jednak je:
  </p>
  <div class="given-grid">
    <div class="given-item answer-option" data-option="A"><div class="label">(A)</div><div class="value">\(4:3\)</div></div>
    <div class="given-item answer-option" data-option="B"><div class="label">(B)</div><div class="value">\(5:1\)</div></div>
    <div class="given-item answer-option" data-option="C"><div class="label">(C)</div><div class="value">\(3:2\)</div></div>
    <div class="given-item answer-option" data-option="D"><div class="label">(D)</div><div class="value">\(16:9\)</div></div>
    <div class="given-item answer-option" data-option="E"><div class="label">(E)</div><div class="value">\(4:1\)</div></div>
  </div>
</div>

<!-- Plan -->
<h2>Plan resavanja</h2>
<div class="card">
  <ul class="plan-list">
    <li>Iz uslova za tacke \(P\) i \(Q\) odrediti njihove visine od donje osnove.</li>
    <li>Oznaciti \(|CR| = x\) i primeniti formulu za zapreminu zasecene trostrane prizme.</li>
    <li>Postaviti jednacinu: zapremina donjeg dela = polovina zapremine prizme.</li>
    <li>Resiti jednacinu po \(x\) i izracunati trazeni odnos \(|CR| : |RC_1|\).</li>
  </ul>
</div>

<!-- Theory -->
<details>
  <summary>Teorijsko podsecanje — zasecena trostrana prizma</summary>
  <div class="details-body">
    <div class="formula-grid">
      <div class="formula-box">
        <div class="formula-label">Zapremina prave trostrane prizme</div>
        \[V = S \cdot h\]
        \(S\) — povrsina osnove, \(h\) — visina prizme.
      </div>
      <div class="formula-box">
        <div class="formula-label">Zasecena trostrana prizma</div>
        Ako su visine iznad temena osnove redom \(h_1, h_2, h_3\):
        \[V = \frac{S}{3}(h_1 + h_2 + h_3)\]
      </div>
      <div class="formula-box">
        <div class="formula-label">Raspodela duzine ivice</div>
        Ako \(|PA_1| = 2|AP|\) i \(|AP| + |PA_1| = h\):
        \[|AP| = \frac{h}{3}\]
      </div>
    </div>
    <p style="margin-top:12px;">
      Formula za zasecenu prizmu sledi iz razlaganja na tri tetraedra sa zajednickom osnovom \(ABC\)
      i po jednim temenom u \(P\), \(Q\), \(R\). Svaki tetraedar ima zapreminu \(\frac{S}{3}h_i\), pa je ukupno
      \(\frac{S}{3}(h_1+h_2+h_3)\).
    </p>
  </div>
</details>

<!-- Canvas diagram -->
<div class="canvas-wrapper">
  <h3 style="margin-bottom:10px;">Dijagram prizme sa ravni PQR</h3>
  <canvas id="prismCanvas" height="420"></canvas>
  <div class="slider-row">
    <label>Polozaj R (t = CR/h):</label>
    <input type="range" id="sliderT" min="0" max="100" value="83" step="1" />
    <span class="slider-val" id="sliderTVal">5/6</span>
  </div>
  <p class="canvas-hint">Pomeri klizac da vidis kako se menja polozaj tacke R na ivici CC<sub>1</sub>. Pri t = 5/6 prizma se deli na dva jednaka dela.</p>
</div>

<!-- Steps -->
<h2>Resenje korak po korak</h2>

<div class="step">
  <div class="step-badge">Korak 1</div>
  <p><strong>Odredjivanje polozaja tacke P na ivici \(AA_1\)</strong></p>
  <p>
    Iz uslova \(|PA_1| = 2|AP|\) i cinjenice da je \(|AP| + |PA_1| = h\):
  </p>
  \[|AP| + 2|AP| = h \implies 3|AP| = h \implies |AP| = \frac{h}{3}\]
  <p>Tacka \(P\) se nalazi na visini \(\dfrac{h}{3}\) od donje osnove.</p>
  <div class="checkpoint">P lezi na visini h/3 od osnove ABC</div>
</div>

<div class="step">
  <div class="step-badge">Korak 2</div>
  <p><strong>Odredjivanje polozaja tacke Q na ivici \(BB_1\)</strong></p>
  <p>
    Analogno, iz uslova \(|QB_1| = 2|BQ|\):
  </p>
  \[|BQ| + 2|BQ| = h \implies 3|BQ| = h \implies |BQ| = \frac{h}{3}\]
  <p>Tacka \(Q\) se takodze nalazi na visini \(\dfrac{h}{3}\) od donje osnove.</p>
  <div class="checkpoint">Q lezi na visini h/3 od osnove ABC</div>
</div>

<div class="step">
  <div class="step-badge purple">Korak 3</div>
  <p><strong>Uvodjenje nepoznate za tacku R</strong></p>
  <p>
    Neka je \(|CR| = x\), gde je \(0 \leq x \leq h\). Tada je \(|RC_1| = h - x\).
  </p>
  <p>
    Ravan \(PQR\) sece prizmu na donji deo (od osnove \(ABC\) do ravni \(PQR\)) i gornji deo.
    Donji deo je <strong>zasecena trostrana prizma</strong> sa visinama iznad temena:
  </p>
  \[h_1 = |AP| = \frac{h}{3},\quad h_2 = |BQ| = \frac{h}{3},\quad h_3 = |CR| = x\]
</div>

<div class="step">
  <div class="step-badge purple">Korak 4</div>
  <p><strong>Zapremina donjeg dela — formula za zasecenu prizmu</strong></p>
  <p>Primenjujemo formulu za zapreminu zasecene trostrane prizme:</p>
  \[V_{\text{donji}} = \frac{S}{3}(h_1 + h_2 + h_3) = \frac{S}{3}\!\left(\frac{h}{3} + \frac{h}{3} + x\right) = \frac{S}{3}\!\left(\frac{2h}{3} + x\right)\]
</div>

<div class="step">
  <div class="step-badge green">Korak 5</div>
  <p><strong>Postavljanje jednacine za jednake zapremine</strong></p>
  <p>Uslov je da ravan \(PQR\) deli prizmu na dva jednaka dela:</p>
  \[V_{\text{donji}} = \frac{V_{\text{prizma}}}{2} = \frac{S \cdot h}{2}\]
  <p>Uvrstavamo:</p>
  \[\frac{S}{3}\!\left(\frac{2h}{3} + x\right) = \frac{S \cdot h}{2}\]
</div>

<div class="step">
  <div class="step-badge green">Korak 6</div>
  <p><strong>Resavanje jednacine po \(x\)</strong></p>
  <p>Delimo obe strane sa \(S \neq 0\):</p>
  \[\frac{1}{3}\!\left(\frac{2h}{3} + x\right) = \frac{h}{2}\]
  <p>Mnozimo sa 3:</p>
  \[\frac{2h}{3} + x = \frac{3h}{2}\]
  <p>Izrazavamo \(x\):</p>
  \[x = \frac{3h}{2} - \frac{2h}{3} = \frac{9h}{6} - \frac{4h}{6} = \frac{5h}{6}\]
  <div class="checkpoint">\(|CR| = \dfrac{5h}{6}\)</div>
</div>

<div class="step">
  <div class="step-badge pink">Korak 7</div>
  <p><strong>Racunanje trazenog odnosa</strong></p>
  <p>Imamo \(|CR| = \dfrac{5h}{6}\), pa je:</p>
  \[|RC_1| = h - \frac{5h}{6} = \frac{h}{6}\]
  <p>Trazeni odnos:</p>
  \[|CR| : |RC_1| = \frac{5h}{6} : \frac{h}{6} = \boxed{5 : 1}\]
  <div class="checkpoint">Odnos |CR| : |RC1| = 5 : 1</div>
</div>

<div class="step">
  <div class="step-badge pink">Provera</div>
  <p><strong>Verifikacija rezultata</strong></p>
  <p>Proverimo da donji deo zaista ima polovinu zapremine:</p>
  \[V_{\text{donji}} = \frac{S}{3}\!\left(\frac{h}{3} + \frac{h}{3} + \frac{5h}{6}\right) = \frac{S}{3} \cdot \frac{2h + 2h + 5h}{6} = \frac{S}{3} \cdot \frac{9h}{6} = \frac{S}{3} \cdot \frac{3h}{2} = \frac{Sh}{2}\]
  <p>Ovo je zaista \(\dfrac{V_{\text{prizma}}}{2} = \dfrac{Sh}{2}\). Rezultat je tacan.</p>
  <div class="checkpoint">Provera potvrdjena: V_donji = Sh/2 = V_prizma / 2</div>
</div>

<!-- Key Insight -->
<div class="insight">
  <div class="insight-title">Kljucno zapazanje</div>
  <p>
    Formula za zapreminu zasecene trostrane prizme \(V = \frac{S}{3}(h_1 + h_2 + h_3)\) je kljuc ovog zadatka.
    Ona se moze tumaciti kao: zapremina je jednaka proizvodu povrsine osnove i <em>aritmeticke sredine</em>
    tri visine, tj. \(V = S \cdot \frac{h_1 + h_2 + h_3}{3}\). Posto su dve od tri visine jednake (\(h/3\)),
    jednacina po trecoj visini je linearna i lako se resava.
  </p>
</div>

<!-- Final Answer -->
<div class="final-answer">
  <div class="label">Tacan odgovor</div>
  <div class="value">B) &nbsp; \(|CR| : |RC_1| = 5 : 1\)</div>
  <div class="options-row" style="margin-top:14px;">
    <div class="opt-pill">(A) 4:3</div>
    <div class="opt-pill correct">(B) 5:1</div>
    <div class="opt-pill">(C) 3:2</div>
    <div class="opt-pill">(D) 16:9</div>
    <div class="opt-pill">(E) 4:1</div>
  </div>
</div>

<!-- Pitfalls -->
<h2>Ceste greske</h2>
<div class="pitfall">
  Pogresno tumacenje uslova \(|PA_1| = 2|AP|\): neki ucenici zakljuce da je \(|AP| = 2h/3\) umesto \(h/3\).
  Treba pazljivo: \(PA_1\) je veci deo (dvostruko duzi), pa je \(AP\) manji deo (trecina ivice).
</div>
<div class="pitfall">
  Nepoznavanje formule za zasecenu trostrantu prizmu. Bez nje zadatak zahteva razlaganje na tetraedre
  ili integraciju, sto je znatno komplikovanije. Formula \(\frac{S}{3}(h_1+h_2+h_3)\) se cesto pojavljuje
  na prijemnim ispitima.
</div>
<div class="pitfall">
  Zamena \(|CR|\) i \(|RC_1|\) u konacnom odgovoru. Tacka \(R\) je blizu vrha (\(5/6\) visine od osnove),
  pa je \(|RC_1| = h/6\) kratki ostatak. Trazeni odnos je \(5:1\), a ne \(1:5\).
</div>

<!-- Challenge -->
<div class="challenge">
  <div class="challenge-title">Izazovni zadatak</div>
  <p>
    Uopsti problem: neka je \(|PA_1| = k \cdot |AP|\) i \(|QB_1| = k \cdot |BQ|\)
    za proizvoljno \(k > 0\). Izraziti \(|CR| : |RC_1|\) u funkciji od \(k\).
  </p>
  <p style="margin-top:8px;color:#94a3b8;">
    <em>Uput:</em> Isti postupak daje \(|AP| = |BQ| = \dfrac{h}{k+1}\), pa iz jednacine
    \(\dfrac{2h}{k+1} + x = \dfrac{3h}{2}\) sledi
    \(x = h\!\left(\dfrac{3}{2} - \dfrac{2}{k+1}\right)\), odakle je
    \(|CR| : |RC_1| = \left(\dfrac{3}{2} - \dfrac{2}{k+1}\right) : \left(\dfrac{2}{k+1} - \dfrac{1}{2}\right)\).
  </p>
</div>

</div><!-- end .container -->

<script>
(function(){
  var canvas = document.getElementById('prismCanvas');
  var ctx = canvas.getContext('2d');
  var slider = document.getElementById('sliderT');
  var sliderVal = document.getElementById('sliderTVal');

  function setup(){
    var dpr = window.devicePixelRatio || 1;
    var W = Math.min(canvas.parentElement.clientWidth - 32, 820);
    var H = Math.round(W * 0.55);
    canvas.width = W * dpr;
    canvas.height = H * dpr;
    canvas.style.width = W + 'px';
    canvas.style.height = H + 'px';
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    drawPrism(getT(), W, H);
  }

  function getT(){ return parseFloat(slider.value) / 100; }

  function lerp(a, b, t){ return {x: a.x + (b.x - a.x)*t, y: a.y + (b.y - a.y)*t}; }

  function drawPrism(t, W, H){
    ctx.clearRect(0, 0, W, H);
    ctx.fillStyle = '#0f172a';
    ctx.fillRect(0, 0, W, H);

    // Prism geometry in pseudo-isometric projection
    var cx = W * 0.5;
    var cy = H * 0.52;
    var scale = Math.min(W / 720, H / 420);
    var a = 130 * scale;    // base triangle half-width
    var hP = 240 * scale;   // prism height in pixels
    var dz = 55 * scale;    // perspective horizontal offset

    // Bottom face vertices (A, B, C)
    var A  = {x: cx,       y: cy + hP/2};
    var B  = {x: cx - a,   y: cy + hP/2 + a*0.5};
    var C  = {x: cx + a,   y: cy + hP/2 + a*0.5};

    // Top face vertices (A1, B1, C1)
    var A1 = {x: cx - dz,     y: cy - hP/2};
    var B1 = {x: cx - a - dz, y: cy - hP/2 + a*0.5};
    var C1 = {x: cx + a - dz, y: cy - hP/2 + a*0.5};

    // Points P, Q, R
    var tP = 1/3, tQ = 1/3, tR = t;
    var P = lerp(A, A1, tP);
    var Q = lerp(B, B1, tQ);
    var R = lerp(C, C1, tR);

    var colEdge = '#475569';
    var colEdgeFwd = '#94a3b8';

    // --- Side faces (translucent fill) ---
    // Face A-B-B1-A1
    ctx.beginPath();
    ctx.moveTo(A.x,A.y); ctx.lineTo(B.x,B.y);
    ctx.lineTo(B1.x,B1.y); ctx.lineTo(A1.x,A1.y); ctx.closePath();
    ctx.fillStyle = 'rgba(96,165,250,0.06)'; ctx.fill();

    // Face A-C-C1-A1
    ctx.beginPath();
    ctx.moveTo(A.x,A.y); ctx.lineTo(C.x,C.y);
    ctx.lineTo(C1.x,C1.y); ctx.lineTo(A1.x,A1.y); ctx.closePath();
    ctx.fillStyle = 'rgba(96,165,250,0.06)'; ctx.fill();

    // Face B-C-C1-B1 (back face)
    ctx.beginPath();
    ctx.moveTo(B.x,B.y); ctx.lineTo(C.x,C.y);
    ctx.lineTo(C1.x,C1.y); ctx.lineTo(B1.x,B1.y); ctx.closePath();
    ctx.fillStyle = 'rgba(96,165,250,0.03)'; ctx.fill();

    // --- Lower region fill (below PQR) ---
    ctx.beginPath();
    ctx.moveTo(A.x,A.y); ctx.lineTo(B.x,B.y); ctx.lineTo(C.x,C.y); ctx.closePath();
    ctx.moveTo(P.x,P.y); ctx.lineTo(Q.x,Q.y); ctx.lineTo(R.x,R.y); ctx.closePath();
    // Fill bottom polygon A-B-Q-P
    ctx.beginPath();
    ctx.moveTo(A.x,A.y); ctx.lineTo(B.x,B.y);
    ctx.lineTo(Q.x,Q.y); ctx.lineTo(P.x,P.y); ctx.closePath();
    ctx.fillStyle = 'rgba(52,211,153,0.08)'; ctx.fill();

    // --- Plane PQR ---
    ctx.beginPath();
    ctx.moveTo(P.x,P.y); ctx.lineTo(Q.x,Q.y); ctx.lineTo(R.x,R.y); ctx.closePath();
    ctx.fillStyle = 'rgba(52,211,153,0.18)';
    ctx.fill();
    ctx.strokeStyle = '#34d399';
    ctx.lineWidth = 2;
    ctx.setLineDash([6,4]);
    ctx.stroke();
    ctx.setLineDash([]);

    // --- Edges ---
    function edge(p1,p2,dashed,col){
      ctx.beginPath();
      ctx.moveTo(p1.x,p1.y); ctx.lineTo(p2.x,p2.y);
      ctx.strokeStyle = col || colEdge;
      ctx.lineWidth = dashed ? 1 : 1.5;
      if(dashed) ctx.setLineDash([4,5]); else ctx.setLineDash([]);
      ctx.stroke(); ctx.setLineDash([]);
    }

    // Bottom face
    edge(A,B,false,colEdgeFwd);
    edge(A,C,false,colEdgeFwd);
    edge(B,C,true,colEdge);

    // Top face
    edge(A1,B1,false,colEdgeFwd);
    edge(A1,C1,false,colEdgeFwd);
    edge(B1,C1,true,colEdge);

    // Lateral edges
    edge(A,A1,false,colEdgeFwd);
    edge(B,B1,false,colEdgeFwd);
    edge(C,C1,false,colEdgeFwd);

    // --- Height marks on lateral edges ---
    // Mark P on AA1
    ctx.setLineDash([2,3]);
    ctx.strokeStyle = '#f472b644';
    ctx.lineWidth = 1;
    ctx.beginPath(); ctx.moveTo(P.x-8,P.y); ctx.lineTo(P.x+8,P.y); ctx.stroke();
    // Mark Q on BB1
    ctx.strokeStyle = '#60a5fa44';
    ctx.beginPath(); ctx.moveTo(Q.x-8,Q.y); ctx.lineTo(Q.x+8,Q.y); ctx.stroke();
    // Mark R on CC1
    ctx.strokeStyle = '#34d39944';
    ctx.beginPath(); ctx.moveTo(R.x-8,R.y); ctx.lineTo(R.x+8,R.y); ctx.stroke();
    ctx.setLineDash([]);

    // --- Vertex labels ---
    function label(pt,txt,col,ox,oy){
      ctx.font = 'bold ' + Math.round(13*scale) + 'px Segoe UI, sans-serif';
      ctx.fillStyle = col || '#e2e8f0';
      ctx.fillText(txt, pt.x+(ox||0), pt.y+(oy||0));
    }

    label(A,  'A',  '#94a3b8',  6*scale, 16*scale);
    label(B,  'B',  '#94a3b8', -20*scale, 16*scale);
    label(C,  'C',  '#94a3b8',  6*scale, 16*scale);
    label(A1, 'A\u2081', '#94a3b8',  5*scale, -8*scale);
    label(B1, 'B\u2081', '#94a3b8', -22*scale, -8*scale);
    label(C1, 'C\u2081', '#94a3b8',  5*scale, -8*scale);

    // --- Points P, Q, R ---
    function dot(pt,col,r){
      ctx.beginPath(); ctx.arc(pt.x,pt.y,r||5*scale,0,Math.PI*2);
      ctx.fillStyle = col; ctx.fill();
      ctx.strokeStyle = '#0f172a'; ctx.lineWidth = 1.5;
      ctx.beginPath(); ctx.arc(pt.x,pt.y,r||5*scale,0,Math.PI*2); ctx.stroke();
    }

    dot(P, '#f472b6', 6*scale);
    dot(Q, '#60a5fa', 6*scale);
    dot(R, '#34d399', 6*scale);

    label(P, 'P', '#f472b6', -20*scale, -2*scale);
    label(Q, 'Q', '#60a5fa',  8*scale, -2*scale);
    label(R, 'R', '#34d399',  8*scale, -2*scale);

    // --- Height annotations ---
    // AP = h/3 annotation
    var midAP = lerp(A, P, 0.5);
    ctx.font = Math.round(11*scale) + 'px Segoe UI, sans-serif';
    ctx.fillStyle = '#f472b6';
    ctx.textAlign = 'right';
    ctx.fillText('h/3', midAP.x - 10*scale, midAP.y + 4*scale);

    // BQ = h/3 annotation
    var midBQ = lerp(B, Q, 0.5);
    ctx.fillStyle = '#60a5fa';
    ctx.textAlign = 'left';
    ctx.fillText('h/3', midBQ.x + 10*scale, midBQ.y + 4*scale);

    // CR = x annotation
    var midCR = lerp(C, R, 0.5);
    ctx.fillStyle = '#34d399';
    ctx.textAlign = 'left';
    var crLabel = Math.abs(t - 5/6) < 0.01 ? '5h/6' : 'x';
    ctx.fillText(crLabel, midCR.x + 10*scale, midCR.y + 4*scale);

    ctx.textAlign = 'left';

    // --- Volume info overlay ---
    var vLower = (2/3 + t) / 3;  // V_lower / (S*h)
    var vUpper = 1 - vLower;
    var pctL = (vLower * 100).toFixed(1);
    var pctU = (vUpper * 100).toFixed(1);

    var infoX = 12*scale;
    var infoY = 22*scale;
    var fs = Math.round(13*scale);
    ctx.font = fs + 'px Segoe UI, sans-serif';
    ctx.fillStyle = '#60a5fa';
    ctx.fillText('Donji deo: ' + pctL + '%', infoX, infoY);
    ctx.fillStyle = '#a78bfa';
    ctx.fillText('Gornji deo: ' + pctU + '%', infoX, infoY + fs + 6);

    if(Math.abs(t - 5/6) < 0.015){
      ctx.fillStyle = '#34d399';
      ctx.font = 'bold ' + fs + 'px Segoe UI, sans-serif';
      ctx.fillText('Tacno! t = 5/6  =>  50% : 50%', infoX, infoY + 2*(fs+6));
    }
  }

  function updateLabel(t){
    if(Math.abs(t - 5/6) < 0.008) sliderVal.textContent = '5/6';
    else if(Math.abs(t - 1/3) < 0.008) sliderVal.textContent = '1/3';
    else if(Math.abs(t - 0.5) < 0.008) sliderVal.textContent = '1/2';
    else sliderVal.textContent = t.toFixed(2);
  }

  function redraw(){
    var t = getT();
    updateLabel(t);
    var W = parseFloat(canvas.style.width);
    var H = parseFloat(canvas.style.height);
    drawPrism(t, W, H);
  }

  slider.addEventListener('input', redraw);

  // Touch support for canvas area (passive)
  canvas.addEventListener('touchstart', function(e){ e.preventDefault(); }, {passive:false});
  canvas.addEventListener('touchmove', function(e){ e.preventDefault(); }, {passive:false});

  setup();
  window.addEventListener('resize', setup);
})();
</script>

</body>
</html>
