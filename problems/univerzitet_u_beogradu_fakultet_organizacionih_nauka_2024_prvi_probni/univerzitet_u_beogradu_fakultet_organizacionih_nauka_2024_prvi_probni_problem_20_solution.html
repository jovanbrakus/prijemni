<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Krug opisan oko trougla CDE</title>

  <script type="text/info" id="logic-scratchpad">
    PROBLEM:
    Trougao ABC: BC = 11, AC = 9, AB = 10.
    D je podnožje visine iz C na AB.
    E je središte AB (podnožje težišne duži iz C).
    Naći površinu kruga opisanog oko trougla CDE.

    KOORDINATNI PRISTUP:
    Stavimo A = (0, 0), B = (10, 0).

    Nalaženje C:
    AC = 9: x^2 + y^2 = 81
    BC = 11: (x - 10)^2 + y^2 = 121

    Oduzimamo:
    (x - 10)^2 + y^2 - x^2 - y^2 = 121 - 81
    -20x + 100 = 40
    x = 3

    y^2 = 81 - 9 = 72
    y = 6*sqrt(2)

    C = (3, 6*sqrt(2))

    TACKA D (podnozje visine iz C na AB):
    AB lezi na x-osi, pa je projekcija tacke C na AB prosto (3, 0).
    D = (3, 0)

    TACKA E (srediste AB — tezisna duz iz C):
    E = ((0 + 10)/2, 0) = (5, 0)

    TROUGAO CDE:
    C = (3, 6*sqrt(2))
    D = (3, 0)
    E = (5, 0)

    Stranice:
    CD = 6*sqrt(2) (vertikalna duz)
    DE = 2 (horizontalna duz)
    CE = sqrt(4 + 72) = sqrt(76) = 2*sqrt(19)

    Ugao pri D:
    CD je vertikalna, DE je horizontalna => ugao CDE = 90 stepeni.

    KRUG OPISAN OKO PRAVOUGLOG TROUGLA:
    Hipotenuza CE je precnik opisanog kruga.
    CE = 2*sqrt(19), pa je poluprecnik R = sqrt(19).

    Povrsina kruga:
    P = pi * R^2 = 19*pi cm^2

    ODGOVOR: C) 19*pi cm^2
  </script>

  <script>
    MathJax = {
      tex: {
        inlineMath: [['\\(', '\\)'], ['$', '$']],
        displayMath: [['\\[', '\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
  </script>

  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: #0f172a;
      color: #e2e8f0;
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      font-size: 16px;
      line-height: 1.7;
      padding: 24px 20px 60px;
    }

    .container { max-width: 1200px; margin: 0 auto; }

    h1 {
      font-size: 2rem;
      font-weight: 800;
      background: linear-gradient(135deg, #60a5fa, #a78bfa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 8px;
    }

    .subtitle {
      color: #94a3b8;
      font-size: 1rem;
      margin-bottom: 32px;
    }

    .card {
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: 14px;
      padding: 22px 26px;
      margin-bottom: 22px;
    }

    .card-title {
      font-size: 1.05rem;
      font-weight: 700;
      color: #60a5fa;
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .card-title .icon {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
      font-weight: 700;
      flex-shrink: 0;
    }

    .problem-statement .card-title .icon { background: #1d4ed8; color: #93c5fd; }

    .problem-text {
      font-size: 1.05rem;
      color: #e2e8f0;
      margin-bottom: 18px;
    }

    .given-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 14px;
    }

    .given-item.answer-option {
      background: #0f172a;
      border: 1px solid #475569;
      border-radius: 8px;
      padding: 8px 16px;
      font-size: 0.95rem;
      color: #cbd5e1;
      cursor: default;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .given-item.answer-option .label {
      font-weight: 700;
      color: #94a3b8;
    }

    .plan-card .card-title .icon { background: #0e7490; color: #67e8f9; }

    .plan-text {
      color: #94a3b8;
      font-style: italic;
    }

    details {
      border: 1px solid #334155;
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 10px;
    }

    summary {
      background: #1e293b;
      padding: 12px 18px;
      cursor: pointer;
      font-weight: 600;
      color: #a78bfa;
      list-style: none;
      display: flex;
      align-items: center;
      gap: 8px;
      user-select: none;
    }

    summary::-webkit-details-marker { display: none; }

    summary::before {
      content: '\25B6';
      font-size: 0.7rem;
      transition: transform 0.2s;
    }

    details[open] summary::before { transform: rotate(90deg); }

    .details-body {
      background: #0f172a;
      padding: 16px 20px;
      border-top: 1px solid #334155;
    }

    .formula-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 12px;
      margin-top: 8px;
    }

    .formula-box {
      background: #1e293b;
      border-left: 3px solid #60a5fa;
      border-radius: 8px;
      padding: 12px 16px;
      color: #93c5fd;
      font-size: 0.95rem;
    }

    .formula-box .formula-label {
      color: #94a3b8;
      font-size: 0.82rem;
      margin-bottom: 4px;
    }

    canvas {
      display: block;
      width: 100%;
      border-radius: 10px;
      touch-action: none;
    }

    .canvas-controls {
      display: flex;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }

    .canvas-hint {
      color: #64748b;
      font-size: 0.82rem;
      margin-top: 8px;
    }

    .steps-container { display: flex; flex-direction: column; gap: 20px; }

    .step {
      display: flex;
      gap: 18px;
      align-items: flex-start;
    }

    .step-badge {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, #1d4ed8, #7c3aed);
      color: #fff;
      font-weight: 800;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .step-content { flex: 1; }

    .step-title {
      font-weight: 700;
      font-size: 1rem;
      color: #c4b5fd;
      margin-bottom: 6px;
    }

    .step-body {
      color: #cbd5e1;
      font-size: 0.97rem;
    }

    .math-block {
      background: #0f172a;
      border: 1px solid #334155;
      border-radius: 8px;
      padding: 14px 18px;
      margin: 10px 0;
      overflow-x: auto;
    }

    .math-block.highlight {
      border-left: 3px solid #60a5fa;
    }

    .checkpoint {
      background: #0f172a;
      border: 1px solid #1d4ed8;
      border-radius: 8px;
      padding: 10px 14px;
      margin-top: 10px;
      color: #93c5fd;
      font-size: 0.93rem;
    }

    .insight-card {
      background: linear-gradient(135deg, #1e1b4b, #1e293b);
      border: 1px solid #4338ca;
      border-radius: 14px;
      padding: 22px 26px;
      margin-bottom: 22px;
    }

    .insight-card .card-title { color: #a78bfa; }
    .insight-card .card-title .icon { background: #4338ca; color: #c4b5fd; }

    .final-answer-card {
      background: linear-gradient(135deg, #064e3b, #1e293b);
      border: 2px solid #34d399;
      border-radius: 14px;
      padding: 22px 26px;
      margin-bottom: 22px;
      text-align: center;
    }

    .final-answer-card .card-title {
      color: #34d399;
      justify-content: center;
    }

    .final-answer-card .card-title .icon { background: #065f46; color: #6ee7b7; }

    .final-value {
      font-size: 2.4rem;
      font-weight: 900;
      color: #4ade80;
      margin: 12px 0 6px;
    }

    .final-label {
      color: #6ee7b7;
      font-size: 1rem;
    }

    .pitfall-card {
      background: #1e293b;
      border: 1px solid #7f1d1d;
      border-radius: 14px;
      padding: 22px 26px;
      margin-bottom: 22px;
    }

    .pitfall-card .card-title { color: #f87171; }
    .pitfall-card .card-title .icon { background: #7f1d1d; color: #fca5a5; }

    .pitfall-item {
      display: flex;
      gap: 10px;
      align-items: flex-start;
      margin-bottom: 10px;
      color: #fca5a5;
      font-size: 0.95rem;
    }

    .pitfall-item::before {
      content: '!';
      background: #7f1d1d;
      color: #fca5a5;
      border-radius: 50%;
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 0.8rem;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .challenge-card {
      background: #1e293b;
      border: 1px solid #d97706;
      border-radius: 14px;
      padding: 22px 26px;
      margin-bottom: 22px;
    }

    .challenge-card .card-title { color: #fbbf24; }
    .challenge-card .card-title .icon { background: #78350f; color: #fcd34d; }

    @media (max-width: 700px) {
      h1 { font-size: 1.4rem; }
      .card { padding: 16px 14px; }
      .step { gap: 12px; }
      .final-value { font-size: 1.8rem; }
      .given-grid { gap: 8px; }
    }
  </style>
</head>
<body>
<div class="container">

  <h1>Krug opisan oko trougla CDE</h1>
  <p class="subtitle">Geometrija trougla — visina, težišna duž i opisani krug</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <div class="card-title">
      <span class="icon">Z</span>
      Tekst zadatka
    </div>
    <div class="problem-text">
      U trouglu \(ABC\) čije su stranice \(|BC| = 11\) cm, \(|AC| = 9\) cm i \(|AB| = 10\) cm,
      date su tačke \(D\) i \(E\) na stranici \(AB\) takve da je \(CD\) visina,
      a \(CE\) težišna duž trougla \(ABC\). Površina kruga opisanog oko trougla \(CDE\) jednaka je:
    </div>
    <div class="given-grid">
      <div class="given-item answer-option" data-option="A"><div class="label">(A)</div><div class="value">\(20\pi\) cm\(^2\)</div></div>
      <div class="given-item answer-option" data-option="B"><div class="label">(B)</div><div class="value">\(23\pi\) cm\(^2\)</div></div>
      <div class="given-item answer-option" data-option="C"><div class="label">(C)</div><div class="value">\(19\pi\) cm\(^2\)</div></div>
      <div class="given-item answer-option" data-option="D"><div class="label">(D)</div><div class="value">\(\dfrac{69}{4}\pi\) cm\(^2\)</div></div>
      <div class="given-item answer-option" data-option="E"><div class="label">(E)</div><div class="value">\(18\pi\) cm\(^2\)</div></div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card plan-card">
    <div class="card-title">
      <span class="icon" style="background:#065f46;color:#6ee7b7;">P</span>
      Plan rešavanja
    </div>
    <p class="plan-text">
      Postavljamo koordinatni sistem sa \(A\) u koordinatnom početku i \(B\) na \(x\)-osi.
      Nalazimo koordinate tačke \(C\), zatim tačke \(D\) (nožište visine) i \(E\) (središte \(AB\)).
      Uočavamo da je ugao \(\angle CDE = 90°\), pa je \(CE\) prečnik opisane kružnice trougla \(CDE\)
      (Talesova teorema). Na kraju izračunavamo površinu te kružnice.
    </p>
  </div>

  <!-- Theory -->
  <details>
    <summary>Teorijsko podsećanje — korisne formule i teoreme</summary>
    <div class="details-body">
      <div class="formula-grid">
        <div class="formula-box">
          <div class="formula-label">Nožište visine iz temena C na stranicu AB</div>
          Duž \(AD\) (projekcija \(CA\) na \(AB\)):
          \[ AD = \frac{|AB|^2 + |AC|^2 - |BC|^2}{2 \cdot |AB|} \]
        </div>
        <div class="formula-box">
          <div class="formula-label">Središte stranice (težišna duž)</div>
          Tačka \(E\) je središte \(AB\):
          \[ AE = \frac{|AB|}{2} \]
        </div>
        <div class="formula-box">
          <div class="formula-label">Talesova teorema</div>
          Ako je \(\angle CDE = 90°\), onda je \(CE\) prečnik opisane kružnice trougla \(CDE\), a poluprečnik \(R = \frac{|CE|}{2}\).
        </div>
        <div class="formula-box">
          <div class="formula-label">Površina kružnice</div>
          \[ P = \pi R^2 \]
        </div>
      </div>
    </div>
  </details>

  <!-- Canvas Diagram -->
  <div class="card" style="margin-top:10px;">
    <div class="card-title">
      <span class="icon" style="background:#4c1d95;color:#c4b5fd;">D</span>
      Geometrijski prikaz
    </div>
    <canvas id="geomCanvas" height="420"></canvas>
    <div class="canvas-controls">
      <span class="canvas-tab active" id="btnTriangle" data-view="triangle">Trougao ABC</span>
      <span class="canvas-tab" id="btnCDE" data-view="cde">Trougao CDE i opisana kružnica</span>
    </div>
    <p class="canvas-hint">Kliknite na kartice za promenu prikaza.</p>
  </div>

  <!-- Steps -->
  <div class="card">
    <div class="card-title">
      <span class="icon" style="background:#7c3aed;color:#ddd6fe;">K</span>
      Rešenje korak po korak
    </div>
    <div class="steps-container">

      <!-- Korak 1 -->
      <div class="step">
        <div class="step-badge">1</div>
        <div class="step-content">
          <div class="step-title">Postavljamo koordinatni sistem</div>
          <div class="step-body">
            <p>Smestimo tačku \(A\) u koordinatni početak, a \(B\) na pozitivnu \(x\)-osu:</p>
            <div class="math-block highlight">
              \[ A = (0,\, 0), \quad B = (10,\, 0) \]
            </div>
            <p>Tačka \(E\) je središte \(AB\) (jer \(CE\) je težišna duž), pa je:</p>
            <div class="math-block">
              \[ E = \left(\frac{0 + 10}{2},\, 0\right) = (5,\, 0) \]
            </div>
            <div class="checkpoint">
              Smeštanje na koordinatnu osu pojednostavljuje sve dalje račune.
            </div>
          </div>
        </div>
      </div>

      <!-- Korak 2 -->
      <div class="step">
        <div class="step-badge">2</div>
        <div class="step-content">
          <div class="step-title">Nalazimo koordinate tačke C</div>
          <div class="step-body">
            <p>Neka je \(C = (c_x,\, c_y)\). Iz datih dužina stranica postavljamo sistem jednačina:</p>
            <div class="math-block">
              \[
                |AC|^2 = c_x^2 + c_y^2 = 81
              \]
              \[
                |BC|^2 = (c_x - 10)^2 + c_y^2 = 121
              \]
            </div>
            <p>Oduzimamo prvu od druge jednačine:</p>
            <div class="math-block">
              \[
                (c_x - 10)^2 - c_x^2 = 121 - 81
              \]
              \[
                c_x^2 - 20c_x + 100 - c_x^2 = 40
              \]
              \[
                -20c_x = -60 \implies c_x = 3
              \]
            </div>
            <p>Iz prve jednačine nalazimo \(c_y\):</p>
            <div class="math-block">
              \[
                c_y^2 = 81 - c_x^2 = 81 - 9 = 72 \implies c_y = 6\sqrt{2}
              \]
            </div>
            <div class="math-block highlight">
              \[ C = \left(3,\, 6\sqrt{2}\right) \]
            </div>
            <div class="checkpoint">
              <strong>Provera:</strong>
              \(|AC| = \sqrt{9 + 72} = \sqrt{81} = 9\),
              \(|BC| = \sqrt{49 + 72} = \sqrt{121} = 11\),
              \(|AB| = 10\).
            </div>
          </div>
        </div>
      </div>

      <!-- Korak 3 -->
      <div class="step">
        <div class="step-badge">3</div>
        <div class="step-content">
          <div class="step-title">Nalazimo tačku D — nožište visine iz C na AB</div>
          <div class="step-body">
            <p>
              Pošto stranica \(AB\) leži na \(x\)-osi, visina iz \(C\) na \(AB\) je vertikalna linija
              \(x = c_x = 3\). Nožište te visine je:
            </p>
            <div class="math-block highlight">
              \[ D = (3,\, 0) \]
            </div>
            <p>Možemo to potvrditi i formulom:</p>
            <div class="math-block">
              \[
                AD = \frac{|AB|^2 + |AC|^2 - |BC|^2}{2 \cdot |AB|}
                   = \frac{100 + 81 - 121}{20}
                   = \frac{60}{20} = 3
              \]
            </div>
            <div class="checkpoint">
              Dakle \(D\) se nalazi na rastojanju 3 cm od \(A\) duž \(AB\), tj. \(D = (3,\, 0)\).
            </div>
          </div>
        </div>
      </div>

      <!-- Korak 4 -->
      <div class="step">
        <div class="step-badge">4</div>
        <div class="step-content">
          <div class="step-title">Uočavamo pravi ugao u trouglu CDE</div>
          <div class="step-body">
            <p>Imamo tri tačke trougla \(CDE\):</p>
            <div class="math-block">
              \[
                C = (3,\, 6\sqrt{2}), \quad D = (3,\, 0), \quad E = (5,\, 0)
              \]
            </div>
            <p>Vektori iz tačke \(D\):</p>
            <div class="math-block">
              \[
                \overrightarrow{DC} = (0,\; 6\sqrt{2}), \quad
                \overrightarrow{DE} = (2,\; 0)
              \]
            </div>
            <p>Skalarni proizvod:</p>
            <div class="math-block highlight">
              \[
                \overrightarrow{DC} \cdot \overrightarrow{DE} = 0 \cdot 2 + 6\sqrt{2} \cdot 0 = 0
              \]
            </div>
            <p>
              Pošto je skalarni proizvod jednak nuli, vektori su <strong>upravni</strong>,
              tj. \(\angle CDE = 90°\). Ovo je geometrijski očigledno:
              \(CD\) je vertikalni segment (\(x = 3\)), a \(DE\) je horizontalni segment (na \(x\)-osi).
            </p>
            <div class="checkpoint">
              Trougao \(CDE\) je <strong>pravougli</strong> sa pravim uglom pri temenu \(D\).
            </div>
          </div>
        </div>
      </div>

      <!-- Korak 5 -->
      <div class="step">
        <div class="step-badge">5</div>
        <div class="step-content">
          <div class="step-title">Primenjujemo Talesovu teoremu</div>
          <div class="step-body">
            <p>
              Pošto je ugao \(\angle CDE = 90°\), stranica \(CE\) (nasuprotna pravom uglu) je
              <strong>prečnik opisane kružnice</strong> trougla \(CDE\).
            </p>
            <div class="math-block">
              \[
                |CE| = \sqrt{(5 - 3)^2 + (0 - 6\sqrt{2})^2}
                     = \sqrt{4 + 72}
                     = \sqrt{76}
                     = 2\sqrt{19} \text{ cm}
              \]
            </div>
            <p>Poluprečnik opisane kružnice:</p>
            <div class="math-block highlight">
              \[
                R = \frac{|CE|}{2} = \frac{2\sqrt{19}}{2} = \sqrt{19} \text{ cm}
              \]
            </div>
          </div>
        </div>
      </div>

      <!-- Korak 6 -->
      <div class="step">
        <div class="step-badge">6</div>
        <div class="step-content">
          <div class="step-title">Izračunavamo površinu opisane kružnice</div>
          <div class="step-body">
            <div class="math-block highlight">
              \[
                P = \pi R^2 = \pi \cdot (\sqrt{19})^2 = 19\pi \text{ cm}^2
              \]
            </div>
            <div class="checkpoint">
              <strong>Provera Pitagorinom teoremom:</strong>
              \(|CD|^2 + |DE|^2 = 72 + 4 = 76 = |CE|^2\).
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Key Insight -->
  <div class="insight-card">
    <div class="card-title">
      <span class="icon">!</span>
      Ključni uvid
    </div>
    <p>
      Visina \(CD\) je uvek <em>normalna</em> na stranicu \(AB\). Pošto tačke \(D\) i \(E\) obe leže
      na stranici \(AB\), segment \(DE\) leži na pravoj koja sadrži \(AB\). Kako je \(CD \perp AB\),
      sledi \(CD \perp DE\), pa je ugao \(\angle CDE = 90°\) bez obzira na konkretne dimenzije trougla.
    </p>
    <p style="margin-top:10px;">
      Primenom Talesove teoreme, hipotenuza \(CE\) je prečnik opisane kružnice trougla \(CDE\),
      čime se ceo problem svodi na izračunavanje jedne dužine \(|CE| = 2\sqrt{19}\).
    </p>
  </div>

  <!-- Final Answer -->
  <div class="final-answer-card">
    <div class="card-title">
      <span class="icon">&#10003;</span>
      Tačan odgovor
    </div>
    <div class="final-value">\(19\pi\) cm\(^2\)</div>
    <div class="final-label">Odgovor C) \(\;19\pi\) cm\(^2\)</div>
  </div>

  <!-- Pitfalls -->
  <div class="pitfall-card">
    <div class="card-title">
      <span class="icon" style="background:#7f1d1d;color:#fca5a5;">!</span>
      Česte greške
    </div>
    <div class="pitfall-item">
      Zaboraviti da je \(CD \perp AB\), pa \(\angle CDE = 90°\). Bez ovog zapažanja,
      koristi se komplikovanija formula \(R = \frac{abc}{4S}\), što vodi dužem računu.
    </div>
    <div class="pitfall-item">
      Zamena poluprečnika i prečnika: hipotenuza \(CE = 2\sqrt{19}\) je <em>prečnik</em>,
      pa je \(R = \sqrt{19}\), ne \(R = 2\sqrt{19}\). Površina je \(\pi \cdot 19\), a ne \(\pi \cdot 76\).
    </div>
    <div class="pitfall-item">
      Mešanje težišne duži (medijane) i simetrale stranice. Težišna duž iz \(C\) ide ka
      <strong>sredini</strong> nasuprotne stranice \(AB\), pa je \(E\) sredina \(AB\).
    </div>
    <div class="pitfall-item">
      Pogrešno izračunavanje koordinata tačke \(C\). Treba pažljivo rešiti sistem jednačina,
      a zatim proveriti da sve tri stranice imaju zadate dužine.
    </div>
  </div>

  <!-- Challenge -->
  <div class="challenge-card">
    <div class="card-title">
      <span class="icon" style="background:#78350f;color:#fcd34d;">*</span>
      Izazovni zadatak
    </div>
    <p style="color:#fde68a;">
      U istom trouglu \(ABC\) (\(a = 11\), \(b = 9\), \(c = 10\)), odrediti poluprečnik kruga
      opisanog oko <strong>samog trougla ABC</strong>.
    </p>
    <p style="color:#94a3b8; margin-top:10px; font-size:0.9rem;">
      Koristite formulu \(R = \frac{abc}{4S}\), gde je \(S\) površina trougla.
      Heronovom formulom: \(s = 15\), \(S = \sqrt{15 \cdot 4 \cdot 6 \cdot 5} = \sqrt{1800} = 30\sqrt{2}\).
      Dakle: \(R = \frac{11 \cdot 9 \cdot 10}{4 \cdot 30\sqrt{2}} = \frac{990}{120\sqrt{2}} = \frac{33\sqrt{2}}{8}\).
    </p>
  </div>

</div>

<script>
(function() {
  'use strict';

  // Koordinate tacaka
  var Ax = 0, Ay = 0;
  var Bx = 10, By = 0;
  var Cx = 3, Cy = 6 * Math.sqrt(2);
  var Dx = 3, Dy = 0;
  var Ex = 5, Ey = 0;

  // Centar i poluprecnik opisane kruznice trougla CDE
  var Ox = (Cx + Ex) / 2;
  var Oy = (Cy + Ey) / 2;
  var circleR = Math.sqrt(Math.pow(Cx - Ex, 2) + Math.pow(Cy - Ey, 2)) / 2;

  var canvas = document.getElementById('geomCanvas');
  if (!canvas) return;
  var ctx = canvas.getContext('2d');
  var currentView = 'triangle';

  // Tab switching via event delegation (no onclick)
  var controls = document.querySelector('.canvas-controls');
  if (controls) {
    controls.addEventListener('click', function(e) {
      var tab = e.target.closest('.canvas-tab');
      if (!tab) return;
      var view = tab.getAttribute('data-view');
      if (!view) return;
      currentView = view;
      var tabs = controls.querySelectorAll('.canvas-tab');
      for (var i = 0; i < tabs.length; i++) {
        tabs[i].classList.toggle('active', tabs[i] === tab);
      }
      drawAll();
    });
  }

  // Style for canvas tabs
  var tabStyle = document.createElement('style');
  tabStyle.textContent = [
    '.canvas-tab { background:#1e293b; border:1px solid #475569; border-radius:8px;',
    ' color:#e2e8f0; padding:7px 16px; font-size:0.9rem; cursor:pointer;',
    ' transition:background 0.15s, border-color 0.15s; display:inline-block; }',
    '.canvas-tab:hover { background:#334155; border-color:#60a5fa; }',
    '.canvas-tab.active { background:#1d4ed8; border-color:#60a5fa; color:#fff; }'
  ].join('');
  document.head.appendChild(tabStyle);

  function drawAll() {
    var dpr = window.devicePixelRatio || 1;
    var w = canvas.parentElement.clientWidth - 52;
    if (w < 280) w = 280;
    var h = Math.round(w * 0.6);
    if (h < 260) h = 260;
    if (h > 440) h = 440;

    canvas.style.width = w + 'px';
    canvas.style.height = h + 'px';
    canvas.width = w * dpr;
    canvas.height = h * dpr;
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

    ctx.clearRect(0, 0, w, h);
    ctx.fillStyle = '#0f172a';
    ctx.fillRect(0, 0, w, h);

    // Bounding box
    var pad = 60;
    var minX = -0.5, maxX = 10.5;
    var minY = -1.2, maxY = Cy + 1.5;

    var scaleX = (w - 2 * pad) / (maxX - minX);
    var scaleY = (h - 2 * pad) / (maxY - minY);
    var sc = Math.min(scaleX, scaleY);

    var cxM = (minX + maxX) / 2;
    var cyM = (minY + maxY) / 2;

    function tx(x) { return w / 2 + (x - cxM) * sc; }
    function ty(y) { return h / 2 - (y - cyM) * sc; }

    if (currentView === 'triangle') {
      drawTriangleView(w, h, tx, ty, sc);
    } else {
      drawCDEView(w, h, tx, ty, sc);
    }
  }

  function drawTriangleView(w, h, tx, ty, sc) {
    var pA = { x: tx(Ax), y: ty(Ay) };
    var pB = { x: tx(Bx), y: ty(By) };
    var pC = { x: tx(Cx), y: ty(Cy) };
    var pD = { x: tx(Dx), y: ty(Dy) };
    var pE = { x: tx(Ex), y: ty(Ey) };

    // Triangle ABC fill
    ctx.beginPath();
    ctx.moveTo(pA.x, pA.y);
    ctx.lineTo(pB.x, pB.y);
    ctx.lineTo(pC.x, pC.y);
    ctx.closePath();
    ctx.fillStyle = 'rgba(96,165,250,0.06)';
    ctx.fill();
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2;
    ctx.stroke();

    // Altitude CD (dashed pink)
    ctx.beginPath();
    ctx.setLineDash([5, 4]);
    ctx.moveTo(pC.x, pC.y);
    ctx.lineTo(pD.x, pD.y);
    ctx.strokeStyle = '#f472b6';
    ctx.lineWidth = 1.8;
    ctx.stroke();
    ctx.setLineDash([]);

    // Median CE (dashed green)
    ctx.beginPath();
    ctx.setLineDash([7, 4]);
    ctx.moveTo(pC.x, pC.y);
    ctx.lineTo(pE.x, pE.y);
    ctx.strokeStyle = '#34d399';
    ctx.lineWidth = 1.8;
    ctx.stroke();
    ctx.setLineDash([]);

    // Right angle mark at D
    var sq = 10;
    ctx.beginPath();
    ctx.moveTo(pD.x + sq, pD.y);
    ctx.lineTo(pD.x + sq, pD.y - sq);
    ctx.lineTo(pD.x, pD.y - sq);
    ctx.strokeStyle = '#f472b6';
    ctx.lineWidth = 1.5;
    ctx.stroke();

    // Points
    drawDot(pA.x, pA.y, '#e2e8f0', 'A', -18, 16);
    drawDot(pB.x, pB.y, '#e2e8f0', 'B', 8, 16);
    drawDot(pC.x, pC.y, '#e2e8f0', 'C', -18, -8);
    drawDot(pD.x, pD.y, '#f472b6', 'D', -6, 18);
    drawDot(pE.x, pE.y, '#34d399', 'E', 4, 18);

    // Side labels
    ctx.font = '13px Segoe UI, sans-serif';
    ctx.textAlign = 'center';

    ctx.fillStyle = '#60a5fa';
    ctx.fillText('11 cm', (pB.x + pC.x) / 2 + 22, (pB.y + pC.y) / 2);
    ctx.fillText('9 cm', (pA.x + pC.x) / 2 - 24, (pA.y + pC.y) / 2);

    ctx.fillStyle = '#94a3b8';
    ctx.fillText('10 cm', (pA.x + pB.x) / 2, pA.y + 32);

    ctx.font = '11px Segoe UI, sans-serif';
    ctx.fillStyle = '#f472b6';
    ctx.fillText('CD: visina', pC.x - 50, (pC.y + pD.y) / 2);

    ctx.fillStyle = '#34d399';
    ctx.fillText('CE: medijana', (pC.x + pE.x) / 2 + 34, (pC.y + pE.y) / 2 + 10);

    ctx.fillStyle = '#a78bfa';
    ctx.fillText('DE = 2', (pD.x + pE.x) / 2, pD.y - 12);

    ctx.textAlign = 'left';

    // Title
    ctx.fillStyle = '#e2e8f0';
    ctx.font = 'bold 13px Segoe UI, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Trougao ABC sa visinom CD i medijanom CE', w / 2, 20);
    ctx.textAlign = 'left';
  }

  function drawCDEView(w, h, tx, ty, sc) {
    var pC = { x: tx(Cx), y: ty(Cy) };
    var pD = { x: tx(Dx), y: ty(Dy) };
    var pE = { x: tx(Ex), y: ty(Ey) };
    var pO = { x: tx(Ox), y: ty(Oy) };
    var Rcanvas = circleR * sc;

    // Circumscribed circle
    ctx.beginPath();
    ctx.arc(pO.x, pO.y, Rcanvas, 0, 2 * Math.PI);
    ctx.fillStyle = 'rgba(167,139,250,0.06)';
    ctx.fill();
    ctx.strokeStyle = '#a78bfa';
    ctx.lineWidth = 2;
    ctx.setLineDash([6, 4]);
    ctx.stroke();
    ctx.setLineDash([]);

    // Diameter CE (dashed)
    ctx.beginPath();
    ctx.setLineDash([5, 3]);
    ctx.moveTo(pC.x, pC.y);
    ctx.lineTo(pE.x, pE.y);
    ctx.strokeStyle = '#a78bfa';
    ctx.lineWidth = 1.5;
    ctx.stroke();
    ctx.setLineDash([]);

    // Triangle CDE
    ctx.beginPath();
    ctx.moveTo(pC.x, pC.y);
    ctx.lineTo(pD.x, pD.y);
    ctx.lineTo(pE.x, pE.y);
    ctx.closePath();
    ctx.fillStyle = 'rgba(74,222,128,0.08)';
    ctx.fill();
    ctx.strokeStyle = '#4ade80';
    ctx.lineWidth = 2.5;
    ctx.stroke();

    // Right angle mark at D
    var sq = 12;
    ctx.beginPath();
    ctx.moveTo(pD.x + sq, pD.y);
    ctx.lineTo(pD.x + sq, pD.y - sq);
    ctx.lineTo(pD.x, pD.y - sq);
    ctx.strokeStyle = '#34d399';
    ctx.lineWidth = 1.8;
    ctx.stroke();

    // Radius from O to C
    ctx.beginPath();
    ctx.setLineDash([3, 3]);
    ctx.moveTo(pO.x, pO.y);
    ctx.lineTo(pC.x, pC.y);
    ctx.strokeStyle = '#c4b5fd';
    ctx.lineWidth = 1;
    ctx.stroke();
    ctx.setLineDash([]);

    // Center O
    ctx.beginPath();
    ctx.arc(pO.x, pO.y, 4, 0, 2 * Math.PI);
    ctx.fillStyle = '#a78bfa';
    ctx.fill();

    // Points
    drawDot(pC.x, pC.y, '#4ade80', 'C', -18, -10);
    drawDot(pD.x, pD.y, '#4ade80', 'D', -20, 6);
    drawDot(pE.x, pE.y, '#4ade80', 'E', 8, 16);

    ctx.fillStyle = '#a78bfa';
    ctx.font = 'bold 13px Segoe UI, sans-serif';
    ctx.fillText('O', pO.x + 8, pO.y - 8);

    // Labels
    ctx.textAlign = 'center';
    ctx.font = '13px Segoe UI, sans-serif';

    ctx.fillStyle = '#4ade80';
    ctx.fillText('CD = 6\u221A2', pC.x - 46, (pC.y + pD.y) / 2);
    ctx.fillText('DE = 2', (pD.x + pE.x) / 2, pD.y + 22);

    ctx.fillStyle = '#a78bfa';
    ctx.fillText('CE = 2\u221A19 (prečnik)', (pC.x + pE.x) / 2 + 50, (pC.y + pE.y) / 2 - 16);

    ctx.fillStyle = '#c4b5fd';
    ctx.font = '12px Segoe UI, sans-serif';
    ctx.fillText('R = \u221A19', (pO.x + pC.x) / 2 - 36, (pO.y + pC.y) / 2 - 6);

    // 90 degree label
    ctx.fillStyle = '#34d399';
    ctx.font = '12px Segoe UI, sans-serif';
    ctx.fillText('90\u00B0', pD.x + 18, pD.y - 16);

    ctx.textAlign = 'left';

    // Title
    ctx.fillStyle = '#e2e8f0';
    ctx.font = 'bold 13px Segoe UI, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Trougao CDE sa opisanom kružnicom (prečnik = CE)', w / 2, 20);
    ctx.textAlign = 'left';

    // Area annotation
    ctx.fillStyle = '#4ade80';
    ctx.font = 'bold 14px Segoe UI, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('P = \u03C0R\u00B2 = 19\u03C0 cm\u00B2', w / 2, h - 16);
    ctx.textAlign = 'left';
  }

  function drawDot(x, y, color, label, lx, ly) {
    ctx.beginPath();
    ctx.arc(x, y, 5, 0, 2 * Math.PI);
    ctx.fillStyle = color;
    ctx.fill();
    ctx.font = 'bold 14px Segoe UI, sans-serif';
    ctx.fillText(label, x + (lx || 0), y + (ly || 0));
  }

  // Touch support for canvas
  canvas.addEventListener('touchstart', function(e) { e.preventDefault(); }, { passive: false });
  canvas.addEventListener('touchmove', function(e) { e.preventDefault(); }, { passive: false });

  window.addEventListener('resize', drawAll);
  drawAll();
})();
</script>

</body>
</html>
