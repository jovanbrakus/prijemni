<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tangenta elipse - odredjivanje parametra n</title>

<script type="text/info" id="logic-scratchpad">
Problem: Find the positive value of parameter n for which the line y = (3/2)x + n
is tangent to the ellipse x^2/20 + y^2/36 = 1.

Tangency condition for line y = mx + n and ellipse x^2/a^2 + y^2/b^2 = 1:
  n^2 = a^2 * m^2 + b^2

Given: a^2 = 20, b^2 = 36, m = 3/2

n^2 = 20 * (3/2)^2 + 36
n^2 = 20 * 9/4 + 36
n^2 = 180/4 + 36
n^2 = 45 + 36
n^2 = 81
n = +/- 9

Positive value: n = 9

Check which interval: 9 is in (8, 12].

Answer: C) (8, 12]

Verification: Substitute y = (3/2)x + 9 into x^2/20 + y^2/36 = 1:
x^2/20 + ((3/2)x + 9)^2 / 36 = 1
x^2/20 + (9x^2/4 + 27x + 81) / 36 = 1
Multiply by 180 (LCM of 20, 36):
9x^2 + 5(9x^2/4 + 27x + 81) = 180
9x^2 + 45x^2/4 + 135x + 405 = 180
Multiply by 4:
36x^2 + 45x^2 + 540x + 1620 = 720
81x^2 + 540x + 900 = 0
Divide by 9:
9x^2 + 60x + 100 = 0
D = 3600 - 3600 = 0. Confirmed: exactly one solution (tangent).
x = -60/18 = -10/3
y = (3/2)(-10/3) + 9 = -5 + 9 = 4
Tangent point: (-10/3, 4). Confirmed on ellipse: (100/9)/20 + 16/36 = 5/9 + 4/9 = 1. Correct.
</script>

<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 10px;
}

h1 {
  font-size: 2.2rem;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 30px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.4rem;
  margin-bottom: 16px;
}

.card h3 {
  color: #e2e8f0;
  font-size: 1.1rem;
  margin-bottom: 10px;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.given-item {
  background: rgba(56, 189, 248, 0.06);
  border: 1px solid rgba(56, 189, 248, 0.12);
  border-radius: 10px;
  padding: 12px 18px;
  text-align: center;
  min-width: 80px;
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-bottom: 4px;
}

.given-item .value {
  color: #e2e8f0;
  font-size: 1.1rem;
  font-weight: 600;
}

.plan-card {
  border-left: 3px solid #a78bfa;
}

.plan-card p {
  color: #94a3b8;
  font-size: 1rem;
}

details {
  margin: 15px 0;
}

details summary {
  cursor: pointer;
  color: #60a5fa;
  font-weight: 600;
  font-size: 1.05rem;
  padding: 8px 0;
}

details summary:hover {
  color: #93c5fd;
}

.theory-content {
  padding: 12px 0;
  color: #e2e8f0;
}

.theory-content ul {
  list-style: none;
  padding-left: 0;
}

.theory-content li {
  padding: 8px 0;
  border-bottom: 1px solid #334155;
  color: #e2e8f0;
}

.theory-content li:last-child {
  border-bottom: none;
}

.step-container {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
  padding: 16px;
  border-radius: 10px;
  border-left: 3px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
}

.step-container:hover,
.step-container.active {
  background: rgba(96, 165, 250, 0.04);
  border-left-color: #4ade80;
}

.step-badge {
  width: 28px;
  height: 28px;
  min-width: 28px;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.85rem;
  color: #0f172a;
  margin-top: 2px;
}

.step-content {
  flex: 1;
}

.step-content h3 {
  margin-bottom: 8px;
}

.step-content p {
  color: #94a3b8;
  margin-bottom: 8px;
}

.math-block {
  background: rgba(56, 189, 248, 0.08);
  border: 1px solid rgba(56, 189, 248, 0.15);
  border-radius: 8px;
  padding: 14px 18px;
  margin: 10px 0;
  font-family: 'Courier New', monospace;
  overflow-x: auto;
}

.checkpoint {
  background: rgba(167, 139, 250, 0.08);
  border: 1px solid rgba(167, 139, 250, 0.2);
  border-radius: 10px;
  padding: 14px 18px;
  margin: 15px 0;
}

.checkpoint summary {
  color: #a78bfa;
  font-size: 0.95rem;
}

.checkpoint .answer {
  padding-top: 10px;
  color: #4ade80;
}

.insight-box {
  background: linear-gradient(135deg, rgba(96,165,250,0.1), rgba(167,139,250,0.1));
  border: 1px solid rgba(167, 139, 250, 0.3);
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  text-align: center;
}

.insight-box h2 {
  color: #a78bfa;
  margin-bottom: 12px;
}

.insight-box .formula {
  font-size: 1.3rem;
  color: #4ade80;
  margin: 12px 0;
}

.final-answer {
  background: linear-gradient(135deg, rgba(52, 211, 153, 0.1), rgba(74, 222, 128, 0.1));
  border: 2px solid rgba(52, 211, 153, 0.3);
  border-radius: 14px;
  padding: 28px;
  margin-bottom: 24px;
  text-align: center;
}

.final-answer h2 {
  color: #4ade80;
  margin-bottom: 16px;
}

.final-answer .answer-value {
  font-size: 1.8rem;
  color: #4ade80;
  font-weight: 700;
  margin-bottom: 16px;
}

.options-row {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 12px;
  margin: 16px 0;
}

.option-card {
  background: rgba(30, 41, 59, 0.8);
  border: 1px solid #334155;
  border-radius: 10px;
  padding: 10px 20px;
  text-align: center;
  min-width: 80px;
}

.option-card.correct {
  border-color: #4ade80;
  background: rgba(74, 222, 128, 0.12);
}

.option-card .opt-label {
  color: #94a3b8;
  font-size: 0.8rem;
}

.option-card .opt-value {
  font-size: 1.1rem;
  font-weight: 600;
  color: #e2e8f0;
}

.option-card.correct .opt-value {
  color: #4ade80;
}

.verification {
  margin-top: 16px;
  color: #94a3b8;
  font-size: 0.95rem;
  font-style: italic;
}

.pitfalls {
  border-left: 3px solid #e09468;
}

.pitfalls h2 {
  color: #e09468;
}

.pitfalls ul {
  list-style: none;
  padding: 0;
}

.pitfalls li {
  padding: 8px 0;
  color: #94a3b8;
  border-bottom: 1px solid #334155;
}

.pitfalls li:last-child {
  border-bottom: none;
}

.challenge {
  border-left: 3px solid #f472b6;
}

.challenge h2 {
  color: #f472b6;
}

.canvas-card {
  text-align: center;
}

.canvas-card canvas {
  border-radius: 10px;
  width: 100%;
  max-width: 700px;
  touch-action: none;
}

.canvas-hint {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-top: 8px;
}

@media (max-width: 700px) {
  h1 { font-size: 1.6rem; }
  .card { padding: 16px; }
  .step-container { padding: 10px; }
  .given-grid { gap: 8px; }
  .given-item { min-width: 60px; padding: 8px 12px; }
}
</style>
</head>
<body>
<div class="container">

  <!-- Title -->
  <h1>Tangenta elipse - odredjivanje parametra n</h1>
  <p class="subtitle">Uslov tangentnosti prave i elipse, izracunavanje pozitivne vrednosti parametra</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <h2>Postavka zadatka</h2>
    <p>Pozitivna vrednost parametra \( n \) za koju je prava \( y = \dfrac{3}{2}x + n \) tangenta elipse \( \dfrac{x^2}{20} + \dfrac{y^2}{36} = 1 \) pripada intervalu:</p>

    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\( (0,\,4] \)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\( (4,\,8] \)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\( (8,\,12] \)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\( (12,\,16] \)</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card plan-card">
    <h2>Plan resavanja</h2>
    <p>Primenimo uslov tangentnosti prave \( y = mx + n \) i elipse \( \frac{x^2}{a^2} + \frac{y^2}{b^2} = 1 \). Ovaj uslov glasi \( n^2 = a^2 m^2 + b^2 \). Zamenimo poznate vrednosti, izracunamo \( n \), i proverimo kom intervalu pripada pozitivna vrednost.</p>
  </div>

  <!-- Theory Refresher -->
  <div class="card">
    <details>
      <summary>Kljucne formule i teoreme</summary>
      <div class="theory-content">
        <ul>
          <li><strong>Jednacina elipse (kanonski oblik):</strong> \( \dfrac{x^2}{a^2} + \dfrac{y^2}{b^2} = 1 \), gde su \( a \) i \( b \) poluose elipse.</li>
          <li><strong>Uslov tangentnosti:</strong> Prava \( y = mx + n \) je tangenta elipse \( \frac{x^2}{a^2} + \frac{y^2}{b^2} = 1 \) ako i samo ako vazi: \[ n^2 = a^2 m^2 + b^2 \] Ovo se izvodi iz uslova da sistem prava-elipsa ima tacno jedno resenje (diskriminanta = 0).</li>
          <li><strong>Geometrijski smisao:</strong> Tangenta dodiruje elipsu u tacno jednoj tacki. Za dato \( m \) postoje tacno dve tangente (sa \( +n \) i \( -n \)).</li>
        </ul>
      </div>
    </details>
  </div>

  <!-- Canvas Visual -->
  <div class="card canvas-card">
    <h2>Graficki prikaz</h2>
    <canvas id="mainCanvas" width="700" height="500"></canvas>
    <p class="canvas-hint">Koristite klizac ispod da menjate vrednost parametra \( n \) i vidite kako prava sece elipsu</p>
    <div style="margin-top: 14px; display: flex; align-items: center; justify-content: center; gap: 12px;">
      <span style="color: #94a3b8; font-size: 0.9rem;">\( n = \)</span>
      <input type="range" id="nSlider" min="-15" max="15" step="0.2" value="9"
        style="width: 260px; accent-color: #60a5fa;">
      <span id="nValue" style="color: #60a5fa; font-weight: 700; font-size: 1.1rem; min-width: 40px;">9</span>
    </div>
  </div>

  <!-- Step-by-Step Solution -->
  <div class="card">
    <h2>Resenje korak po korak</h2>

    <div class="step-container" id="step1">
      <div class="step-badge">1</div>
      <div class="step-content">
        <h3>Identifikujemo parametre</h3>
        <p>Elipsa je data u kanonskom obliku \( \frac{x^2}{a^2} + \frac{y^2}{b^2} = 1 \), odakle citamo:</p>
        <div class="math-block">
          \[ a^2 = 20, \quad b^2 = 36 \]
        </div>
        <p>Prava je data u eksplicitnom obliku \( y = mx + n \), odakle citamo koeficijent pravca:</p>
        <div class="math-block">
          \[ m = \frac{3}{2} \]
        </div>
      </div>
    </div>

    <div class="step-container" id="step2">
      <div class="step-badge">2</div>
      <div class="step-content">
        <h3>Postavimo uslov tangentnosti</h3>
        <p>Prava \( y = mx + n \) je tangenta elipse \( \frac{x^2}{a^2} + \frac{y^2}{b^2} = 1 \) ako i samo ako vazi:</p>
        <div class="math-block">
          \[ n^2 = a^2 m^2 + b^2 \]
        </div>
        <p>Ovo se dobija zamenom prave u jednacinu elipse i zahtevom da rezultujuca kvadratna jednacina po \( x \) ima diskriminantu jednaku nuli.</p>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri sebe: Zasto diskriminanta mora biti nula?</summary>
      <div class="answer">Tangenta dodiruje krivu u tacno jednoj tacki. Kada zamenimo pravu u jednacinu elipse, dobijamo kvadratnu jednacinu po \( x \). Da bi imala tacno jedno resenje (jednu tacku dodira), diskriminanta te jednacine mora biti \( D = 0 \).</div>
    </details>

    <div class="step-container" id="step3">
      <div class="step-badge">3</div>
      <div class="step-content">
        <h3>Zamenjujemo poznate vrednosti</h3>
        <p>Zamenjujemo \( a^2 = 20 \), \( b^2 = 36 \) i \( m = \frac{3}{2} \) u uslov tangentnosti:</p>
        <div class="math-block">
          \[ n^2 = 20 \cdot \left(\frac{3}{2}\right)^2 + 36 \]
        </div>
      </div>
    </div>

    <div class="step-container" id="step4">
      <div class="step-badge">4</div>
      <div class="step-content">
        <h3>Izracunamo \( n^2 \)</h3>
        <p>Racunamo \( m^2 = \left(\frac{3}{2}\right)^2 = \frac{9}{4} \), pa:</p>
        <div class="math-block">
          \[ n^2 = 20 \cdot \frac{9}{4} + 36 = \frac{180}{4} + 36 = 45 + 36 = 81 \]
        </div>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri sebe: Koliko je \( 20 \cdot \frac{9}{4} \)?</summary>
      <div class="answer">\( 20 \cdot \frac{9}{4} = \frac{20 \cdot 9}{4} = \frac{180}{4} = 45 \). Moze se izracunati i kao \( \frac{20}{4} \cdot 9 = 5 \cdot 9 = 45 \).</div>
    </details>

    <div class="step-container" id="step5">
      <div class="step-badge">5</div>
      <div class="step-content">
        <h3>Odredimo vrednosti \( n \)</h3>
        <p>Iz \( n^2 = 81 \) dobijamo:</p>
        <div class="math-block">
          \[ n = \pm\sqrt{81} = \pm 9 \]
        </div>
        <p>Posto se trazi <strong>pozitivna</strong> vrednost parametra \( n \), uzimamo:</p>
        <div class="math-block">
          \[ n = 9 \]
        </div>
      </div>
    </div>

    <div class="step-container" id="step6">
      <div class="step-badge">6</div>
      <div class="step-content">
        <h3>Odredimo interval</h3>
        <p>Proveravamo kom intervalu pripada \( n = 9 \):</p>
        <div class="math-block">
          \[ 8 < 9 \leq 12 \quad \Rightarrow \quad n = 9 \in (8,\, 12] \]
        </div>
        <p>Dakle, tacan odgovor je <strong>C) \( (8,\, 12] \)</strong>.</p>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri sebe: Verifikacija zamenom u jednacinu elipse</summary>
      <div class="answer">
        <p>Zamenimo \( y = \frac{3}{2}x + 9 \) u \( \frac{x^2}{20} + \frac{y^2}{36} = 1 \):</p>
        <p>\( \frac{x^2}{20} + \frac{(\frac{3}{2}x + 9)^2}{36} = 1 \)</p>
        <p>Mnozenjem sa 180: \( 9x^2 + 5 \cdot (\frac{9}{4}x^2 + 27x + 81) = 180 \)</p>
        <p>\( 9x^2 + \frac{45}{4}x^2 + 135x + 405 = 180 \)</p>
        <p>Mnozenjem sa 4: \( 36x^2 + 45x^2 + 540x + 1620 = 720 \)</p>
        <p>\( 81x^2 + 540x + 900 = 0 \), tj. \( 9x^2 + 60x + 100 = 0 \)</p>
        <p>\( D = 3600 - 3600 = 0 \). Diskriminanta je nula - potvrdjeno da je prava tangenta!</p>
        <p>Tacka dodira: \( x = -\frac{60}{18} = -\frac{10}{3} \), \( y = \frac{3}{2} \cdot (-\frac{10}{3}) + 9 = -5 + 9 = 4 \).</p>
      </div>
    </details>
  </div>

  <!-- Key Insight -->
  <div class="insight-box">
    <h2>Kljucni uvid</h2>
    <p>Uslov tangentnosti prave \( y = mx + n \) i elipse \( \frac{x^2}{a^2} + \frac{y^2}{b^2} = 1 \) je elegantna formula koja povezuje odsecak \( n \) sa parametrima elipse i nagibom prave. Nije potrebno resavati ceo sistem &mdash; samo primenite formulu!</p>
    <div class="formula">
      \[ n^2 = a^2 m^2 + b^2 = 20 \cdot \frac{9}{4} + 36 = 81 \quad \Rightarrow \quad n = 9 \]
    </div>
  </div>

  <!-- Final Answer -->
  <div class="final-answer">
    <h2>Konacni odgovor</h2>
    <div class="answer-value">\( n = 9 \in (8,\, 12] \)</div>

    <div class="options-row">
      <div class="option-card">
        <div class="opt-label">(A)</div>
        <div class="opt-value">\( (0,\,4] \)</div>
      </div>
      <div class="option-card">
        <div class="opt-label">(B)</div>
        <div class="opt-value">\( (4,\,8] \)</div>
      </div>
      <div class="option-card correct">
        <div class="opt-label">(C)</div>
        <div class="opt-value">\( (8,\,12] \)</div>
      </div>
      <div class="option-card">
        <div class="opt-label">(D)</div>
        <div class="opt-value">\( (12,\,16] \)</div>
      </div>
    </div>

    <p class="verification">Verifikacija: Za \( n = 9 \), zamena \( y = \frac{3}{2}x + 9 \) u jednacinu elipse daje \( 9x^2 + 60x + 100 = 0 \) sa \( D = 0 \). Tacka dodira je \( \left(-\frac{10}{3},\, 4\right) \), koja lezi na elipsi: \( \frac{100/9}{20} + \frac{16}{36} = \frac{5}{9} + \frac{4}{9} = 1 \).</p>
  </div>

  <!-- Common Pitfalls -->
  <div class="card pitfalls">
    <h2>Ceste greske</h2>
    <ul>
      <li><strong>Zamena \( a^2 \) i \( b^2 \):</strong> U formuli \( n^2 = a^2 m^2 + b^2 \), \( a^2 \) stoji pod \( x^2 \) u jednacini elipse, a \( b^2 \) pod \( y^2 \). Ovde je \( a^2 = 20 \), \( b^2 = 36 \). Zamena bi dala pogresan rezultat \( n^2 = 36 \cdot \frac{9}{4} + 20 = 81 + 20 = 101 \).</li>
      <li><strong>Racunska greska pri kvadriranju:</strong> \( \left(\frac{3}{2}\right)^2 = \frac{9}{4} \), a ne \( \frac{3}{4} \) ili \( \frac{6}{4} \). Kvadrira se i brojilac i imenilac.</li>
      <li><strong>Zaboravljanje da se trazi pozitivna vrednost:</strong> Jednacina \( n^2 = 81 \) daje \( n = \pm 9 \). Zadatak eksplicitno trazi pozitivnu vrednost, dakle \( n = 9 \).</li>
      <li><strong>Pogresan uslov tangentnosti:</strong> Uslov tangentnosti prave i elipse je \( n^2 = a^2 m^2 + b^2 \), a <em>ne</em> \( n^2 = a^2 + b^2 m^2 \). Redosled je bitan!</li>
    </ul>
  </div>

  <!-- Optional Challenge -->
  <div class="card challenge">
    <h2>Dodatni izazov</h2>
    <p>Odredite koordinate tacke u kojoj tangenta \( y = \frac{3}{2}x + 9 \) dodiruje elipsu \( \frac{x^2}{20} + \frac{y^2}{36} = 1 \). Zatim napisite jednacinu tangente u toj tacki koristeci formulu \( \frac{x_0 \cdot x}{a^2} + \frac{y_0 \cdot y}{b^2} = 1 \) i potvrdite da dobijate istu pravu.</p>
    <details>
      <summary>Nagovestaj</summary>
      <div class="answer">
        <p>Tacka dodira je \( T\left(-\frac{10}{3},\, 4\right) \). Koristeci formulu za tangentu elipse u tacki \( (x_0, y_0) \):</p>
        <p>\( \frac{-\frac{10}{3} \cdot x}{20} + \frac{4 \cdot y}{36} = 1 \), tj. \( -\frac{x}{6} + \frac{y}{9} = 1 \), tj. \( y = \frac{9}{6}x + 9 = \frac{3}{2}x + 9 \). Potvrdjeno!</p>
      </div>
    </details>
  </div>

</div>

<script>
(() => {
  const canvas = document.getElementById('mainCanvas');
  const ctx = canvas.getContext('2d');
  const slider = document.getElementById('nSlider');
  const nValueEl = document.getElementById('nValue');

  // Ellipse parameters
  const a2 = 20;
  const b2 = 36;
  const a = Math.sqrt(a2);
  const b = Math.sqrt(b2);
  const m = 3 / 2;

  function draw(n) {
    const W = canvas.width;
    const H = canvas.height;
    ctx.clearRect(0, 0, W, H);

    // Background
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    // Coordinate system
    const originX = W / 2;
    const originY = H / 2;
    const scale = 38;

    function toCanvas(x, y) {
      return { x: originX + x * scale, y: originY - y * scale };
    }

    function fromCanvas(cx, cy) {
      return { x: (cx - originX) / scale, y: (originY - cy) / scale };
    }

    // Grid
    ctx.strokeStyle = '#1e293b';
    ctx.lineWidth = 1;
    for (let gx = -8; gx <= 8; gx++) {
      const p = toCanvas(gx, 0);
      ctx.beginPath();
      ctx.moveTo(p.x, 20);
      ctx.lineTo(p.x, H - 20);
      ctx.stroke();
    }
    for (let gy = -6; gy <= 6; gy++) {
      const p = toCanvas(0, gy);
      ctx.beginPath();
      ctx.moveTo(20, p.y);
      ctx.lineTo(W - 20, p.y);
      ctx.stroke();
    }

    // Axes
    ctx.strokeStyle = '#475569';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(20, originY);
    ctx.lineTo(W - 20, originY);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(originX, 20);
    ctx.lineTo(originX, H - 20);
    ctx.stroke();

    // Axis labels
    ctx.fillStyle = '#94a3b8';
    ctx.font = '12px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    for (let gx = -8; gx <= 8; gx++) {
      if (gx === 0) continue;
      const p = toCanvas(gx, 0);
      if (p.x > 25 && p.x < W - 25) {
        ctx.fillText(gx.toString(), p.x, originY + 16);
      }
    }
    ctx.textAlign = 'right';
    for (let gy = -6; gy <= 6; gy++) {
      if (gy === 0) continue;
      const p = toCanvas(0, gy);
      if (p.y > 25 && p.y < H - 25) {
        ctx.fillText(gy.toString(), originX - 8, p.y + 4);
      }
    }

    ctx.fillStyle = '#94a3b8';
    ctx.font = 'bold 14px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('x', W - 15, originY + 18);
    ctx.fillText('y', originX + 15, 25);

    // Draw ellipse
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2.5;
    ctx.beginPath();
    for (let t = 0; t <= 2 * Math.PI + 0.01; t += 0.02) {
      const ex = a * Math.cos(t);
      const ey = b * Math.sin(t);
      const p = toCanvas(ex, ey);
      if (t === 0) {
        ctx.moveTo(p.x, p.y);
      } else {
        ctx.lineTo(p.x, p.y);
      }
    }
    ctx.closePath();
    ctx.stroke();

    // Fill ellipse lightly
    ctx.fillStyle = 'rgba(96, 165, 250, 0.05)';
    ctx.fill();

    // Label ellipse
    ctx.fillStyle = '#60a5fa';
    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    const elLabelPos = toCanvas(a * 0.7, b * 0.7);
    ctx.fillText('x\u00B2/20 + y\u00B2/36 = 1', elLabelPos.x + 5, elLabelPos.y - 5);

    // Draw line y = mx + n
    const xLeft = fromCanvas(20, 0).x;
    const xRight = fromCanvas(W - 20, 0).x;
    const yLeft = m * xLeft + n;
    const yRight = m * xRight + n;
    const pLeft = toCanvas(xLeft, yLeft);
    const pRight = toCanvas(xRight, yRight);

    // Determine tangent status
    // Substitute y = mx + n into ellipse: x^2/a^2 + (mx+n)^2/b^2 = 1
    // (b^2 + a^2*m^2)x^2 + 2*a^2*m*n*x + a^2*(n^2 - b^2) = 0
    const A = b2 + a2 * m * m;
    const B = 2 * a2 * m * n;
    const C = a2 * (n * n - b2);
    const D = B * B - 4 * A * C;

    let lineColor = '#f472b6'; // secant or no intersection
    let statusText = '';
    if (Math.abs(D) < 0.5) {
      lineColor = '#4ade80';
      statusText = 'D = 0 (tangenta!)';
    } else if (D > 0) {
      lineColor = '#fbbf24';
      statusText = 'D > 0 (secica - dve tacke preseka)';
    } else {
      lineColor = '#f472b6';
      statusText = 'D < 0 (nema preseka)';
    }

    ctx.strokeStyle = lineColor;
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(pLeft.x, pLeft.y);
    ctx.lineTo(pRight.x, pRight.y);
    ctx.stroke();

    // Label line
    ctx.fillStyle = lineColor;
    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'right';
    const lineLabelX = xRight - 1;
    const lineLabelY = m * lineLabelX + n;
    const lineLabelPos = toCanvas(lineLabelX, lineLabelY);
    if (lineLabelPos.y > 20 && lineLabelPos.y < H - 20) {
      ctx.fillText('y = (3/2)x + ' + (n >= 0 ? n.toFixed(1).replace('.', ',') : '(' + n.toFixed(1).replace('.', ',') + ')'), lineLabelPos.x - 5, lineLabelPos.y - 8);
    }

    // Intersection points
    if (D >= 0) {
      const x1 = (-B - Math.sqrt(Math.max(D, 0))) / (2 * A);
      const x2 = (-B + Math.sqrt(Math.max(D, 0))) / (2 * A);
      const y1 = m * x1 + n;
      const y2 = m * x2 + n;
      const p1 = toCanvas(x1, y1);
      const p2 = toCanvas(x2, y2);

      ctx.fillStyle = '#4ade80';
      ctx.beginPath();
      ctx.arc(p1.x, p1.y, 5, 0, Math.PI * 2);
      ctx.fill();

      if (Math.abs(D) >= 0.5) {
        ctx.beginPath();
        ctx.arc(p2.x, p2.y, 5, 0, Math.PI * 2);
        ctx.fill();
      }

      // Tangent point glow
      if (Math.abs(D) < 0.5) {
        ctx.beginPath();
        ctx.arc(p1.x, p1.y, 14, 0, Math.PI * 2);
        ctx.strokeStyle = 'rgba(74, 222, 128, 0.5)';
        ctx.lineWidth = 2;
        ctx.stroke();

        // Label tangent point
        ctx.fillStyle = '#4ade80';
        ctx.font = 'bold 12px Segoe UI, system-ui, sans-serif';
        ctx.textAlign = 'left';
        const tx = x1.toFixed(2).replace('.', ',');
        const ty = y1.toFixed(1).replace('.', ',');
        ctx.fillText('T(' + tx + '; ' + ty + ')', p1.x + 16, p1.y - 10);
      }
    }

    // Status text
    const nStr = n % 1 === 0 ? n.toString() : n.toFixed(1).replace('.', ',');
    ctx.fillStyle = '#94a3b8';
    ctx.font = '14px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('n = ' + nStr, 30, 30);

    if (statusText) {
      ctx.fillStyle = lineColor;
      ctx.fillText(statusText, 30, 50);
    }

    // n^2 vs a^2*m^2+b^2 comparison
    const tangentN2 = a2 * m * m + b2;
    ctx.fillStyle = '#94a3b8';
    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.fillText('n\u00B2 = ' + (n * n).toFixed(1).replace('.', ',') + '   a\u00B2m\u00B2 + b\u00B2 = ' + tangentN2.toFixed(0), 30, 70);

    // Special markers for n = 9 or n = -9
    if (Math.abs(Math.abs(n) - 9) < 0.15) {
      ctx.fillStyle = 'rgba(74, 222, 128, 0.15)';
      ctx.fillRect(20, 78, 260, 22);
      ctx.fillStyle = '#4ade80';
      ctx.font = 'bold 13px Segoe UI, system-ui, sans-serif';
      ctx.textAlign = 'left';
      const sign = n > 0 ? '+9' : '-9';
      ctx.fillText('n = ' + sign + ': tangenta elipse!', 25, 94);
    }

    // Title
    ctx.fillStyle = '#e2e8f0';
    ctx.font = 'bold 13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Elipsa x\u00B2/20 + y\u00B2/36 = 1 i prava y = (3/2)x + n', W / 2, H - 12);

    // Mark semi-axes
    ctx.fillStyle = 'rgba(167, 139, 250, 0.7)';
    ctx.font = '12px Segoe UI, system-ui, sans-serif';
    const paPos = toCanvas(a, 0);
    const pbPos = toCanvas(0, b);
    ctx.textAlign = 'center';
    ctx.fillText('a = \u221A20 \u2248 4,47', paPos.x, paPos.y + 28);
    ctx.fillText('b = 6', pbPos.x + 30, pbPos.y + 4);
  }

  slider.addEventListener('input', function() {
    const n = parseFloat(this.value);
    nValueEl.textContent = n % 1 === 0 ? n.toString() : n.toFixed(1).replace('.', ',');
    draw(n);
  });

  // Step click highlighting
  document.querySelectorAll('.step-container').forEach(function(el) {
    el.addEventListener('click', function() {
      document.querySelectorAll('.step-container').forEach(function(s) {
        s.classList.remove('active');
      });
      el.classList.add('active');
    });
  });

  // Initial draw
  draw(9);
})();
</script>

</div>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Tangenta elipse - odredjivanje parametra n",
  "subject": "math",
  "unit": "analiticka geometrija",
  "topic_tags": ["elipsa", "tangenta", "uslov tangentnosti", "parametar", "analiticka geometrija"]
}
BRAINSPARK_META-->