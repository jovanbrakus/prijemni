<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trinaesti clan geometrijskog niza preko petog clana</title>

<script type="text/info" id="logic-scratchpad">
Problem: First term of a geometric sequence is a_1 = 3, fifth term is a_5.
Find the thirteenth term a_13.

Geometric sequence general term: a_n = a_1 * q^(n-1)

a_5 = a_1 * q^4 = 3 * q^4
=> q^4 = a_5 / 3

a_13 = a_1 * q^12 = 3 * q^12 = 3 * (q^4)^3

Substituting q^4 = a_5/3:
a_13 = 3 * (a_5/3)^3
     = 3 * a_5^3 / 27
     = a_5^3 / 9

Verification with concrete example:
Let q = 2. Then:
  a_1 = 3
  a_5 = 3 * 2^4 = 3 * 16 = 48
  a_13 = 3 * 2^12 = 3 * 4096 = 12288

Check: a_5^3 / 9 = 48^3 / 9 = 110592 / 9 = 12288. Correct!

Check other options:
  A) a_5^2 / 3 = 48^2 / 3 = 2304 / 3 = 768. Not 12288.
  B) 3*a_5^2 = 3 * 2304 = 6912. Not 12288.
  C) a_5^3 / 9 = 110592 / 9 = 12288. Correct!
  D) 9*a_5^2 = 9 * 2304 = 20736. Not 12288.

Answer: C) a_5^3 / 9
</script>

<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 10px;
}

h1 {
  font-size: 2.2rem;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 30px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.card h2 {
  color: #60a5fa;
  font-size: 1.4rem;
  margin-bottom: 16px;
}

.card h3 {
  color: #e2e8f0;
  font-size: 1.1rem;
  margin-bottom: 10px;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.given-item {
  background: rgba(56, 189, 248, 0.06);
  border: 1px solid rgba(56, 189, 248, 0.12);
  border-radius: 10px;
  padding: 12px 18px;
  text-align: center;
  min-width: 80px;
}

.given-item .label {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-bottom: 4px;
}

.given-item .value {
  color: #e2e8f0;
  font-size: 1.1rem;
  font-weight: 600;
}

.plan-card {
  border-left: 3px solid #a78bfa;
}

.plan-card p {
  color: #94a3b8;
  font-size: 1rem;
}

details {
  margin: 15px 0;
}

details summary {
  cursor: pointer;
  color: #60a5fa;
  font-weight: 600;
  font-size: 1.05rem;
  padding: 8px 0;
}

details summary:hover {
  color: #93c5fd;
}

.theory-content {
  padding: 12px 0;
  color: #e2e8f0;
}

.theory-content ul {
  list-style: none;
  padding-left: 0;
}

.theory-content li {
  padding: 8px 0;
  border-bottom: 1px solid #334155;
  color: #e2e8f0;
}

.theory-content li:last-child {
  border-bottom: none;
}

.step-container {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
  padding: 16px;
  border-radius: 10px;
  border-left: 3px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
}

.step-container:hover,
.step-container.active {
  background: rgba(96, 165, 250, 0.04);
  border-left-color: #4ade80;
}

.step-badge {
  width: 28px;
  height: 28px;
  min-width: 28px;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.85rem;
  color: #0f172a;
  margin-top: 2px;
}

.step-content {
  flex: 1;
}

.step-content h3 {
  margin-bottom: 8px;
}

.step-content p {
  color: #94a3b8;
  margin-bottom: 8px;
}

.math-block {
  background: rgba(56, 189, 248, 0.08);
  border: 1px solid rgba(56, 189, 248, 0.15);
  border-radius: 8px;
  padding: 14px 18px;
  margin: 10px 0;
  font-family: 'Courier New', monospace;
  overflow-x: auto;
}

.checkpoint {
  background: rgba(167, 139, 250, 0.08);
  border: 1px solid rgba(167, 139, 250, 0.2);
  border-radius: 10px;
  padding: 14px 18px;
  margin: 15px 0;
}

.checkpoint summary {
  color: #a78bfa;
  font-size: 0.95rem;
}

.checkpoint .answer {
  padding-top: 10px;
  color: #4ade80;
}

.insight-box {
  background: linear-gradient(135deg, rgba(96,165,250,0.1), rgba(167,139,250,0.1));
  border: 1px solid rgba(167, 139, 250, 0.3);
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 24px;
  text-align: center;
}

.insight-box h2 {
  color: #a78bfa;
  margin-bottom: 12px;
}

.insight-box .formula {
  font-size: 1.3rem;
  color: #4ade80;
  margin: 12px 0;
}

.final-answer {
  background: linear-gradient(135deg, rgba(52, 211, 153, 0.1), rgba(74, 222, 128, 0.1));
  border: 2px solid rgba(52, 211, 153, 0.3);
  border-radius: 14px;
  padding: 28px;
  margin-bottom: 24px;
  text-align: center;
}

.final-answer h2 {
  color: #4ade80;
  margin-bottom: 16px;
}

.final-answer .answer-value {
  font-size: 1.8rem;
  color: #4ade80;
  font-weight: 700;
  margin-bottom: 16px;
}

.options-row {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 12px;
  margin: 16px 0;
}

.option-card {
  background: rgba(30, 41, 59, 0.8);
  border: 1px solid #334155;
  border-radius: 10px;
  padding: 10px 20px;
  text-align: center;
  min-width: 80px;
}

.option-card.correct {
  border-color: #4ade80;
  background: rgba(74, 222, 128, 0.12);
}

.option-card .opt-label {
  color: #94a3b8;
  font-size: 0.8rem;
}

.option-card .opt-value {
  font-size: 1.1rem;
  font-weight: 600;
  color: #e2e8f0;
}

.option-card.correct .opt-value {
  color: #4ade80;
}

.verification {
  margin-top: 16px;
  color: #94a3b8;
  font-size: 0.95rem;
  font-style: italic;
}

.pitfalls {
  border-left: 3px solid #e09468;
}

.pitfalls h2 {
  color: #e09468;
}

.pitfalls ul {
  list-style: none;
  padding: 0;
}

.pitfalls li {
  padding: 8px 0;
  color: #94a3b8;
  border-bottom: 1px solid #334155;
}

.pitfalls li:last-child {
  border-bottom: none;
}

.challenge {
  border-left: 3px solid #f472b6;
}

.challenge h2 {
  color: #f472b6;
}

.canvas-card {
  text-align: center;
}

.canvas-card canvas {
  border-radius: 10px;
  width: 100%;
  max-width: 700px;
  touch-action: none;
}

.canvas-hint {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-top: 8px;
}

@media (max-width: 700px) {
  h1 { font-size: 1.6rem; }
  .card { padding: 16px; }
  .step-container { padding: 10px; }
  .given-grid { gap: 8px; }
  .given-item { min-width: 60px; padding: 8px 12px; }
}
</style>
</head>
<body>
<div class="container">

  <!-- Title -->
  <h1>Trinaesti clan geometrijskog niza</h1>
  <p class="subtitle">Izrazavanje clana geometrijskog niza pomocu poznatih clanova i osobina stepena</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <h2>Postavka zadatka</h2>
    <p>Prvi clan geometrijskog niza je \( 3 \), a peti clan je \( a_5 \). Trinaesti clan je:</p>

    <div class="given-grid">
      <div class="given-item">
        <div class="label">Dato</div>
        <div class="value">\( a_1 = 3 \)</div>
      </div>
      <div class="given-item">
        <div class="label">Dato</div>
        <div class="value">\( a_5 \)</div>
      </div>
      <div class="given-item">
        <div class="label">Trazeno</div>
        <div class="value">\( a_{13} = \;? \)</div>
      </div>
    </div>

    <div class="given-grid" style="margin-top: 20px;">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\( \dfrac{a_5^2}{3} \)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\( 3a_5^2 \)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\( \dfrac{a_5^3}{9} \)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\( 9a_5^2 \)</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card plan-card">
    <h2>Plan resavanja</h2>
    <p>Izrazicemo \( q^4 \) preko \( a_5 \) i \( a_1 \), a zatim zapisati \( a_{13} = a_1 \cdot q^{12} = a_1 \cdot (q^4)^3 \) i zameniti da eliminisemo \( q \).</p>
  </div>

  <!-- Theory Refresher -->
  <div class="card">
    <details>
      <summary>Kljucne formule i teoreme</summary>
      <div class="theory-content">
        <ul>
          <li><strong>Opsti clan geometrijskog niza:</strong> \( a_n = a_1 \cdot q^{n-1} \), gde je \( q \) kolicnik niza.</li>
          <li><strong>Veza izmedju clanova:</strong> \( a_n = a_m \cdot q^{n-m} \) za proizvoljne indekse \( m \) i \( n \).</li>
          <li><strong>Osobina stepena:</strong> \( (q^a)^b = q^{ab} \), tj. stepen stepena je proizvod eksponenata.</li>
          <li><strong>Kljucna ideja:</strong> Ako iz jedne jednacine izrazimo \( q^k \), mozemo dobiti vise stepene od \( q \) stepenujuci obe strane.</li>
        </ul>
      </div>
    </details>
  </div>

  <!-- Visual Aid -->
  <div class="card canvas-card">
    <h2>Graficki prikaz</h2>
    <canvas id="mainCanvas" width="700" height="420"></canvas>
    <p class="canvas-hint">Koristite klizac da menjate kolicnik \( q \) i posmatrate kako se menja niz</p>
    <div style="margin-top: 14px; display: flex; align-items: center; justify-content: center; gap: 12px;">
      <span style="color: #94a3b8; font-size: 0.9rem;">\( q = \)</span>
      <input type="range" id="qSlider" min="-2" max="3" step="0.1" value="2"
        style="width: 260px; accent-color: #60a5fa;">
      <span id="qValue" style="color: #60a5fa; font-weight: 700; font-size: 1.1rem; min-width: 40px;">2</span>
    </div>
  </div>

  <!-- Step-by-Step Solution -->
  <div class="card">
    <h2>Resenje korak po korak</h2>

    <div class="step-container" id="step1">
      <div class="step-badge">1</div>
      <div class="step-content">
        <h3>Zapisemo formule za poznate clanove</h3>
        <p>Koristeci formulu za opsti clan geometrijskog niza \( a_n = a_1 \cdot q^{n-1} \):</p>
        <div class="math-block">
          \[ a_1 = 3 \]
        </div>
        <div class="math-block">
          \[ a_5 = a_1 \cdot q^4 = 3 \cdot q^4 \]
        </div>
      </div>
    </div>

    <div class="step-container" id="step2">
      <div class="step-badge">2</div>
      <div class="step-content">
        <h3>Izrazimo \( q^4 \) preko \( a_5 \)</h3>
        <p>Iz prethodne jednacine dobijamo:</p>
        <div class="math-block">
          \[ q^4 = \frac{a_5}{3} \]
        </div>
        <p>Ovo je kljucni izraz &mdash; sada mozemo svaki stepen od \( q \) koji je umnozak broja 4 izraziti preko \( a_5 \).</p>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri sebe: Zasto nam bas \( q^4 \) odgovara za racunanje \( a_{13} \)?</summary>
      <div class="answer">Zato sto je \( a_{13} = a_1 \cdot q^{12} \), a \( 12 = 3 \cdot 4 \), pa mozemo pisati \( q^{12} = (q^4)^3 \).</div>
    </details>

    <div class="step-container" id="step3">
      <div class="step-badge">3</div>
      <div class="step-content">
        <h3>Zapisemo formulu za trinaesti clan</h3>
        <p>Primenjujemo formulu za opsti clan:</p>
        <div class="math-block">
          \[ a_{13} = a_1 \cdot q^{12} \]
        </div>
        <p>Iskoristimo osobinu stepena \( q^{12} = (q^4)^3 \):</p>
        <div class="math-block">
          \[ a_{13} = 3 \cdot (q^4)^3 \]
        </div>
      </div>
    </div>

    <div class="step-container" id="step4">
      <div class="step-badge">4</div>
      <div class="step-content">
        <h3>Zamenimo \( q^4 = \dfrac{a_5}{3} \)</h3>
        <p>Uvrstavamo izraz iz koraka 2:</p>
        <div class="math-block">
          \[ a_{13} = 3 \cdot \left(\frac{a_5}{3}\right)^3 \]
        </div>
        <p>Razvijemo stepen razlomka:</p>
        <div class="math-block">
          \[ a_{13} = 3 \cdot \frac{a_5^3}{3^3} = 3 \cdot \frac{a_5^3}{27} \]
        </div>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri sebe: Koliko je \( 3^3 \)?</summary>
      <div class="answer">\( 3^3 = 27 \). Mnogi u zurbi pogresno napisu \( 3^3 = 9 \), sto je zapravo \( 3^2 \).</div>
    </details>

    <div class="step-container" id="step5">
      <div class="step-badge">5</div>
      <div class="step-content">
        <h3>Pojednostavimo</h3>
        <p>Skratimo \( 3 \) i \( 27 \):</p>
        <div class="math-block">
          \[ a_{13} = \frac{3 \cdot a_5^3}{27} = \frac{a_5^3}{9} \]
        </div>
      </div>
    </div>

    <div class="step-container" id="step6">
      <div class="step-badge">6</div>
      <div class="step-content">
        <h3>Verifikacija konkretnim primerom</h3>
        <p>Neka je \( q = 2 \). Tada:</p>
        <div class="math-block">
          \[ a_5 = 3 \cdot 2^4 = 3 \cdot 16 = 48 \]
        </div>
        <div class="math-block">
          \[ a_{13} = 3 \cdot 2^{12} = 3 \cdot 4096 = 12288 \]
        </div>
        <p>Proverimo nasu formulu:</p>
        <div class="math-block">
          \[ \frac{a_5^3}{9} = \frac{48^3}{9} = \frac{110592}{9} = 12288 \; \checkmark \]
        </div>
      </div>
    </div>

    <details class="checkpoint">
      <summary>Proveri sebe: Da li se odgovor A) \( \frac{a_5^2}{3} \) poklapa za \( q = 2 \)?</summary>
      <div class="answer">\( \frac{a_5^2}{3} = \frac{48^2}{3} = \frac{2304}{3} = 768 \neq 12288 \). Ne, ovo nije tacan odgovor.</div>
    </details>
  </div>

  <!-- Key Insight -->
  <div class="insight-box">
    <h2>Kljucni uvid</h2>
    <p>Kada treba izraziti daleki clan niza preko blizeg, kljuc je pronaci vezu izmedju eksponenata. Ovde je \( 12 = 3 \times 4 \), pa je \( q^{12} = (q^4)^3 \). Posto vec znamo \( q^4 = \frac{a_5}{3} \), prosto stepenujemo!</p>
    <div class="formula">
      \[ a_{13} = a_1 \cdot (q^4)^3 = 3 \cdot \left(\frac{a_5}{3}\right)^3 = \frac{a_5^3}{9} \]
    </div>
  </div>

  <!-- Final Answer -->
  <div class="final-answer">
    <h2>Konacni odgovor</h2>
    <div class="answer-value">\( a_{13} = \dfrac{a_5^3}{9} \)</div>

    <div class="options-row">
      <div class="option-card">
        <div class="opt-label">(A)</div>
        <div class="opt-value">\( \dfrac{a_5^2}{3} \)</div>
      </div>
      <div class="option-card">
        <div class="opt-label">(B)</div>
        <div class="opt-value">\( 3a_5^2 \)</div>
      </div>
      <div class="option-card correct">
        <div class="opt-label">(C)</div>
        <div class="opt-value">\( \dfrac{a_5^3}{9} \)</div>
      </div>
      <div class="option-card">
        <div class="opt-label">(D)</div>
        <div class="opt-value">\( 9a_5^2 \)</div>
      </div>
    </div>

    <p class="verification">Verifikacija: Za \( q = 2 \), \( a_5 = 48 \), \( a_{13} = 12288 \). Formula daje \( 48^3 / 9 = 110592 / 9 = 12288 \). Tacan odgovor.</p>
  </div>

  <!-- Common Pitfalls -->
  <div class="card pitfalls">
    <h2>Ceste greske</h2>
    <ul>
      <li><strong>Pogresan eksponent:</strong> Mnogi izracunaju \( a_{13} = a_1 \cdot q^{13} \) umesto \( a_1 \cdot q^{12} \). Pazite: opsti clan je \( a_n = a_1 \cdot q^{n-1} \), dakle za \( n = 13 \) eksponent je \( 12 \), ne \( 13 \).</li>
      <li><strong>Greska u stepenima trojke:</strong> Kad se dobije \( 3 \cdot \frac{a_5^3}{27} \), neki studenti napisu rezultat kao \( \frac{a_5^3}{3} \) umesto \( \frac{a_5^3}{9} \). Proverite: \( \frac{3}{27} = \frac{1}{9} \).</li>
      <li><strong>Brkanje kvadrata i kuba:</strong> Posto je \( q^{12} = (q^4)^3 \), imamo treci stepen od \( q^4 \), dakle treci stepen od \( a_5/3 \). Odgovor sadrzi \( a_5^3 \), ne \( a_5^2 \). Opcije A), B) i D) koriste \( a_5^2 \) i time su pogresne.</li>
      <li><strong>Neispravno stepenovanje razlomka:</strong> \( \left(\frac{a_5}{3}\right)^3 = \frac{a_5^3}{27} \), ne \( \frac{a_5^3}{3} \) ili \( \frac{a_5^3}{9} \). Stepen se primenjuje i na brojilac i na imenilac!</li>
    </ul>
  </div>

  <!-- Optional Challenge -->
  <div class="card challenge">
    <h2>Dodatni izazov</h2>
    <p>Izrazite \( a_{21} \) preko \( a_1 \) i \( a_5 \) u istom geometrijskom nizu. Takodje, izrazite \( a_9 \) preko \( a_1 \) i \( a_5 \).</p>
    <details>
      <summary>Nagovestaj</summary>
      <div class="answer">
        <p>Za \( a_{21} \): eksponent je \( 20 = 5 \times 4 \), pa \( a_{21} = a_1 \cdot (q^4)^5 = 3 \cdot \left(\frac{a_5}{3}\right)^5 = \frac{a_5^5}{3^4} = \frac{a_5^5}{81} \).</p>
        <p>Za \( a_9 \): eksponent je \( 8 = 2 \times 4 \), pa \( a_9 = a_1 \cdot (q^4)^2 = 3 \cdot \left(\frac{a_5}{3}\right)^2 = 3 \cdot \frac{a_5^2}{9} = \frac{a_5^2}{3} \).</p>
        <p>Zanimljivo: \( \frac{a_5^2}{3} \) je upravo opcija A) iz zadatka &mdash; ali to je vrednost \( a_9 \), ne \( a_{13} \)!</p>
      </div>
    </details>
  </div>

</div>

<script>
(() => {
  const canvas = document.getElementById('mainCanvas');
  const ctx = canvas.getContext('2d');
  const slider = document.getElementById('qSlider');
  const qValueEl = document.getElementById('qValue');

  function draw(q) {
    const W = canvas.width;
    const H = canvas.height;
    ctx.clearRect(0, 0, W, H);

    // Background
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    const a1 = 3;
    const maxN = 13;

    // Compute terms
    const terms = [];
    for (let n = 1; n <= maxN; n++) {
      terms.push({ n: n, value: a1 * Math.pow(q, n - 1) });
    }

    // Find scale
    const values = terms.map(function(t) { return t.value; });
    let maxAbs = Math.max.apply(null, values.map(function(v) { return Math.abs(v); }));
    if (maxAbs < 1) maxAbs = 1;

    const padLeft = 70;
    const padRight = 40;
    const padTop = 60;
    const padBottom = 70;
    const plotW = W - padLeft - padRight;
    const plotH = H - padTop - padBottom;

    // Determine Y range
    let yMin = Math.min(0, Math.min.apply(null, values));
    let yMax = Math.max(0, Math.max.apply(null, values));
    const yRange = yMax - yMin;
    if (yRange < 0.01) {
      yMin -= 1;
      yMax += 1;
    }
    const yPad = (yMax - yMin) * 0.15;
    yMin -= yPad;
    yMax += yPad;

    function toCanvasX(n) {
      return padLeft + ((n - 1) / (maxN - 1)) * plotW;
    }

    function toCanvasY(v) {
      return padTop + plotH - ((v - yMin) / (yMax - yMin)) * plotH;
    }

    // Grid lines
    ctx.strokeStyle = '#1e293b';
    ctx.lineWidth = 1;
    for (let n = 1; n <= maxN; n++) {
      const x = toCanvasX(n);
      ctx.beginPath();
      ctx.moveTo(x, padTop);
      ctx.lineTo(x, H - padBottom);
      ctx.stroke();
    }

    // Zero line
    if (yMin < 0 && yMax > 0) {
      const zeroY = toCanvasY(0);
      ctx.strokeStyle = '#475569';
      ctx.lineWidth = 1.5;
      ctx.beginPath();
      ctx.moveTo(padLeft, zeroY);
      ctx.lineTo(W - padRight, zeroY);
      ctx.stroke();
    }

    // Draw connecting lines
    ctx.strokeStyle = 'rgba(96, 165, 250, 0.3)';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    let clipped = false;
    for (let i = 0; i < terms.length; i++) {
      var cx = toCanvasX(terms[i].n);
      var cy = toCanvasY(terms[i].value);
      if (cy < padTop - 30 || cy > H - padBottom + 30) {
        clipped = true;
        continue;
      }
      if (i === 0 || clipped) {
        ctx.moveTo(cx, cy);
        clipped = false;
      } else {
        ctx.lineTo(cx, cy);
      }
    }
    ctx.stroke();

    // Draw points
    for (let i = 0; i < terms.length; i++) {
      var cx = toCanvasX(terms[i].n);
      var cy = toCanvasY(terms[i].value);

      if (cy < padTop - 30 || cy > H - padBottom + 30) continue;

      var radius = 5;
      var color = '#60a5fa';

      if (terms[i].n === 1) {
        color = '#34d399';
        radius = 7;
      } else if (terms[i].n === 5) {
        color = '#a78bfa';
        radius = 7;
      } else if (terms[i].n === 13) {
        color = '#f472b6';
        radius = 8;
      }

      // Glow for special points
      if (terms[i].n === 1 || terms[i].n === 5 || terms[i].n === 13) {
        ctx.beginPath();
        ctx.arc(cx, cy, radius + 6, 0, Math.PI * 2);
        ctx.strokeStyle = color.replace(')', ', 0.3)').replace('rgb', 'rgba');
        ctx.lineWidth = 2;
        ctx.stroke();
      }

      ctx.beginPath();
      ctx.arc(cx, cy, radius, 0, Math.PI * 2);
      ctx.fillStyle = color;
      ctx.fill();
    }

    // X-axis labels
    ctx.fillStyle = '#94a3b8';
    ctx.font = '12px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    for (let n = 1; n <= maxN; n++) {
      var x = toCanvasX(n);
      ctx.fillText('a' + n, x, H - padBottom + 20);
    }

    // Title
    ctx.fillStyle = '#e2e8f0';
    ctx.font = 'bold 14px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Geometrijski niz: a\u2081 = 3, q = ' + (q % 1 === 0 ? q.toString() : q.toFixed(1).replace('.', ',')), W / 2, H - 10);

    // Legend
    var a5val = terms[4].value;
    var a13val = terms[12].value;
    var a5str = formatNum(a5val);
    var a13str = formatNum(a13val);
    var formulaStr = formatNum(Math.pow(a5val, 3) / 9);

    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';

    ctx.fillStyle = '#34d399';
    ctx.fillText('a\u2081 = 3', 20, 25);

    ctx.fillStyle = '#a78bfa';
    ctx.fillText('a\u2085 = ' + a5str, 20, 42);

    ctx.fillStyle = '#f472b6';
    ctx.fillText('a\u2081\u2083 = ' + a13str, 150, 25);

    ctx.fillStyle = '#94a3b8';
    ctx.fillText('a\u2085\u00B3/9 = ' + formulaStr, 150, 42);

    // Verification check
    var match = Math.abs(a13val - Math.pow(a5val, 3) / 9) < 0.01 * Math.max(1, Math.abs(a13val));
    if (match) {
      ctx.fillStyle = '#4ade80';
      ctx.font = 'bold 12px Segoe UI, system-ui, sans-serif';
      ctx.fillText('\u2713 a\u2081\u2083 = a\u2085\u00B3/9', 350, 25);
    }

    // Bracket showing q^4 and (q^4)^3
    if (Math.abs(q) > 0.05) {
      drawBracket(toCanvasX(1), toCanvasX(5), H - padBottom + 35, 'q\u2074', '#a78bfa');
      drawBracket(toCanvasX(1), toCanvasX(13), H - padBottom + 52, '(q\u2074)\u00B3 = q\u00B9\u00B2', '#f472b6');
    }
  }

  function drawBracket(x1, x2, y, label, color) {
    ctx.strokeStyle = color;
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(x1, y - 3);
    ctx.lineTo(x1, y);
    ctx.lineTo(x2, y);
    ctx.lineTo(x2, y - 3);
    ctx.stroke();

    ctx.fillStyle = color;
    ctx.font = '11px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText(label, (x1 + x2) / 2, y + 13);
  }

  function formatNum(v) {
    if (Math.abs(v) > 1e8) return v.toExponential(1).replace('.', ',');
    if (Math.abs(v) < 0.01 && v !== 0) return v.toExponential(1).replace('.', ',');
    if (v % 1 === 0) return v.toString();
    return v.toFixed(2).replace('.', ',');
  }

  slider.addEventListener('input', function() {
    var q = parseFloat(this.value);
    qValueEl.textContent = q % 1 === 0 ? q.toString() : q.toFixed(1).replace('.', ',');
    draw(q);
  });

  // Step click highlighting
  document.querySelectorAll('.step-container').forEach(function(el) {
    el.addEventListener('click', function() {
      document.querySelectorAll('.step-container').forEach(function(s) {
        s.classList.remove('active');
      });
      el.classList.add('active');
    });
  });

  // Initial draw
  draw(2);
})();
</script>

</div>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Trinaesti clan geometrijskog niza preko petog clana",
  "subject": "math",
  "unit": "nizovi",
  "topic_tags": ["geometrijski niz", "opsti clan niza", "osobine stepena", "kolicnik niza"]
}
BRAINSPARK_META-->