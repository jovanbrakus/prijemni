<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tangenta kruznice kroz tacku na kruznici</title>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)'], ['$', '$']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<script type="text/info" id="logic-scratchpad">
Problem: Jednacina tangente kruznice k: x^2 + y^2 = 20 koja prolazi kroz tacku A(2, 4).

Step 1: Proverimo da li tacka A(2, 4) lezi na kruznici.
  x^2 + y^2 = 2^2 + 4^2 = 4 + 16 = 20. DA, tacka A lezi na kruznici.

Step 2: Posto tacka A lezi na kruznici, tangenta u toj tacki je jedinstvena.
  Za kruznicu x^2 + y^2 = r^2, tangenta u tacki (x0, y0) je:
  x*x0 + y*y0 = r^2

Step 3: Primenimo formulu za tacku A(2, 4) na kruznici x^2 + y^2 = 20:
  x*2 + y*4 = 20
  2x + 4y = 20
  Podelimo sa 2:
  x + 2y = 10
  x + 2y - 10 = 0

Step 4: To je odgovor C.

Verification:
  - Tangenta x + 2y - 10 = 0 prolazi kroz A(2,4): 2 + 2*4 - 10 = 2 + 8 - 10 = 0. OK.
  - Normalni vektor tangente je (1, 2). Vektor OA = (2, 4) = 2*(1, 2).
    Dakle OA je paralelan normalnom vektoru tangente, sto znaci da je tangenta
    normalna na poluprecnik u tacki dodira. OK.
  - Rastojanje centra O(0,0) od prave x + 2y - 10 = 0:
    d = |0 + 0 - 10| / sqrt(1 + 4) = 10/sqrt(5) = 10*sqrt(5)/5 = 2*sqrt(5)
    r = sqrt(20) = 2*sqrt(5). d = r. OK - prava je zaista tangenta.

Check other options:
  A) 2x + y - 8 = 0: Prolazi kroz A? 4 + 4 - 8 = 0. Da.
     Rastojanje od centra: |0 + 0 - 8|/sqrt(4+1) = 8/sqrt(5) != 2*sqrt(5). Nije tangenta.
  B) -x + 2y - 8 = 0: Prolazi kroz A? -2 + 8 - 8 = -2 != 0. Ne prolazi.
  D) -x + 2y - 6 = 0: Prolazi kroz A? -2 + 8 - 6 = 0. Da.
     Rastojanje: |-6|/sqrt(1+4) = 6/sqrt(5) != 2*sqrt(5). Nije tangenta.

Answer: C) x + 2y - 10 = 0
</script>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background: #0f172a;
  color: #e2e8f0;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  line-height: 1.7;
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  font-size: 2.2rem;
  font-weight: 700;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
  line-height: 1.3;
}

.subtitle {
  color: #94a3b8;
  font-size: 1.1rem;
  margin-bottom: 32px;
}

.card {
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 24px;
}

.card-title {
  font-size: 1.3rem;
  font-weight: 600;
  color: #60a5fa;
  margin-bottom: 16px;
}

.given-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.given-item {
  background: rgba(56, 189, 248, 0.08);
  border: 1px solid rgba(56, 189, 248, 0.15);
  border-radius: 10px;
  padding: 12px 18px;
  min-width: 100px;
  text-align: center;
}

.given-item .label {
  font-size: 0.85rem;
  color: #94a3b8;
  margin-bottom: 4px;
}

.given-item .value {
  font-size: 1.1rem;
  color: #e2e8f0;
  font-weight: 600;
}

.plan-card {
  border-left: 4px solid #a78bfa;
}

.step-container {
  margin-bottom: 20px;
  padding: 16px 20px;
  border-radius: 12px;
  background: rgba(30, 41, 59, 0.5);
  border: 1px solid #334155;
  cursor: pointer;
  transition: border-left 0.2s ease;
  border-left: 4px solid transparent;
}

.step-container:hover,
.step-container.active {
  border-left: 4px solid #4ade80;
}

.step-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 12px;
}

.step-badge {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: linear-gradient(135deg, #60a5fa, #a78bfa);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.9rem;
  color: #fff;
  flex-shrink: 0;
}

.step-title {
  font-size: 1.15rem;
  font-weight: 600;
  color: #e2e8f0;
}

.math-block {
  background: rgba(56, 189, 248, 0.08);
  border: 1px solid rgba(56, 189, 248, 0.15);
  border-radius: 8px;
  padding: 14px 18px;
  margin: 12px 0;
  overflow-x: auto;
}

.note {
  color: #94a3b8;
  font-size: 0.92rem;
  margin-top: 8px;
  font-style: italic;
}

details {
  margin: 15px 0;
}

details summary {
  cursor: pointer;
  color: #a78bfa;
  font-weight: 600;
  padding: 10px 16px;
  background: rgba(167, 139, 250, 0.08);
  border: 1px solid rgba(167, 139, 250, 0.2);
  border-radius: 10px;
  list-style: none;
  user-select: none;
}

details summary::-webkit-details-marker {
  display: none;
}

details summary::before {
  content: '\25B6  ';
  font-size: 0.8rem;
  transition: transform 0.2s;
  display: inline-block;
}

details[open] summary::before {
  transform: rotate(90deg);
}

details .details-content {
  padding: 16px;
  margin-top: 8px;
  background: rgba(167, 139, 250, 0.05);
  border-radius: 10px;
  border: 1px solid rgba(167, 139, 250, 0.1);
}

.insight-box {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.15), rgba(167, 139, 250, 0.15));
  border: 1px solid rgba(167, 139, 250, 0.3);
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 24px;
  text-align: center;
}

.insight-box h3 {
  color: #a78bfa;
  margin-bottom: 12px;
  font-size: 1.2rem;
}

.insight-formula {
  font-size: 1.3rem;
  color: #4ade80;
  margin: 16px 0;
}

.final-answer {
  background: linear-gradient(135deg, rgba(52, 211, 153, 0.12), rgba(74, 222, 128, 0.12));
  border: 2px solid rgba(52, 211, 153, 0.4);
  border-radius: 16px;
  padding: 28px;
  margin-bottom: 24px;
  text-align: center;
}

.final-answer h2 {
  color: #34d399;
  margin-bottom: 16px;
  font-size: 1.4rem;
}

.final-answer .answer-value {
  font-size: 1.6rem;
  color: #4ade80;
  font-weight: 700;
  margin-bottom: 16px;
}

.options-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  margin: 16px 0;
}

.option-card {
  padding: 10px 20px;
  border-radius: 10px;
  background: rgba(30, 41, 59, 0.6);
  border: 1px solid #334155;
  color: #94a3b8;
  font-size: 1rem;
  min-width: 180px;
  text-align: center;
}

.option-card.correct-answer {
  background: rgba(52, 211, 153, 0.15);
  border-color: #34d399;
  color: #4ade80;
  font-weight: 700;
}

.verification-note {
  color: #94a3b8;
  font-size: 0.95rem;
  margin-top: 16px;
  padding: 12px;
  background: rgba(148, 163, 184, 0.08);
  border-radius: 8px;
}

.pitfall-card {
  border-left: 4px solid #f472b6;
}

.pitfall-card li {
  margin-bottom: 10px;
  color: #e2e8f0;
}

.pitfall-card li strong {
  color: #f472b6;
}

.challenge-card {
  border-left: 4px solid #60a5fa;
}

.canvas-card {
  text-align: center;
}

.canvas-card canvas {
  border-radius: 12px;
  max-width: 100%;
  touch-action: none;
}

.canvas-hint {
  color: #94a3b8;
  font-size: 0.85rem;
  margin-top: 8px;
}

.highlight {
  color: #f472b6;
  font-weight: 600;
}

.highlight-green {
  color: #4ade80;
  font-weight: 600;
}

.highlight-blue {
  color: #60a5fa;
  font-weight: 600;
}

ul, ol {
  padding-left: 20px;
}

ul li, ol li {
  margin-bottom: 6px;
}

@media (max-width: 700px) {
  h1 { font-size: 1.6rem; }
  .container { padding: 10px; }
  .card { padding: 16px; }
  .given-grid { gap: 8px; }
  .given-item { min-width: 80px; padding: 8px 12px; }
  .options-grid { flex-direction: column; align-items: center; }
  .option-card { min-width: 90%; }
}
</style>
</head>
<body>
<div class="container">

  <h1>Tangenta kruznice u tacki</h1>
  <p class="subtitle">Analitička geometrija -- jednačina tangente kruznice sa centrom u koordinatnom pocetku kroz tacku koja lezi na kruznici</p>

  <!-- Problem Statement -->
  <div class="card problem-statement">
    <h2 class="card-title">Postavka zadatka</h2>
    <p>Jednacina tangente kruznice \( k\!: x^2 + y^2 = 20 \) koja prolazi kroz tacku \( A(2,\, 4) \) je:</p>

    <div class="given-grid">
      <div class="given-item answer-option" data-option="A">
        <div class="label">(A)</div>
        <div class="value">\( 2x + y - 8 = 0 \)</div>
      </div>
      <div class="given-item answer-option" data-option="B">
        <div class="label">(B)</div>
        <div class="value">\( -x + 2y - 8 = 0 \)</div>
      </div>
      <div class="given-item answer-option" data-option="C">
        <div class="label">(C)</div>
        <div class="value">\( x + 2y - 10 = 0 \)</div>
      </div>
      <div class="given-item answer-option" data-option="D">
        <div class="label">(D)</div>
        <div class="value">\( -x + 2y - 6 = 0 \)</div>
      </div>
    </div>
  </div>

  <!-- Plan -->
  <div class="card plan-card">
    <h2 class="card-title">Plan resavanja</h2>
    <p>Prvo cemo proveriti da li tacka \( A(2,4) \) lezi na kruznici. Ako lezi, koristicemo formulu za tangentu kruznice \( x^2 + y^2 = r^2 \) u tacki \( (x_0, y_0) \), koja glasi \( x \cdot x_0 + y \cdot y_0 = r^2 \). Zatim cemo srediti jednacinu i uporediti sa ponudjenim odgovorima.</p>
  </div>

  <!-- Theory Refresher -->
  <div class="card">
    <details>
      <summary>Kljucne formule i teoreme</summary>
      <div class="details-content">
        <ul>
          <li><strong>Jednacina kruznice sa centrom u koordinatnom pocetku:</strong> \( x^2 + y^2 = r^2 \), gde je \( r \) poluprecnik kruznice.</li>
          <li><strong>Tangenta kruznice \( x^2 + y^2 = r^2 \) u tacki \( T(x_0, y_0) \) koja lezi na kruznici:</strong>
            \[ x \cdot x_0 + y \cdot y_0 = r^2 \]
            Ova formula se dobija zamenom \( x^2 \to x \cdot x_0 \) i \( y^2 \to y \cdot y_0 \) u jednacini kruznice.</li>
          <li><strong>Uslov tangentnosti:</strong> Prava je tangenta kruznice ako je njeno rastojanje od centra jednako poluprecniku:
            \[ d(O, p) = r \]</li>
          <li><strong>Rastojanje tacke \( (x_1, y_1) \) od prave \( Ax + By + C = 0 \):</strong>
            \[ d = \frac{|Ax_1 + By_1 + C|}{\sqrt{A^2 + B^2}} \]</li>
        </ul>
      </div>
    </details>
  </div>

  <!-- Visual Aid -->
  <div class="card canvas-card">
    <h2 class="card-title">Graficki prikaz</h2>
    <canvas id="diagram" width="600" height="600"></canvas>
    <p class="canvas-hint">Prevucite tacku A po kruznici da vidite kako se tangenta menja</p>
  </div>

  <!-- Step-by-Step Solution -->
  <div class="card">
    <h2 class="card-title">Resenje korak po korak</h2>

    <!-- Step 1 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">1</div>
        <h3 class="step-title">Identifikujmo podatke</h3>
      </div>
      <p>Data nam je kruznica sa jednacinom:</p>
      <div class="math-block">
        \[ k\!: x^2 + y^2 = 20 \]
      </div>
      <p>Centar ove kruznice je u koordinatnom pocetku \( O(0, 0) \), a poluprecnik je:</p>
      <div class="math-block">
        \[ r = \sqrt{20} = 2\sqrt{5} \]
      </div>
      <p>Trazimo jednacinu tangente koja prolazi kroz tacku \( A(2, 4) \).</p>
    </div>

    <!-- Step 2 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">2</div>
        <h3 class="step-title">Proverimo da li tacka A lezi na kruznici</h3>
      </div>
      <p>Uvrstimo koordinate tacke \( A(2, 4) \) u jednacinu kruznice:</p>
      <div class="math-block">
        \[ x^2 + y^2 = 2^2 + 4^2 = 4 + 16 = 20 \quad \checkmark \]
      </div>
      <p>Posto je \( 20 = 20 \), tacka \( A \) <span class="highlight-green">lezi na kruznici</span>.</p>
      <p class="note">Ovo je kljucni uvid: posto tacka lezi na kruznici, postoji tacno jedna tangenta u toj tacki i mozemo koristiti direktnu formulu.</p>
    </div>

    <!-- Check yourself 1 -->
    <details>
      <summary>Proveri sebe: Zasto je vazno da proverimo da li tacka lezi na kruznici?</summary>
      <div class="details-content">
        <p>Ako tacka lezi <strong>na kruznici</strong>, postoji tacno <strong>jedna</strong> tangenta i koristimo formulu \( x \cdot x_0 + y \cdot y_0 = r^2 \).</p>
        <p>Ako tacka lezi <strong>van kruznice</strong>, postoje <strong>dve</strong> tangente, i resavanje je slozenije (zahteva sistem jednacina).</p>
        <p>Ako tacka lezi <strong>unutar kruznice</strong>, tangenta kroz tu tacku <strong>ne postoji</strong>.</p>
      </div>
    </details>

    <!-- Step 3 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">3</div>
        <h3 class="step-title">Primenimo formulu za tangentu</h3>
      </div>
      <p>Za kruznicu \( x^2 + y^2 = r^2 \), tangenta u tacki \( T(x_0, y_0) \) koja lezi na kruznici glasi:</p>
      <div class="math-block">
        \[ x \cdot x_0 + y \cdot y_0 = r^2 \]
      </div>
      <p>Uvrstimo \( x_0 = 2 \), \( y_0 = 4 \) i \( r^2 = 20 \):</p>
      <div class="math-block">
        \[ x \cdot 2 + y \cdot 4 = 20 \]
      </div>
      <div class="math-block">
        \[ 2x + 4y = 20 \]
      </div>
    </div>

    <!-- Step 4 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">4</div>
        <h3 class="step-title">Sredimo jednacinu</h3>
      </div>
      <p>Podelimo obe strane jednacine sa \( 2 \):</p>
      <div class="math-block">
        \[ \frac{2x + 4y}{2} = \frac{20}{2} \]
      </div>
      <div class="math-block">
        \[ x + 2y = 10 \]
      </div>
      <p>Prepisemo u standardni oblik:</p>
      <div class="math-block">
        \[ \boxed{x + 2y - 10 = 0} \]
      </div>
    </div>

    <!-- Check yourself 2 -->
    <details>
      <summary>Proveri sebe: Da li tangenta zaista prolazi kroz tacku A(2, 4)?</summary>
      <div class="details-content">
        <p>Uvrstimo \( x = 2 \), \( y = 4 \) u jednacinu \( x + 2y - 10 = 0 \):</p>
        <p>\[ 2 + 2 \cdot 4 - 10 = 2 + 8 - 10 = 0 \quad \checkmark \]</p>
        <p>Da, tacka \( A(2,4) \) zadovoljava jednacinu tangente.</p>
      </div>
    </details>

    <!-- Step 5 -->
    <div class="step-container">
      <div class="step-header">
        <div class="step-badge">5</div>
        <h3 class="step-title">Verifikacija: rastojanje centra od tangente</h3>
      </div>
      <p>Da bismo se uverili da je ovo zaista tangenta, proverimo da li je rastojanje centra \( O(0,0) \) od prave \( x + 2y - 10 = 0 \) jednako poluprecniku.</p>
      <div class="math-block">
        \[ d(O, t) = \frac{|1 \cdot 0 + 2 \cdot 0 - 10|}{\sqrt{1^2 + 2^2}} = \frac{|-10|}{\sqrt{5}} = \frac{10}{\sqrt{5}} = \frac{10\sqrt{5}}{5} = 2\sqrt{5} \]
      </div>
      <p>A poluprecnik je:</p>
      <div class="math-block">
        \[ r = \sqrt{20} = 2\sqrt{5} \]
      </div>
      <p>Posto je \( d = r = 2\sqrt{5} \), prava je zaista <span class="highlight-green">tangenta kruznice</span>.</p>
    </div>

    <!-- Check yourself 3 -->
    <details>
      <summary>Proveri sebe: Sta bi se desilo da smo dobili d &lt; r?</summary>
      <div class="details-content">
        <p>Ako bi rastojanje centra od prave bilo <strong>manje</strong> od poluprecnika (\( d < r \)), prava bi bila <strong>secica</strong> -- presecala bi kruznicu u dve tacke.</p>
        <p>Ako bi bilo \( d > r \), prava ne bi imala zajednickih tacaka sa kruznicom.</p>
        <p>Samo za \( d = r \) prava dodiruje kruznicu u tacno jednoj tacki -- to je tangenta.</p>
      </div>
    </details>

  </div>

  <!-- Key Insight -->
  <div class="insight-box">
    <h3>Kljucni uvid</h3>
    <p>Kada tacka \( (x_0, y_0) \) lezi na kruznici \( x^2 + y^2 = r^2 \), tangenta se dobija jednostavnom zamenom:</p>
    <div class="insight-formula">
      \[ x^2 \to x \cdot x_0, \quad y^2 \to y \cdot y_0 \]
    </div>
    <p style="color: #94a3b8;">Ova zamena se nekada naziva i <em>polarizacija</em> jednacine kruznice.</p>
  </div>

  <!-- Final Answer -->
  <div class="final-answer">
    <h2>Konacni odgovor</h2>
    <div class="answer-value">\( x + 2y - 10 = 0 \)</div>

    <div class="options-grid">
      <div class="option-card">
        <strong>(A)</strong> \( 2x + y - 8 = 0 \)
      </div>
      <div class="option-card">
        <strong>(B)</strong> \( -x + 2y - 8 = 0 \)
      </div>
      <div class="option-card correct-answer">
        <strong>(C)</strong> \( x + 2y - 10 = 0 \)
      </div>
      <div class="option-card">
        <strong>(D)</strong> \( -x + 2y - 6 = 0 \)
      </div>
    </div>

    <div class="verification-note">
      <strong>Provera ispravnosti:</strong> Tangenta prolazi kroz \( A(2,4) \): \( 2 + 8 - 10 = 0 \). Rastojanje centra od tangente jednako je poluprecniku: \( d = 2\sqrt{5} = r \). Normalni vektor tangente \( \vec{n} = (1, 2) \) je paralelan vektoru \( \overrightarrow{OA} = (2, 4) = 2(1, 2) \), sto potvrdjuje da je tangenta normalna na poluprecnik.
    </div>
  </div>

  <!-- Common Pitfalls -->
  <div class="card pitfall-card">
    <h2 class="card-title">Ceste greske</h2>
    <ul>
      <li><strong>Zaboraviti proveriti polozaj tacke:</strong> Mnogi ucenici odmah pretpostavljaju da je tacka van kruznice i postavljaju sistem jednacina sa uslovom tangentnosti. Uvek prvo proverite -- uvrsite koordinate tacke u jednacinu kruznice. Ako tacka lezi na kruznici, resenje je mnogo jednostavnije.</li>
      <li><strong>Ne skratiti jednacinu:</strong> Direktnom primenom formule dobijamo \( 2x + 4y = 20 \). Ako se ne podeli sa \( 2 \), rezultat \( 2x + 4y - 20 = 0 \) se nece naci medju ponudjenim odgovorima -- sto moze zbuniti, iako je matematicki isti.</li>
    </ul>
  </div>

  <!-- Optional Challenge -->
  <div class="card challenge-card">
    <h2 class="card-title">Dodatni izazov</h2>
    <p>Odredite jednacine tangenti kruznice \( x^2 + y^2 = 20 \) koje prolaze kroz tacku \( B(10, 0) \). Koliko tangenti postoji u tom slucaju?</p>
    <details>
      <summary>Nagovest</summary>
      <div class="details-content">
        <p>Tacka \( B(10, 0) \) je van kruznice (jer \( 10^2 + 0^2 = 100 > 20 \)), pa postoje <strong>dve tangente</strong>. Postavite jednacinu prave kroz \( B \) u obliku \( y = k(x - 10) \) i iskoristite uslov \( d(O, t) = r \) da nadjete koeficijent pravca \( k \).</p>
      </div>
    </details>
  </div>

</div>

<script>
(() => {
  const canvas = document.getElementById('diagram');
  const ctx = canvas.getContext('2d');
  const W = canvas.width;
  const H = canvas.height;

  // Coordinate system setup
  const originX = W / 2;
  const originY = H / 2;
  const scale = 50; // pixels per unit

  // Current angle of point A (draggable)
  // A(2,4) => angle = atan2(4, 2)
  let angle = Math.atan2(4, 2);
  let isDragging = false;
  const r = Math.sqrt(20); // radius ~ 4.472

  function toCanvas(x, y) {
    return { x: originX + x * scale, y: originY - y * scale };
  }

  function toMath(cx, cy) {
    return { x: (cx - originX) / scale, y: (originY - cy) / scale };
  }

  function draw() {
    ctx.clearRect(0, 0, W, H);

    // Background
    ctx.fillStyle = '#0c1222';
    ctx.fillRect(0, 0, W, H);

    // Grid
    ctx.strokeStyle = '#1e293b';
    ctx.lineWidth = 1;
    for (let i = -6; i <= 6; i++) {
      const p1 = toCanvas(i, -6);
      const p2 = toCanvas(i, 6);
      ctx.beginPath();
      ctx.moveTo(p1.x, p1.y);
      ctx.lineTo(p2.x, p2.y);
      ctx.stroke();

      const p3 = toCanvas(-6, i);
      const p4 = toCanvas(6, i);
      ctx.beginPath();
      ctx.moveTo(p3.x, p3.y);
      ctx.lineTo(p4.x, p4.y);
      ctx.stroke();
    }

    // Axes
    ctx.strokeStyle = '#475569';
    ctx.lineWidth = 2;
    // x-axis
    ctx.beginPath();
    const xAxisStart = toCanvas(-6, 0);
    const xAxisEnd = toCanvas(6, 0);
    ctx.moveTo(xAxisStart.x, xAxisStart.y);
    ctx.lineTo(xAxisEnd.x, xAxisEnd.y);
    ctx.stroke();
    // y-axis
    ctx.beginPath();
    const yAxisStart = toCanvas(0, -6);
    const yAxisEnd = toCanvas(0, 6);
    ctx.moveTo(yAxisStart.x, yAxisStart.y);
    ctx.lineTo(yAxisEnd.x, yAxisEnd.y);
    ctx.stroke();

    // Axis labels
    ctx.fillStyle = '#94a3b8';
    ctx.font = '14px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';
    for (let i = -5; i <= 5; i++) {
      if (i === 0) continue;
      const p = toCanvas(i, 0);
      ctx.fillText(String(i), p.x, p.y + 5);
    }
    ctx.textAlign = 'right';
    ctx.textBaseline = 'middle';
    for (let i = -5; i <= 5; i++) {
      if (i === 0) continue;
      const p = toCanvas(0, i);
      ctx.fillText(String(i), p.x - 8, p.y);
    }
    // x, y labels
    ctx.fillStyle = '#60a5fa';
    ctx.font = 'bold 16px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.textBaseline = 'bottom';
    const xLabel = toCanvas(5.7, 0);
    ctx.fillText('x', xLabel.x + 5, xLabel.y - 5);
    const yLabel = toCanvas(0, 5.7);
    ctx.fillText('y', yLabel.x + 8, yLabel.y);

    // Draw circle
    const center = toCanvas(0, 0);
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2.5;
    ctx.beginPath();
    ctx.arc(center.x, center.y, r * scale, 0, 2 * Math.PI);
    ctx.stroke();

    // Circle glow
    ctx.strokeStyle = 'rgba(96, 165, 250, 0.15)';
    ctx.lineWidth = 8;
    ctx.beginPath();
    ctx.arc(center.x, center.y, r * scale, 0, 2 * Math.PI);
    ctx.stroke();

    // Current point A
    const ax = r * Math.cos(angle);
    const ay = r * Math.sin(angle);
    const A = toCanvas(ax, ay);

    // Radius OA (dashed)
    ctx.strokeStyle = 'rgba(148, 163, 184, 0.5)';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([6, 4]);
    ctx.beginPath();
    ctx.moveTo(center.x, center.y);
    ctx.lineTo(A.x, A.y);
    ctx.stroke();
    ctx.setLineDash([]);

    // Tangent line at A
    // Normal vector = (ax, ay), tangent direction = (-ay, ax)
    // Tangent line: ax*x + ay*y = r^2
    // Parametric: (ax - t*ay, ay + t*ax)
    const tangentLen = 6;
    const t1x = ax - tangentLen * (-ay / r);
    const t1y = ay - tangentLen * (ax / r);
    const t2x = ax + tangentLen * (-ay / r);
    const t2y = ay + tangentLen * (ax / r);

    // Correct tangent direction: perpendicular to OA
    const dx = -ay / r;
    const dy = ax / r;
    const pt1 = toCanvas(ax - tangentLen * dx, ay - tangentLen * dy);
    const pt2 = toCanvas(ax + tangentLen * dx, ay + tangentLen * dy);

    ctx.strokeStyle = '#4ade80';
    ctx.lineWidth = 2.5;
    ctx.beginPath();
    ctx.moveTo(pt1.x, pt1.y);
    ctx.lineTo(pt2.x, pt2.y);
    ctx.stroke();

    // Tangent glow
    ctx.strokeStyle = 'rgba(74, 222, 128, 0.15)';
    ctx.lineWidth = 8;
    ctx.beginPath();
    ctx.moveTo(pt1.x, pt1.y);
    ctx.lineTo(pt2.x, pt2.y);
    ctx.stroke();

    // Right angle marker at A (between radius and tangent)
    const markerSize = 12;
    // Radius direction unit vector (from A to O)
    const rdx = -ax / r;
    const rdy = -ay / r;
    // Tangent direction unit vector
    const tdx = dx;
    const tdy = dy;
    const sq1 = toCanvas(ax + markerSize / scale * rdx, ay + markerSize / scale * rdy);
    const sq2 = toCanvas(ax + markerSize / scale * rdx + markerSize / scale * tdx, ay + markerSize / scale * rdy + markerSize / scale * tdy);
    const sq3 = toCanvas(ax + markerSize / scale * tdx, ay + markerSize / scale * tdy);

    ctx.strokeStyle = '#34d399';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(sq1.x, sq1.y);
    ctx.lineTo(sq2.x, sq2.y);
    ctx.lineTo(sq3.x, sq3.y);
    ctx.stroke();

    // Point O
    ctx.fillStyle = '#a78bfa';
    ctx.beginPath();
    ctx.arc(center.x, center.y, 5, 0, 2 * Math.PI);
    ctx.fill();
    ctx.fillStyle = '#a78bfa';
    ctx.font = 'bold 15px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.textBaseline = 'bottom';
    ctx.fillText('O(0, 0)', center.x + 10, center.y - 8);

    // Point A
    ctx.fillStyle = '#f472b6';
    ctx.beginPath();
    ctx.arc(A.x, A.y, 7, 0, 2 * Math.PI);
    ctx.fill();

    // Glow for A
    ctx.fillStyle = 'rgba(244, 114, 182, 0.3)';
    ctx.beginPath();
    ctx.arc(A.x, A.y, 14, 0, 2 * Math.PI);
    ctx.fill();

    // Label A
    const labelOffsetX = ax > 0 ? 15 : -70;
    const labelOffsetY = ay > 0 ? -20 : 20;
    ctx.fillStyle = '#f472b6';
    ctx.font = 'bold 15px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = ax > 0 ? 'left' : 'right';
    ctx.textBaseline = 'middle';
    const roundX = Math.round(ax * 100) / 100;
    const roundY = Math.round(ay * 100) / 100;
    ctx.fillText('A(' + roundX.toFixed(1).replace('.', ',') + '; ' + roundY.toFixed(1).replace('.', ',') + ')', A.x + labelOffsetX, A.y + labelOffsetY);

    // Tangent equation label
    // ax*x + ay*y = 20
    const eqRoundAx = Math.round(ax * 10) / 10;
    const eqRoundAy = Math.round(ay * 10) / 10;
    ctx.fillStyle = '#4ade80';
    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';
    let eqLabel = '';
    if (Math.abs(eqRoundAx) > 0.05 && Math.abs(eqRoundAy) > 0.05) {
      const xPart = eqRoundAx.toFixed(1).replace('.', ',') + 'x';
      const ySign = eqRoundAy >= 0 ? ' + ' : ' - ';
      const yPart = Math.abs(eqRoundAy).toFixed(1).replace('.', ',') + 'y';
      eqLabel = 'tangenta: ' + xPart + ySign + yPart + ' = 20';
    }
    ctx.fillText(eqLabel, W / 2, H - 25);

    // Legend
    ctx.font = '13px Segoe UI, system-ui, sans-serif';
    ctx.textAlign = 'left';
    ctx.textBaseline = 'middle';

    // Circle legend
    ctx.strokeStyle = '#60a5fa';
    ctx.lineWidth = 2.5;
    ctx.beginPath();
    ctx.moveTo(15, 22);
    ctx.lineTo(35, 22);
    ctx.stroke();
    ctx.fillStyle = '#60a5fa';
    ctx.fillText('kruznica x\u00B2 + y\u00B2 = 20', 40, 22);

    // Tangent legend
    ctx.strokeStyle = '#4ade80';
    ctx.lineWidth = 2.5;
    ctx.beginPath();
    ctx.moveTo(15, 42);
    ctx.lineTo(35, 42);
    ctx.stroke();
    ctx.fillStyle = '#4ade80';
    ctx.fillText('tangenta', 40, 42);

    // Radius legend
    ctx.strokeStyle = 'rgba(148, 163, 184, 0.5)';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([6, 4]);
    ctx.beginPath();
    ctx.moveTo(15, 62);
    ctx.lineTo(35, 62);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillStyle = '#94a3b8';
    ctx.fillText('poluprecnik OA', 40, 62);
  }

  // Initial draw
  draw();

  // Interaction: drag point A along the circle
  function getMousePos(e) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = W / rect.width;
    const scaleY = H / rect.height;
    return {
      x: (e.clientX - rect.left) * scaleX,
      y: (e.clientY - rect.top) * scaleY
    };
  }

  function getTouchPos(e) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = W / rect.width;
    const scaleY = H / rect.height;
    const touch = e.touches[0];
    return {
      x: (touch.clientX - rect.left) * scaleX,
      y: (touch.clientY - rect.top) * scaleY
    };
  }

  function isNearA(cx, cy) {
    const ax = r * Math.cos(angle);
    const ay = r * Math.sin(angle);
    const A = toCanvas(ax, ay);
    const dx = cx - A.x;
    const dy = cy - A.y;
    return Math.sqrt(dx * dx + dy * dy) < 25;
  }

  function updateAngle(cx, cy) {
    const m = toMath(cx, cy);
    angle = Math.atan2(m.y, m.x);
    draw();
  }

  canvas.addEventListener('mousedown', function(e) {
    const pos = getMousePos(e);
    if (isNearA(pos.x, pos.y)) {
      isDragging = true;
    }
  });

  canvas.addEventListener('mousemove', function(e) {
    if (isDragging) {
      const pos = getMousePos(e);
      updateAngle(pos.x, pos.y);
    }
    // Cursor style
    const pos = getMousePos(e);
    canvas.style.cursor = isNearA(pos.x, pos.y) || isDragging ? 'grab' : 'default';
  });

  canvas.addEventListener('mouseup', function() {
    isDragging = false;
  });

  canvas.addEventListener('mouseleave', function() {
    isDragging = false;
  });

  // Touch events
  canvas.addEventListener('touchstart', function(e) {
    const pos = getTouchPos(e);
    if (isNearA(pos.x, pos.y)) {
      isDragging = true;
      e.preventDefault();
    }
  });

  canvas.addEventListener('touchmove', function(e) {
    if (isDragging) {
      e.preventDefault();
      const pos = getTouchPos(e);
      updateAngle(pos.x, pos.y);
    }
  });

  canvas.addEventListener('touchend', function() {
    isDragging = false;
  });

  // Step containers click highlight
  const stepContainers = document.querySelectorAll('.step-container');
  stepContainers.forEach(function(container) {
    container.addEventListener('click', function() {
      stepContainers.forEach(function(c) { c.classList.remove('active'); });
      container.classList.add('active');
    });
  });
})();
</script>
</body>
</html>
<!--BRAINSPARK_META
{
  "title": "Tangenta kruznice u tacki na kruznici",
  "subject": "math",
  "unit": "geometry",
  "topic_tags": ["kruznica", "tangenta", "analiticka geometrija", "jednacina tangente", "koordinatna geometrija"]
}
BRAINSPARK_META-->